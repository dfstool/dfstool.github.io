"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4804],{53444:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var s=n(97857),r=n.n(s),a=n(15009),c=n.n(a),i=n(99289),o=n.n(i),u=n(5574),l=n.n(u),d=n(9554),f=n(3990),p=n(64119),m=n(11774),h=n(38345),x=n(59530),v=n(80507),g=n(45360),b=n(69677),k=n(57953),y=n(92398),N=n(27484),j=n.n(N),S=n(96486),w=n(62435),C=(n(8849),n(61448)),_=n(2494),V=n(57132),D=n(71230),M=n(15746),E=n(7134),P=n(83062),T=n(4393),L=n(38823),Z=n.n(L),O=n(70178),q=n.n(O),F=n(86074);j().extend(q()),j().extend(Z());var I=function(e){var t=(0,x.useNavigate)(),n=g.ZP.useMessage(),s=l()(n,2),r=s[0],a=s[1],i=(0,x.useSelector)((function(e){return e.account.accountInfo})),u=(0,x.useSelector)((function(e){return e.account.creator})),d=(0,x.useSelector)((function(e){return e.account.profile})),f=(0,x.useSelector)((function(e){return e.account.markets})),m=(0,x.useSelector)((function(e){return e.account.loading})),h=(0,x.useSelector)((function(e){return e.account.liqsValue})),v=(0,x.useSelector)((function(e){return e.account.tokensValue})),b=(0,x.useSelector)((function(e){return e.account.nftsValue})),y=(0,x.useIntl)(),N=y.formatMessage({id:"common.intlCopySuccess"}),S=y.formatMessage({id:"account.intlBalance"}),L=y.formatMessage({id:"account.intlValue"}),Z=y.formatMessage({id:"account.intlDesc"}),O=(0,w.useMemo)((function(){if(d.avatar)return"https://imagedelivery.net/hc5yVyoIvwlbf8YqJjqHMw/".concat(d.avatar,"/public");var e=d.owner.toString(),t=parseInt(e.slice(-4),36)%150+1e4;return"https://resource2.dfs.land/avatars/".concat(t,".png")}),[d]),q=(0,w.useMemo)((function(){if(d.nick){var e=d.nick,t=d.owner.toString();return e!==t?d.nick+"@"+d.owner.toString():t}return d.owner.toString()}),[d]),I=(0,w.useMemo)((function(){var e={time:"",duration:""};if(i&&i.data.created){var t=j().utc(i.data.created.toString()),n=j()(),s=j().duration(t.diff(n));e.duration=s.humanize(!0),e.time=j().utc(i.data.created.toString()).local().format()}return e}),[i]),z=(0,w.useMemo)((function(){return i&&i.data.core_liquid_balance?i.data.core_liquid_balance.toString():"0.00000000 DFS"}),[i]),U=(0,w.useMemo)((function(){var e,t=f?f[0].reserve0.value/f[0].reserve1.value:0,n=i&&i.data.core_liquid_balance?null===(e=i.data.core_liquid_balance)||void 0===e?void 0:e.toString().split(" ")[0]:"0.00000000";return(Number(t)*Number(n)).toFixed(2)}),[f,i]),A=(0,w.useMemo)((function(){return f?Number(f[0].reserve0.value/f[0].reserve1.value).toFixed(2):"0.00"}),[f]),K=(0,w.useMemo)((function(){var e=d.sex.toNumber();return 0===e?(0,F.jsx)(C.Z,{className:"ml-3 text-pink-600"}):1===e?(0,F.jsx)(_.Z,{className:"ml-3 text-blue-600"}):(0,F.jsx)("span",{})}),[d]),$=(0,w.useCallback)(o()(c()().mark((function e(){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.navigator.clipboard.writeText(d.owner.toString());case 2:r.success("".concat(N));case 3:case"end":return e.stop()}}),e)}))),[d]),B=(0,w.useCallback)((function(){return u?(0,F.jsxs)("span",{children:["by"," ",(0,F.jsx)("a",{onClick:function(){"__self__"!==u&&(t("/query/account?search=".concat(u,"&tab=info")),e.handleSearch(u,""))},children:u})," "]}):(0,F.jsx)("span",{})}),[u,i]);return(0,F.jsx)(k.Z,{size:"large",spinning:m,children:(0,F.jsxs)("div",{className:"",children:[(0,F.jsxs)("div",{className:"",children:[(0,F.jsxs)(D.Z,{gutter:20,children:[(0,F.jsxs)(M.Z,{lg:{span:"12"},md:{span:"24"},sm:{span:"24"},xs:{span:"24"},children:[(0,F.jsxs)("div",{className:"flex justify-start items-center",children:[(0,F.jsx)(E.C,{className:"mr-4",size:64,src:O}),(0,F.jsxs)("div",{children:[(0,F.jsx)("div",{className:" font-semibold text-xl",children:q}),(0,F.jsxs)("div",{children:[(0,F.jsx)(P.Z,{placement:"bottomLeft",title:I.time,children:(0,F.jsxs)("span",{className:" italic",children:["Created ",B(),I.duration]})}),K,(0,F.jsx)(V.Z,{className:"ml-2 text-blue-600",onClick:function(){return $()}})]})]})]}),!!d.desc&&(0,F.jsxs)("div",{children:[(0,F.jsxs)("span",{className:" text-base",children:[Z,"："]}),(0,F.jsx)("span",{className:" text-gray-500",children:d.desc})]})]}),(0,F.jsx)(M.Z,{lg:{span:"12"},md:{span:"10"},sm:{span:"24"},xs:{span:"24"},children:(0,F.jsxs)("div",{children:[(0,F.jsxs)("div",{className:" text-base mt-2",children:[S,"：",z]}),(0,F.jsxs)("span",{className:" text-base mt-1",children:[L,"：$",U]}),(0,F.jsxs)("span",{className:" text-xs",children:[" (@$",A,"/DFS)"]})]})})]}),(0,F.jsxs)(D.Z,{gutter:20,children:[(0,F.jsx)(M.Z,{lg:{span:"12"},md:{span:"12"},sm:{span:"12"},xs:{span:"24"},children:(0,F.jsxs)(T.Z,{className:"w-full mt-3",children:[(0,F.jsxs)("div",{className:"flex justify-between",children:[(0,F.jsx)("div",{children:"通证价值"}),(0,F.jsxs)("div",{children:[(0,p.CE)(v)," USDT"]})]}),(0,F.jsxs)("div",{className:"flex justify-between",children:[(0,F.jsx)("div",{children:"做市价值"}),(0,F.jsxs)("div",{children:[(0,p.CE)(h.reserveValue)," USDT"]})]}),(0,F.jsxs)("div",{className:"flex justify-between",children:[(0,F.jsx)("div",{children:"图片价值"}),(0,F.jsxs)("div",{children:[(0,p.CE)(b)," USDT"]})]}),(0,F.jsxs)("div",{className:"flex justify-between",children:[(0,F.jsx)("div",{children:"全部价值"}),(0,F.jsxs)("div",{children:[(0,p.CE)(v+h.reserveValue+b)," ","USDT"]})]})]})}),(0,F.jsx)(M.Z,{lg:{span:"12"},md:{span:"12"},sm:{span:"12"},xs:{span:"24"},children:(0,F.jsxs)(T.Z,{className:"w-full mt-3",children:[(0,F.jsxs)("div",{className:"flex justify-between",children:[(0,F.jsx)("div",{children:"通证价值"}),(0,F.jsxs)("div",{children:[(0,p.CE)(v/Number(A))," DFS"]})]}),(0,F.jsxs)("div",{className:"flex justify-between",children:[(0,F.jsx)("div",{children:"做市价值"}),(0,F.jsxs)("div",{children:[(0,p.CE)(h.reserveValue/Number(A))," ","DFS"]})]}),(0,F.jsxs)("div",{className:"flex justify-between",children:[(0,F.jsx)("div",{children:"图片价值"}),(0,F.jsxs)("div",{children:[(0,p.CE)(b/Number(A))," DFS"]})]}),(0,F.jsxs)("div",{className:"flex justify-between",children:[(0,F.jsx)("div",{children:"全部价值"}),(0,F.jsxs)("div",{children:[(0,p.CE)((v+h.reserveValue+b)/Number(A))," ","DFS"]})]})]})})]})]}),a]})})},z=(0,w.memo)(I),U=function(){var e=g.ZP.useMessage(),t=l()(e,2),n=t[0],s=t[1],a=(0,x.useDispatch)(),i=(0,x.useSelector)((function(e){return e.global.session})),u=(0,x.useSelector)((function(e){return e.global.contractKit})),N=(0,x.useSelector)((function(e){return e.global.accountKit})),C=(0,x.useSelector)((function(e){return e.account.activeKey})),_=(0,x.useSelector)((function(e){return e.account.accountInfo})),V=(0,x.useSelector)((function(e){return e.account.loading})),D=(0,x.useSelector)((function(e){return e.global.tokenContracts})),M=(0,w.useRef)(),E=(0,w.useState)(""),P=l()(E,2),T=P[0],L=P[1],Z=(0,x.useSearchParams)(),O=l()(Z,2),q=O[0],I=O[1],U=q.get("tab")?q.get("tab"):void 0,A=(0,x.useIntl)(),K=A.formatMessage({id:"account.intlAccount"}),$=A.formatMessage({id:"account.intlSearch"}),B=A.formatMessage({id:"contract.intlAccountFormatError"}),R=A.formatMessage({id:"account.intlSearchAccount"}),Y=A.formatMessage({id:"account.intlProfile"}),G=A.formatMessage({id:"account.intlToken"}),H=A.formatMessage({id:"account.intlNft"}),J=A.formatMessage({id:"account.intlLiq"}),Q=(0,w.useMemo)((function(){return _?_.accountName.toString():""}),[_]),W=(0,w.useCallback)(function(){var e=o()(c()().mark((function e(t,s){var r,o,u,d;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(/^[a-z1-5.]{1,12}$/.test(t)){e.next=8;break}if(t||s.hasOwnProperty("type")){e.next=4;break}return e.abrupt("return",!1);case 4:return n.error("".concat(B)),e.abrupt("return",!1);case 8:return e.next=10,(0,p.zI)(i.client.v1.chain.get_abi(t));case 10:if(r=e.sent,o=l()(r,2),u=o[0],d=o[1],!u){e.next=17;break}return n.error(u),e.abrupt("return",!1);case 17:return!u&&d.hasOwnProperty("abi")?a(f.N.setIsContract(!0)):a(f.N.setIsContract(!1)),e.abrupt("return",!0);case 19:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[i,n]),X=(0,w.useCallback)(function(){var e=o()(c()().mark((function e(t,n,s){var i,o,u,l;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],o={},u={},n.forEach((function(e){var n=e.max_token_supply.symbol.name,s=e.init_nft_price.symbol.name,r=e.id,a=e.nft_img,c=e.project_name,i="";"DFS"===s?i="eosio.token-DFS-8":"USDT"===s?i="usdtusdtusdt-USDT-8":"ORDI"===s&&(i="ordiordiordi-ORDI-8");var o=t[i];u[r]={logo:a,sym:n,price:o,name:c}})),s.forEach((function(e){var t=e.pid.toString(),n=e.current_price.value,s=u[t].price*n,r=u[t].name;o.hasOwnProperty(t)?(o[t].count+=1,o[t].value+=s):o[t]={count:1,value:s,logo:u[t].logo,sym:u[t].sym,name:r}})),l=0,Object.keys(o).forEach((function(e){l+=o[e].value,i.push(r()({pid:e},o[e]))})),i.sort((function(e,t){return t.value-e.value})),a(f.N.setNfts(i)),a(f.N.setNftsValue(l)),a(f.N.setNftsLoading(!1));case 11:case"end":return e.stop()}}),e)})));return function(t,n,s){return e.apply(this,arguments)}}(),[]),ee=(0,w.useCallback)(function(){var e=o()(c()().mark((function e(t,s,r,i,o,u){var l,d,m,h,x,v,g,b,k,y,N,S,w,C,_,V;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l=[],m={},h=[],x=[],v=0,g={balValue:0,reserveValue:0,diffValue:0},"usdtusdtusdt-USDT-8",b="eosio.token-DFS-8",k=[],(d={})["usdtusdtusdt-USDT-8"]=1,d[b]=(0,p.ri)(r[0].reserve0)/(0,p.ri)(r[0].reserve1),r.forEach((function(e){var t=e.contract0.toString()+"-"+e.sym0.toString().split(",")[1]+"-"+e.sym0.toString().split(",")[0],n=e.contract1.toString()+"-"+e.sym1.toString().split(",")[1]+"-"+e.sym1.toString().split(",")[0];l.includes(t)||(l.push(t),m[t]=l.length),l.includes(n)||(l.push(n),m[n]=l.length);var s=(0,p.ri)(e.reserve0),r=(0,p.ri)(e.reserve1);"eosio.token"===e.contract0.toString()?d.hasOwnProperty(n)||(d[n]=s/r*d[b]):"eosio.token"===e.contract1.toString()?d.hasOwnProperty(t)||(d[t]=r/s*d[b]):"usdtusdtusdt"===e.contract0.toString()?d.hasOwnProperty(n)||(d[n]=s/r):"usdtusdtusdt"===e.contract1.toString()?d.hasOwnProperty(t)||(d[t]=r/s):k.push({key0:t,key1:n,value0:s,value1:r})})),k.forEach((function(e){d.hasOwnProperty(e.key0)&&!d.hasOwnProperty(e.key1)?d[e.key1]=e.value0/e.value1*d[e.key0]:!d.hasOwnProperty(e.key0)&&d.hasOwnProperty(e.key1)?d[e.key0]=e.value1/e.value0*d[e.key1]:d.hasOwnProperty(e.key0)||d.hasOwnProperty(e.key1)||(d[e.key0]=0,d[e.key1]=0),Number.isNaN(d[e.key0])&&(d[e.key0]=0)})),Object.keys(d).forEach((function(e){Number.isNaN(d[e])&&(d[e]=0)})),d["dfs3protocol-DFS-8"]=0,y={},i.forEach((function(e){var t=e.max_token_supply.symbol.name;y[t]=e.token_url})),X(d,i,o),N=[],D.forEach((function(e){N.push(t.client.v1.chain.get_currency_balance(e,u))})),e.next=24,Promise.all(N);case 24:S=e.sent,w=c()().mark((function e(t){return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S[t].length){e.next=2;break}return e.abrupt("return",1);case 2:S[t].forEach((function(e){if(e.value){var n=e.symbol.precision.toString(),s=e.symbol.name,r=D[t],a=r+"-"+s,c="".concat(a,"-").concat(n),i=d[c],o=(0,p.ri)(e)*i,u="dfsppptokens"===r?y[s]:"https://dfs.land/assets/tokens/".concat(a,".png");v+=o,h.push({key:a,contract:r,sym:s,precision:n,price:i,asset:e,value:o,logo:u})}}));case 3:case"end":return e.stop()}}),e)})),C=0;case 27:if(!(C<S.length)){e.next=34;break}return e.delegateYield(w(C),"t0",29);case 29:if(!e.t0){e.next=31;break}return e.abrupt("continue",31);case 31:++C,e.next=27;break;case 34:return e.next=36,s.load("loglogloglog");case 36:return _=e.sent,V=_.table("liqs"),e.next=40,V.all({scope:(0,p.fD)(u)});case 40:e.sent.forEach((function(e){var t=r.find((function(t){return t.mid.equals(e.mid)})),n=t.contract0.toString(),s=t.contract1.toString(),a=t.sym0.name,c=t.sym1.name,i=t.sym0.precision,o=t.sym1.precision,u=n+"-"+a,l=s+"-"+c,f=d[u+"-"+i],m=d[l+"-"+o],h=(0,p.ri)(e.bal0),v=(0,p.ri)(e.bal1),b=h*f,k=v*m,N=e.token.toNumber()/t.liquidity_token.toNumber(),S=N*(0,p.ri)(t.reserve0),w=N*(0,p.ri)(t.reserve1),C=S*f,_=w*m,V=C+_-b-k,D=j()().diff(j().utc(e.start.toString()),"days"),M="dfsppptokens"===n?y[a]:"https://dfs.land/assets/tokens/".concat(u,".png"),E="dfsppptokens"===s?y[c]:"https://dfs.land/assets/tokens/".concat(l,".png");g.reserveValue+=C+_,g.balValue+=b+k,x.push({ratio:N,contract0:n,sym0:a,precision0:i,bal0:h,key0:u,bal0Value:b,reserve0Value:C,contract1:s,sym1:c,precision1:o,bal1:v,key1:l,reserve0:S,reserve1:w,price0:f,price1:m,bal1Value:k,reserve1Value:_,diffValue:V,days:D,logo0:M,logo1:E})})),g.diffValue=g.reserveValue-g.balValue,a(f.N.setTokensLoading(!1)),a(f.N.setTokens(h)),a(f.N.setLiqTokens(x)),a(f.N.setTokensValue(v)),a(f.N.setLiqsValue(g)),a(f.N.setDfsPrice(d[b])),e.next=56;break;case 51:e.prev=51,e.t1=e.catch(0),a(f.N.setTokensLoading(!1)),a(f.N.setNftsLoading(!1)),(0,p.Tv)(e.t1,n);case 56:case"end":return e.stop()}}),e,null,[[0,51]])})));return function(t,n,s,r,a,c){return e.apply(this,arguments)}}(),[n,X,D]),te=(0,w.useCallback)(function(){var e=o()(c()().mark((function e(t,s){var r,o,l,d,m,h,x,g,b,k,y,j,S;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(N&&u&&i)){e.next=58;break}return a(f.N.setLoading(!0)),a(f.N.setTokensLoading(!0)),a(f.N.setNftsLoading(!0)),e.next=6,W(t,s);case 6:if(e.sent){e.next=11;break}return a(f.N.setLoading(!1)),a(f.N.setTokensLoading(!1)),a(f.N.setNftsLoading(!1)),e.abrupt("return");case 11:return e.prev=11,r="",e.next=15,N.load(t);case 15:return o=e.sent,e.next=18,u.load("swapswapswap");case 18:return l=e.sent,e.next=21,u.load("dfsweb3desoc");case 21:return d=e.sent,e.next=24,u.load("dfs3protocol");case 24:return m=e.sent,h=l.table("markets"),x=d.table("profiles"),g=m.table("projects"),b=m.table("registry"),e.next=31,b.all({scope:"dfs3protocol",from:t,to:t,index_position:"tertiary",key_type:"name"});case 31:return k=e.sent,e.next=34,h.all();case 34:return y=e.sent,e.next=37,x.all({scope:"dfsweb3desoc",from:t,to:t});case 37:return(j=e.sent).length||j.push({avatar:"",cover:"",desc:"",join:"",nick:"",owner:v.VG.from(t),sex:v.zM.from(2),update:""}),e.next=41,g.all();case 41:S=e.sent,ee(i,u,y,S,k,t),a(f.N.setMarkets(y)),a(f.N.setAccountInfo(o)),a(f.N.setCreator(r)),a(f.N.setProfile(j[0])),L(""),a(f.N.setLoading(!1)),M.current&&M.current.handleSearch(),e.next=58;break;case 52:e.prev=52,e.t0=e.catch(11),a(f.N.setLoading(!1)),a(f.N.setTokensLoading(!1)),a(f.N.setNftsLoading(!1)),(0,p.Tv)(e.t0,n);case 58:case"end":return e.stop()}}),e,null,[[11,52]])})));return function(t,n){return e.apply(this,arguments)}}(),[N,u,i,W,n,ee]),ne=(0,w.useCallback)((0,S.debounce)(function(){var e=o()(c()().mark((function e(t){var n,s,r,a;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.value,/^[a-z1-5.]{1,12}$/.test(n)){e.next=6;break}0===n.trim().length?L(""):L("error"),e.next=12;break;case 6:return e.next=8,(0,p.zI)(i.client.v1.chain.get_account(n));case 8:s=e.sent,r=l()(s,2),a=r[1],L(a?"":"error");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),1e3),[i]),se=[{key:"info",label:(0,F.jsx)("span",{className:"text-lg font-semibold",children:Y}),children:!!_&&(0,F.jsx)(z,{handleSearch:te})},{key:"token",label:(0,F.jsx)("span",{className:"text-lg font-semibold",children:G}),children:!!_&&(0,F.jsx)(d.DL,{})},{key:"nft",label:(0,F.jsx)("span",{className:"text-lg font-semibold",children:H}),children:!!_&&(0,F.jsx)(d.tw,{})},{key:"liq",label:(0,F.jsx)("span",{className:"text-lg font-semibold",children:J}),children:!!_&&(0,F.jsx)(d.uq,{})},{key:"tip",label:(0,F.jsx)("span",{className:"text-lg font-semibold",children:Q}),disabled:!0}],re=(0,w.useCallback)((function(e,t){var n={};e&&(n.search=e),n.tab=t||C,I(n)}),[C]);return(0,w.useEffect)((function(){var e=q.get("search"),t=q.get("tab");t&&a(f.N.setActiveKey(t)),e&&te(e,""),re(e,t)}),[te]),(0,w.useEffect)((function(){var e=_?_.accountName.toString():"";re(e,C)}),[_,C,re]),(0,F.jsxs)(m._z,{className:"ppp-account",ghost:!0,children:[(0,F.jsxs)(h.Z,{title:(0,F.jsx)("div",{className:"hardline font-semibold text-lg mb-3",children:R}),children:[(0,F.jsx)(b.Z.Search,{className:" ",loading:V,addonBefore:(0,F.jsx)(k.Z,{spinning:V,children:K}),placeholder:"Search...",allowClear:!0,enterButton:$,size:"large",status:T,onSearch:te,onChange:ne}),(0,F.jsx)(y.Z,{className:"mt-2",items:se,activeKey:U,onChange:function(e){a(f.N.setActiveKey(e))}})]}),s]})}},8849:function(){}}]);