"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[428],{25738:function(e,t,n){n.r(t),n.d(t,{default:function(){return j}});var r=n(15009),a=n.n(r),s=n(99289),c=n.n(s),o=n(5574),u=n.n(o),i=n(84737),l=n(3990),f=n(64119),d=n(11774),p=n(38345),b=n(59530),m=n(80507),g=n(45360),v=n(69677),h=n(92398),x=n(9669),k=n.n(x),y=n(27484),N=n.n(y),S=n(96486),w=n(62435),V=(n(20034),n(86074)),j=function(){var e=g.ZP.useMessage(),t=u()(e,2),n=t[0],r=t[1],s=(0,b.useDispatch)(),o=(0,b.useSelector)((function(e){return e.global.session})),x=(0,b.useSelector)((function(e){return e.global.contractKit})),y=(0,b.useSelector)((function(e){return e.global.accountKit})),j=(0,b.useSelector)((function(e){return e.account.activeKey})),L=(0,b.useSelector)((function(e){return e.account.accountInfo})),T=(0,b.useSelector)((function(e){return e.account.loading})),M=(0,w.useState)(""),C=u()(M,2),q=C[0],z=C[1],A=(0,b.useSearchParams)(),I=u()(A,2),_=I[0],K=I[1],P=(0,b.useIntl)(),E=P.formatMessage({id:"account.intlAccount"}),Z=P.formatMessage({id:"account.intlSearch"}),B=P.formatMessage({id:"contract.intlAccountFormatError"}),D=P.formatMessage({id:"account.intlSearchAccount"}),F=P.formatMessage({id:"account.intlProfile"}),O=P.formatMessage({id:"account.intlAuth"}),$=P.formatMessage({id:"account.intlToken"}),G=P.formatMessage({id:"account.intlLiq"}),R=P.formatMessage({id:"account.intlTx"}),U=(0,w.useCallback)(function(){var e=c()(a()().mark((function e(t,r){var c,i,d,p;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(/^[a-z1-5.]{1,12}$/.test(t)){e.next=8;break}if(t||r.hasOwnProperty("type")){e.next=4;break}return e.abrupt("return",!1);case 4:return n.error("".concat(B)),e.abrupt("return",!1);case 8:return e.next=10,(0,f.zI)(o.client.v1.chain.get_abi(t));case 10:if(c=e.sent,i=u()(c,2),d=i[0],p=i[1],!d){e.next=17;break}return n.error(d),e.abrupt("return",!1);case 17:return!d&&p.hasOwnProperty("abi"),s(l.N.setIsContract(!0)),e.abrupt("return",!0);case 19:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[o,n]),H=(0,w.useCallback)(function(){var e=c()(a()().mark((function e(t,r,c,o){var i,d,p,b,g,v,h,x,y,S,w,V,j,L,T,M,C,q,z,A;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=[],p={},b=[],g=[],v=0,h={balValue:0,reserveValue:0,diffValue:0},(d={})["usdtusdtusdt-USDT-8"]=1,c.forEach((function(e){var t=e.contract0.toString()+"-"+e.sym0.toString().split(",")[1]+"-"+e.sym0.toString().split(",")[0],n=e.contract1.toString()+"-"+e.sym1.toString().split(",")[1]+"-"+e.sym1.toString().split(",")[0];i.includes(t)||(i.push(t),p[t]=i.length),i.includes(n)||(i.push(n),p[n]=i.length),"usdtusdtusdt"===e.contract0.toString()?d[n]=e.reserve0.value/e.reserve1.value:"usdtusdtusdt"===e.contract1.toString()&&(d[t]=e.reserve1.value/e.reserve0.value)})),e.next=12,(0,f.zI)(k().get("https://api2.dfsmoon.com/v2/state/get_tokens?limit=1000&account=".concat(o),{timeout:2e3}));case 12:if(x=e.sent,y=u()(x,2),S=y[0],w=y[1],S||200!==w.status){e.next=21;break}w.data.tokens.forEach((function(e){var t=e.contract+"-"+e.symbol,n=d[t+"-"+e.precision],r=e.amount*n;v+=r,b.push({key:t,contract:e.contract,sym:e.symbol,precision:String(e.precision),price:n,asset:m.xR.from(e.amount.toFixed(e.precision)+" "+e.symbol),value:r})})),b.sort((function(e,t){return p[e.key+"-"+e.precision]-p[t.key+"-"+t.precision]})),e.next=38;break;case 21:V=0;case 22:if(!(V<i.length)){e.next=38;break}return j=i[V].split("-")[0],L=i[V].split("-")[1],T=i[V].split("-")[2],M=d[i[V]],e.next=29,t.client.v1.chain.get_currency_balance(j,o,L);case 29:if((C=e.sent).length){e.next=32;break}return e.abrupt("continue",35);case 32:q=C[0].value*M,v+=q,b.push({key:j+"-"+L,contract:j,sym:L,precision:T,price:M,asset:C[0],value:q});case 35:V++,e.next=22;break;case 38:return e.next=40,r.load("loglogloglog");case 40:return z=e.sent,A=z.table("liqs"),e.next=44,A.all({scope:o});case 44:e.sent.forEach((function(e){var t=c.find((function(t){return t.mid.equals(e.mid)})),n=t.contract0.toString(),r=t.contract1.toString(),a=t.sym0.name,s=t.sym1.name,o=t.sym0.precision,u=t.sym1.precision,i=n+"-"+a,l=r+"-"+s,f=d[i+"-"+o],p=d[l+"-"+u],b=e.bal0.value,m=e.bal1.value,v=b*f,x=m*p,k=e.token.toNumber()/t.liquidity_token.toNumber(),y=k*t.reserve0.value,S=k*t.reserve1.value,w=y*f,V=S*p,j=w+V-v-x,L=N()().diff(N().utc(e.start.toString()),"days");h.reserveValue+=w+V,h.balValue+=v+x,g.push({ratio:k,contract0:n,sym0:a,precision0:o,bal0:b,key0:i,bal0Value:v,reserve0Value:w,contract1:r,sym1:s,precision1:u,bal1:m,key1:l,reserve0:y,reserve1:S,price0:f,price1:p,bal1Value:x,reserve1Value:V,diffValue:j,days:L})})),h.diffValue=h.reserveValue-h.balValue,s(l.N.setTokensLoading(!1)),s(l.N.setTokens(b)),s(l.N.setLiqTokens(g)),s(l.N.setTokensValue(v)),s(l.N.setLiqsValue(h)),e.next=58;break;case 54:e.prev=54,e.t0=e.catch(0),s(l.N.setTokensLoading(!1)),(0,f.Tv)(e.t0,n);case 58:case"end":return e.stop()}}),e,null,[[0,54]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),[n]),J=(0,w.useCallback)(function(){var e=c()(a()().mark((function e(t,r){var c,u,i,d,p,b,g,v,h,k;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(y&&x&&o)){e.next=49;break}return s(l.N.setLoading(!0)),s(l.N.setTokensLoading(!0)),e.next=5,U(t,r);case 5:if(e.sent){e.next=9;break}return s(l.N.setLoading(!1)),s(l.N.setTokensLoading(!1)),e.abrupt("return");case 9:return e.prev=9,e.next=12,y.load(t);case 12:return c=e.sent,e.next=15,x.load("swapswapswap");case 15:return u=e.sent,e.next=18,x.load("dfsweb3desoc");case 18:return i=e.sent,e.next=21,x.load("dfsbpsvoters");case 21:return d=e.sent,p=u.table("markets"),b=i.table("profiles"),g=d.table("voters"),e.next=27,p.all();case 27:return v=e.sent,e.next=30,g.all({scope:"dfsbpsvoters",from:t,to:t});case 30:return h=e.sent,e.next=33,b.all({scope:"dfsweb3desoc",from:t,to:t});case 33:(k=e.sent).length||k.push({avatar:"",cover:"",desc:"",join:"",nick:"",owner:m.VG.from(t),sex:m.zM.from(2),update:""}),H(o,x,v,t),s(l.N.setMarkets(v)),s(l.N.setAccountInfo(c)),s(l.N.setProfile(k[0])),s(l.N.setVoter(h[0])),z(""),s(l.N.setLoading(!1)),e.next=49;break;case 44:e.prev=44,e.t0=e.catch(9),s(l.N.setLoading(!1)),s(l.N.setTokensLoading(!1)),(0,f.Tv)(e.t0,n);case 49:case"end":return e.stop()}}),e,null,[[9,44]])})));return function(t,n){return e.apply(this,arguments)}}(),[y,x,o,U,n,H]),Q=(0,w.useCallback)((0,S.debounce)(function(){var e=c()(a()().mark((function e(t){var n,r,s,c;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.value,/^[a-z1-5.]{1,12}$/.test(n)){e.next=6;break}0===n.trim().length?z(""):z("error"),e.next=12;break;case 6:return e.next=8,(0,f.zI)(o.client.v1.chain.get_account(n));case 8:r=e.sent,s=u()(r,2),c=s[1],z(c?"":"error");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),1e3),[o]),W=[{key:"info",label:(0,V.jsx)("span",{className:"text-lg font-semibold",children:F}),children:!!L&&(0,V.jsx)(i.i3,{})},{key:"auth",label:(0,V.jsx)("span",{className:"text-lg font-semibold",children:O}),children:!!L&&(0,V.jsx)(i.Bf,{})},{key:"token",label:(0,V.jsx)("span",{className:"text-lg font-semibold",children:$}),children:!!L&&(0,V.jsx)(i.DL,{})},{key:"liq",label:(0,V.jsx)("span",{className:"text-lg font-semibold",children:G}),children:!!L&&(0,V.jsx)(i.uq,{})},{key:"tx",label:(0,V.jsx)("span",{className:"text-lg font-semibold",children:R}),children:!!L&&(0,V.jsx)(i.ps,{})}];return(0,w.useEffect)((function(){var e=_.get("search");e&&(J(e,""),K({}))}),[J]),(0,V.jsxs)(d._z,{className:"account",ghost:!0,children:[(0,V.jsxs)(p.Z,{children:[(0,V.jsx)("div",{className:"hardline text-lg font-semibold mb-3",children:D}),(0,V.jsx)(v.Z.Search,{className:"pl-[13px] ",loading:T,addonBefore:E,placeholder:"Search...",allowClear:!0,enterButton:Z,size:"large",status:q,onSearch:J,onChange:Q}),(0,V.jsx)(h.Z,{className:"mt-2",defaultActiveKey:"tables",items:W,activeKey:j,onChange:function(e){return s(l.N.setActiveKey(e))}})]}),r]})}},20034:function(){}}]);