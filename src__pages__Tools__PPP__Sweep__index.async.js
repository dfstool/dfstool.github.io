"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8045],{218:function(e,t,r){r.d(t,{s:function(){return f}});var n=r(5574),a=r.n(n),s=r(37476),c=r(90672),i=r(59530),o=r(45360),l=r(62435),u=r(86074),d=l.forwardRef((function(e,t){var r=o.ZP.useMessage(),n=a()(r,2),d=n[0],f=n[1],p=(0,l.useRef)(),m=(0,l.useState)(!1),h=a()(m,2),x=h[0],v=h[1],g=(0,l.useState)(""),b=a()(g,2),j=b[0],S=b[1],k=(0,l.useState)(""),w=a()(k,2),N=w[0],y=w[1],Z=(0,i.useIntl)(),C=Z.formatMessage({id:"msig.intlPreviewFail"}),F=Z.formatMessage({id:"msig.intlClose"}),_=(0,l.useCallback)((function(e){var t=new FileReader;t.readAsText(e.originFileObj),t.onload=function(){try{var r,n=JSON.parse(t.result);if(n)null===(r=p.current)||void 0===r||r.setFieldValue("content",JSON.stringify(n,null,2)),S(JSON.stringify(n,null,2)),y(e.name),v(!0);else d.error("".concat(C))}catch(e){d.error("".concat(C))}}}),[]);return(0,l.useImperativeHandle)(t,(function(){return{handleOpen:_}})),(0,u.jsxs)(s.Y,{formRef:p,title:(0,u.jsx)("div",{className:"mt-3",children:N}),open:x,onOpenChange:function(e){v(e)},layout:"vertical",width:"700px",modalProps:{style:{top:25}},submitter:{searchConfig:{resetText:F},render:function(e,t){return[t[0]]}},children:[(0,u.jsx)(c.Z,{name:"content",fieldProps:{autoSize:{minRows:5},allowClear:!1,autoFocus:!1,onChange:void 0,value:j,size:"large"}}),f]})})),f=(0,l.memo)(d)},30867:function(e,t,r){r.d(t,{Z:function(){return f}});var n=r(62435),a=r(75633),s=r(5574),c=r.n(s),i=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]];function o(e,t){var r=t.format,n=void 0===r?"":r,a=new Date(e).getTime(),s=Date.now();return function(e,t){var r=e,n=/\[[^\]]*]/g,a=(t.match(n)||[]).map((function(e){return e.slice(1,-1)})),s=t.replace(n,"[]"),o=i.reduce((function(e,t){var n=c()(t,2),a=n[0],s=n[1];if(e.includes(a)){var i=Math.floor(r/s);return r-=i*s,e.replace(new RegExp("".concat(a,"+"),"g"),(function(e){var t=e.length;return i.toString().padStart(t,"0")}))}return e}),s),l=0;return o.replace(n,(function(){var e=a[l];return l+=1,e}))}(Math.max(a-s,0),n)}var l=r(51409),u=r(86074);var d=function(e){var t=e.value,r=e.format,s=void 0===r?"HH:mm:ss":r,c=e.onChange,i=e.onFinish,d=e.className,f=(0,a.N)(),p=n.useRef(null),m=function(){var e=function(e){return new Date(e).getTime()}(t);e>=Date.now()&&(p.current=(0,l.Zi)((function(){f(),null==c||c(e-Date.now()),e<Date.now()&&(null==i||i(),p.current&&((0,l.cv)(p.current),p.current=null))}),33.333333333333336))};return n.useEffect((function(){return m(),function(){p.current&&((0,l.cv)(p.current),p.current=null)}}),[t]),(0,u.jsx)("div",{className:d,children:o(t,{format:s})})},f=n.memo(d)},77306:function(e,t,r){r.r(t);var n=r(64599),a=r.n(n),s=r(19632),c=r.n(s),i=r(97857),o=r.n(i),l=r(15009),u=r.n(l),d=r(99289),f=r.n(d),p=r(5574),m=r.n(p),h=r(30867),x=r(218),v=r(40956),g=r(64119),b=r(87603),j=r(98165),S=r(25035),k=r(11774),w=r(38345),N=r(97269),y=r(64317),Z=r(31199),C=r(52688),F=r(5966),_=r(91604),T=r(59530),M=r(80507),P=r(45360),D=r(7134),L=r(83062),O=r(15867),V=r(66309),Y=r(9669),z=r.n(Y),R=r(27484),E=r.n(R),H=r(70178),q=r.n(H),A=r(62435),$=r(51409),I=r(86074);E().extend(q());var J=[];t.default=function(){var e=(0,T.useDispatch)(),t=P.ZP.useMessage(),r=m()(t,2),n=r[0],s=r[1],i=(0,T.useSelector)((function(e){return e.global.contractKit})),l=(0,T.useSelector)((function(e){return e.global.account})),d=(0,T.useSelector)((function(e){return e.global.session})),p=(0,T.useSelector)((function(e){return e.global.privateKey})),Y=(0,T.useSelector)((function(e){return e.ppp.valueEnum})),R=(0,T.useSelector)((function(e){return e.ppp.stats})),H=(0,T.useSelector)((function(e){return e.ppp.vipAccounts})),q=(0,T.useSelector)((function(e){return e.ppp.accessAccounts})),U=(0,A.useState)([]),K=m()(U,2),W=K[0],Q=K[1],B=(0,A.useState)(0),G=m()(B,2),X=G[0],ee=G[1],te=(0,A.useState)(0),re=m()(te,2),ne=re[0],ae=re[1],se=(0,A.useState)(0),ce=m()(se,2),ie=ce[0],oe=ce[1],le=(0,A.useState)(0),ue=m()(le,2),de=ue[0],fe=ue[1],pe=(0,A.useState)(0),me=m()(pe,2),he=me[0],xe=me[1],ve=(0,A.useState)([]),ge=m()(ve,2),be=ge[0],je=ge[1],Se=(0,A.useState)(""),ke=m()(Se,2),we=ke[0],Ne=ke[1],ye=(0,A.useState)(0),Ze=m()(ye,2)[1],Ce=(0,A.useState)(0),Fe=m()(Ce,2),_e=Fe[0],Te=Fe[1],Me=(0,A.useState)(!1),Pe=m()(Me,2),De=Pe[0],Le=Pe[1],Oe=(0,A.useState)({}),Ve=m()(Oe,2),Ye=Ve[0],ze=Ve[1],Re=(0,A.useState)({}),Ee=m()(Re,2),He=Ee[0],qe=Ee[1],Ae=(0,A.useState)(!1),$e=m()(Ae,2),Ie=$e[0],Je=$e[1],Ue=(0,A.useState)(!1),Ke=m()(Ue,2),We=Ke[0],Qe=Ke[1],Be=(0,A.useState)(!1),Ge=m()(Be,2),Xe=Ge[0],et=Ge[1],tt=(0,T.useIntl)(),rt=tt.formatMessage({id:"coffee.inputException"}),nt=tt.formatMessage({id:"msig.intlSendTransaction"}),at=tt.formatMessage({id:"msig.intlSend"}),st=tt.formatMessage({id:"msig.intlUploadFail"}),ct=tt.formatMessage({id:"msig.intlUploadSuccess"}),it=tt.formatMessage({id:"msig.intlTransactionEmpty"}),ot=tt.formatMessage({id:"common.intlPleaseConnectWallet"}),lt=tt.formatMessage({id:"common.intlPleaseConnectNetwork"}),ut=(0,A.useRef)({}),dt=(0,A.useRef)(),ft=(0,A.useRef)(),pt=(0,A.useRef)(),mt=(0,A.useRef)(),ht=(0,A.useRef)(!0),xt=(0,A.useCallback)((function(){var e=0,t=0,r=0,n=0;for(var a in ut.current)"success"===ut.current[a].status?t+=1:"error"===ut.current[a].status?r+=1:"processing"===ut.current[a].status?n+=1:"default"===ut.current[a].status&&(e+=1);ee(t),ae(r),oe(n),fe(e)}),[]),vt=(0,A.useCallback)(function(){var e=f()(u()().mark((function e(t){var r;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],t.forEach((function(e){if("success"!==ut.current[e.cid].status&&"processing"!==ut.current[e.cid].status&&("error"!==ut.current[e.cid].status||!ut.current[e.cid].message.includes("invalid price"))){var t=new Promise((function(t){ut.current[e.cid].status="processing",xt(),d.client.v1.chain.push_transaction(e.signedTransaction).then((function(r){r&&r.processed&&"executed"===r.processed.receipt.status?(ut.current[e.cid].status="success",xt(),t(!0)):("success"!==ut.current[e.cid].status&&(ut.current[e.cid].status="error",J.push({cid:e.cid,error:JSON.stringify(r),pos:"then"}),console.log(r),xt()),t(!1))})).catch((function(r){if("success"!==ut.current[e.cid].status){if(ut.current[e.cid].status="error",xt(),J.push({cid:e.cid,error:JSON.stringify(r),pos:"catch"}),r instanceof Error)if(r.message.includes("eosio_assert_message assertion failure"))r.details[0].message.includes("invalid price")&&(ut.current[e.cid].message="invalid price");console.log(r)}t(!1)}))}));r.push(t)}}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[d,xt]),gt=(0,A.useCallback)(function(){var e=f()(u()().mark((function e(t){var r,a,s,f,h,x,v,b,j,S,k,w,N,y,Z,C,F,_,T,P,D,L,O,V,Y,z,R,q,A,$,I,J,U,K,W,Q,B,G,X,ee,te,re,ne,ae,se,ce,ie,oe,le,ue,de,fe,pe,me,he,xe,ve,ge,be,je,Se;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,d&&d.broadcast){e.next=6;break}return n.error("".concat(ot)),e.abrupt("return");case 6:if(l){e.next=9;break}return n.error("".concat(lt)),e.abrupt("return");case 9:if("owner"===(a=d.permissionLevel.permission.toString())||"active"===a){e.next=13;break}return n.error("permission权限必须是owner或者active"),e.abrupt("return");case 13:return Qe(!0),s=t.pidCreate,f=t.countCreate,h=t.disorderCreate,x=t.split,v=t.startCreate,b=t.endCreate,j=Number(s.split("-")[1]),S=d.actor.toString(),e.next=19,i.load("dfs3protocol");case 19:return k=e.sent,e.next=22,d.client.v1.chain.get_table_rows({code:"dfs3protocol",table:"registry",scope:"dfs3protocol",key_type:"i64",index_position:"secondary",lower_bound:M.zM.from(j),upper_bound:M.zM.from(j),limit:1e3});case 22:return w=e.sent,N=w.rows,y=k.table("projects"),e.next=27,y.all({scope:"dfs3protocol",from:j,to:j});case 27:if(Z=e.sent,C=Z[0].creator.toString(),F=Z[0].nft_name.toString(),_=Z[0].project_name,T=Z[0].init_nft_price.value,P=Z[0].init_nft_price.symbol.name,D=Z[0].sec_per_round.toNumber(),L=Z[0].last_round.toString(),L=E().utc(L).local().format("YYYY-MM-DDTHH:mm:ss"),O="","DFS"!==P){e.next=41;break}O="eosio.token",e.next=52;break;case 41:if("USDT"!==P){e.next=45;break}O="usdtusdtusdt",e.next=52;break;case 45:if("ORDI"!==P){e.next=49;break}O="ordiordiordi",e.next=52;break;case 49:return n.error("不支持当前项目"),Qe(!1),e.abrupt("return");case 52:if(!(v>N.length)){e.next=56;break}return n.error("开始序号超过当前项目最大值".concat(N.length)),Qe(!1),e.abrupt("return");case 56:if(!b){e.next=65;break}if(!(v>b)){e.next=61;break}return n.error("开始序号超过结束序号"),Qe(!1),e.abrupt("return");case 61:V=N.length>b?b:N.length,N=N.slice(v-1,V),e.next=66;break;case 65:N=N.slice(v-1);case 66:return Y={account:"dfsfreecpu11",name:"freecpu",authorization:[{actor:"dfs.service",permission:"cpu"},d.permissionLevel],data:g._9.from({user:S})},z=M.aU.from(Y),e.next=70,d.client.v1.chain.get_info();case 70:R=e.sent,q=R.getTransactionHeader(),A=E()(),$=[],I=0,J="",U=0,h&&N.sort((function(){return Math.random()-.5})),K=0;case 79:if(!(K<N.length)){e.next=125;break}if(W=N[K].owner,Q=Number(N[K].current_price.split(" ")[0]),W!==S){e.next=84;break}return e.abrupt("continue",122);case 84:if(!(Q>=2*T)){e.next=86;break}return e.abrupt("continue",122);case 86:if(!(I>=f)){e.next=88;break}return e.abrupt("break",125);case 88:if(!(I>=3e3)){e.next=90;break}return e.abrupt("break",125);case 90:return J=E()(A).add(3600-I++,"seconds").utc().format("YYYY-MM-DDTHH:mm:ss"),B=N[K].current_price,G=M.xR.from(B),X=G.value,ee=G.symbol,te=M.xR.from(.005*X,ee),re="buy:"+N[K].id.toString(),U+=X,ne={account:O,name:"transfer",authorization:[d.permissionLevel],data:g.FE.from({from:S,to:"dfs3protocol",quantity:B,memo:re})},ae=M.aU.from(ne),se={account:O,name:"transfer",authorization:[d.permissionLevel],data:g.FE.from({from:S,to:"davidaccount",quantity:te,memo:"fee"})},ce=M.aU.from(se),ie=void 0,oe=void 0,le=[],ue=H.includes(S)?[z,ae]:[z,ae,ce],ie=M.YW.from(o()(o()({},q),{},{expiration:J,actions:ue})),le[0]=p.signDigest(ie.signingDigest(d.chain.id.toString())),e.next=110,(0,g.zI)(d.transact({transaction:ie},{broadcast:!1,transactPlugins:[]}));case 110:if(de=e.sent,fe=m()(de,2),pe=fe[0],me=fe[1],!pe){e.next=118;break}return n.error(pe),Qe(!1),e.abrupt("return",!1);case 118:oe=M.uQ.from(o()(o()({},ie),{},{signatures:[].concat(le,c()(me.signatures))})),he=N[K].cid,xe=N[K].id,$.push({signedTransaction:oe,cid:he,nftid:xe,amount:X,from:S});case 122:++K,e.next=79;break;case 125:ve=1,ge=Math.ceil($.length/x),be=E()().format("YYYY-MM-DDTHH:mm:ss"),je=u()().mark((function e(){var t,r,n,a,s,c,i,o,l;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0,r=[],n=[],(a=$.splice(0,ge)).forEach((function(e){r.push(e.cid),n.push(e.nftid),t+=e.amount})),s=H.includes(S)?t.toFixed(8)+" "+P:(1.005*t).toFixed(8)+" "+P,r.sort(),n.sort(),c={infos:{pid:j,creator:C,project_name:_,nft_name:F,token_symbol:P,last_round:L,sec_per_round:D,from:S,split:x,disorder:h,start:r[0],end:r[r.length-1],count:a.length,amount:s,cid_array:r,nftid_array:n},transactions:a},i=JSON.stringify(c,null,2),o="data:,".concat(i),(l=document.createElement("a")).href=o,l.download="".concat(S,"_").concat(j,"_").concat(I,"-").concat(ve++,"_").concat(F,"_").concat(C,"_").concat(be,".json"),l.click();case 15:case"end":return e.stop()}}),e)}));case 129:if(!$.length){e.next=133;break}return e.delegateYield(je(),"t0",131);case 131:e.next=129;break;case 133:return Se=H.includes(S)?U.toFixed(8)+" "+P:(1.005*U).toFixed(8)+" "+P,null===(r=dt.current)||void 0===r||r.setFieldValue("amountCreate",Se),n.success("创建完成"),Qe(!1),e.abrupt("return",!0);case 140:e.prev=140,e.t1=e.catch(0),Qe(!1),(0,g.Tv)(e.t1,n);case 144:return e.abrupt("return",!0);case 145:case"end":return e.stop()}}),e,null,[[0,140]])})));return function(t){return e.apply(this,arguments)}}(),[i,d,l,H]),bt=(0,A.useCallback)(function(){var e=f()(u()().mark((function e(t){var r;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==be.length){e.next=3;break}return n.error(it),e.abrupt("return",!1);case 3:return r=t.disorderSend,e.prev=4,r?be.sort((function(){return Math.random()-.5})):be.sort((function(e,t){return e.cid-t.cid})),vt(be),e.abrupt("return",!0);case 10:e.prev=10,e.t0=e.catch(4),(0,g.Tv)(e.t0,n);case 13:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}(),[be,vt]),jt=(0,A.useCallback)((function(e,t){var r=E()(e).add(t,"seconds").valueOf();Te(r)}),[]),St=(0,A.useCallback)((function(e){var t,r,n=null===(t=ft.current)||void 0===t?void 0:t.getFieldValue("leadTimeSend");n&&e<n&&ht.current&&(ht.current=!1,null===(r=ft.current)||void 0===r||r.submit())}),[]),kt=(0,A.useCallback)((function(){var e;if(null!==(e=ft.current)&&void 0!==e&&e.getFieldValue("auto")){if(0===be.length)return n.error(it),!1;var t=ft.current.getFieldsValue(),r=t.disorderSend,a=t.repeatSend,s=t.intervalSend;try{r?be.sort((function(){return Math.random()-.5})):be.sort((function(e,t){return e.cid-t.cid})),vt(be);for(var c=1;c<a;c++)(0,$.iK)(vt,s*c,be);return!0}catch(e){(0,g.Tv)(e,n)}}}),[be,vt]),wt=(0,A.useCallback)(function(){var e=f()(u()().mark((function e(t){var r,s,c,i,o,l,d,f,p,m,h,x,v,b,j;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=16;break}return ut.current={},qe({}),ae(0),ee(0),oe(0),fe(0),je([]),Ne(""),Te(0),Ze(0),ze({}),xe(0),null===(r=ft.current)||void 0===r||r.setFieldValue("amountSend",""),ht.current=!0,e.abrupt("return");case 16:e.prev=16,c=[],i=new Set,o=[],l={},d=0,f={infos:{},transactions:[]},p=a()(t),e.prev=24,h=u()().mark((function e(){var t,r;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.value,e.next=3,new Promise((function(e){var r=new FileReader;r.readAsText(t.originFileObj),r.onload=function(){return e(r.result)}}));case 3:r=e.sent,(f=JSON.parse(r)).transactions.forEach((function(e){i.has(e.cid)||(o.push(e),i.add(e.cid))}));case 6:case"end":return e.stop()}}),e)})),p.s();case 27:if((m=p.n()).done){e.next=31;break}return e.delegateYield(h(),"t0",29);case 29:e.next=27;break;case 31:e.next=36;break;case 33:e.prev=33,e.t1=e.catch(24),p.e(e.t1);case 36:return e.prev=36,p.f(),e.finish(36);case 39:x=f.infos.last_round,v=f.infos.sec_per_round,b=E()(x).add(v,"seconds").format("YYYY-MM-DDTHH:mm:ss"),jt(x,v),j=f.infos.token_symbol,o.forEach((function(e){var t=M.uQ.from(e.signedTransaction);c.push({cid:e.cid,nftid:e.nftid,amount:e.amount,from:e.from,signedTransaction:t}),l[e.cid]={status:"default",message:""},d+=e.amount})),null===(s=ft.current)||void 0===s||s.setFieldValue("amountSend",d.toFixed(8)+" "+j),ut.current=l,qe({}),ae(0),ee(0),oe(0),fe(c.length),je(c),Ne(b),Ze(v),ze(f.infos),xe(0),ht.current=!0,e.next=63;break;case 60:e.prev=60,e.t2=e.catch(16),(0,g.Tv)(e.t2,n);case 63:case"end":return e.stop()}}),e,null,[[16,60],[24,33,36,39]])})));return function(t){return e.apply(this,arguments)}}(),[jt]),Nt=(0,A.useCallback)(function(){var e=f()(u()().mark((function e(t){var r;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("removed"!==t.file.status){e.next=4;break}return Q(t.fileList),wt(t.fileList),e.abrupt("return");case 4:(r=new FileReader).readAsText(t.fileList[t.fileList.length-1].originFileObj),r.onload=function(){try{JSON.parse(r.result)?(Q(t.fileList),wt(t.fileList),n.success("".concat(ct))):n.error("".concat(st))}catch(e){(0,g.Tv)(e,n)}};case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[wt]),yt=(0,A.useCallback)((function(){var e;null===(e=ft.current)||void 0===e||e.resetFields(),Q([]),ae(0),ee(0),oe(0),fe(0),je([]),Ne(""),Te(0),Ze(0),ut.current={},qe({}),ze({}),xe(0),xt(),ht.current=!0}),[xt]),Zt=(0,A.useCallback)(function(){var t=f()(u()().mark((function t(r){var a,s,c,i,o,l,d,f,p,m,h;return u()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.load("dfs3protocol");case 3:return c=t.sent,i=c.table("projects"),o=c.table("stat"),t.next=8,i.all({scope:"dfs3protocol"});case 8:return l=t.sent,t.next=11,o.all({scope:"dfs3protocol"});case 11:return d=t.sent,t.next=14,z().get("https://api.dfs.land/dfschain/pppvolume2");case 14:200!==(f=t.sent).status&&n.error("获取pppvolume2数据失败"),p=f.data,m=[],l.forEach((function(e){p.hasOwnProperty(e.id.toString())&&m.push(e)})),m.sort((function(e,t){var r=e.id.toString(),n=t.id.toString();return p[n].volume_24h-p[r].volume_24h})),h={},m.forEach((function(e){var t=e.nft_img,r=e.id.toString(),n=e.project_name,a=e.creator.toString();h["pid-"+r]="".concat(r,"-").concat(n,"-").concat(a,"-").concat(t)})),null===(a=dt.current)||void 0===a||a.setFieldValue("pidCreate",""),null===(s=pt.current)||void 0===s||s.setFieldValue("pidAuto",""),e(v.N.setValueEnum(h)),e(v.N.setStats(d)),et(!1),t.next=33;break;case 29:t.prev=29,t.t0=t.catch(0),et(!1),(0,g.Tv)(t.t0,n);case 33:case"end":return t.stop()}}),t,null,[[0,29]])})));return function(e){return t.apply(this,arguments)}}(),[]),Ct=(0,A.useCallback)((function(){return d&&d.broadcast?l?(et(!0),void Zt(i)):(n.error("".concat(lt)),!1):(n.error("".concat(ot)),!1)}),[d,l,Zt,i]),Ft=(0,A.useCallback)(f()(u()().mark((function e(){var t,r,n,a;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(be.length){e.next=2;break}return e.abrupt("return");case 2:return Je(!0),t={},e.next=6,d.client.v1.chain.get_table_rows({code:"dfs3protocol",table:"registry",scope:"dfs3protocol",key_type:"i64",index_position:"secondary",lower_bound:M.zM.from(Ye.pid),upper_bound:M.zM.from(Ye.pid),limit:1e3});case 6:r=e.sent,n=r.rows,a=0,be.forEach((function(e){var r=e.from,s=e.cid;n.filter((function(t){return t.cid===e.cid}))[0].owner===r?(t[s]="success",a+=1):t[s]="default"})),xe(a),qe(t),Je(!1);case 13:case"end":return e.stop()}}),e)}))),[i,n,Ye,be,d]),_t=(0,A.useCallback)((function(e){if(e.hasOwnProperty("countCreate")){var t,r=null===(t=dt.current)||void 0===t?void 0:t.getFieldValue("pidCreate");if(!r)return;var a,s=e.countCreate,c=r.split("-")[1],i=R.filter((function(e){return e.cid.toString()===c}))[0].supply.toNumber();if(s>i)return n.error("购买数量超过当前项目最大值".concat(i)),void(null===(a=dt.current)||void 0===a||a.setFieldValue("startCreate",1))}}),[R,n]),Tt=(0,A.useCallback)((function(){if(De){if(l){var e=l.accountName.toString();return!!q.includes(e)||(Le(!1),!1)}return!0}if(l){var t=l.accountName.toString();return!!q.includes(t)&&(Le(!0),!0)}return!1}),[l,De,q]),Mt=(0,A.useCallback)((function(){var e=E()().format("YYYY-MM-DDTHH:mm:ss"),t=JSON.stringify(J,null,2),r="data:,".concat(t),n=document.createElement("a");n.href=r,n.download="log_".concat(e,".json"),n.click()}),[]);return(0,A.useEffect)((function(){!i||Object.keys(Y).length||Xe||(et(!0),Zt(i))}),[Zt,Y,i,Xe]),(0,I.jsx)(k._z,{className:"",ghost:!0,children:Tt()?(0,I.jsxs)("div",{className:"flex flex-wrap justify-center gap-5",children:[(0,I.jsxs)(w.Z,{title:(0,I.jsx)("div",{className:" font-semibold text-lg hardline",children:"使用说明"}),style:{maxWidth:"400px"},children:[(0,I.jsx)("div",{children:"1. 操作步骤如下："}),(0,I.jsxs)("div",{className:"ml-3",children:["连接钱包 ",(0,I.jsx)(b.Z,{})," 创建交易 ",(0,I.jsx)(b.Z,{})," ","发送交易"]}),(0,I.jsxs)("div",{className:"ml-3",children:["创建交易： 选择项目 ",(0,I.jsx)(b.Z,{})," 输入购买数量"," ",(0,I.jsx)(b.Z,{})," 点击创建按钮 ",(0,I.jsx)(b.Z,{})," ","保存交易文件"]}),(0,I.jsxs)("div",{className:"ml-3",children:["发送交易：上传交易文件 ",(0,I.jsx)(b.Z,{})," 等待倒计时结束"]}),(0,I.jsx)("div",{className:"mt-3",children:"2. 注意事项："}),(0,I.jsx)("div",{className:"ml-3",children:"a）交易文件的有效时间是一个小时，所以要在购买前一个小时内提前生成；"}),(0,I.jsx)("div",{className:"ml-3",children:"b）交易文件的生成过程中，需要用户重复进行多次签名，虽然繁琐，但很安全，无需用户导入私钥；"}),(0,I.jsx)("div",{className:"mt-3",children:"3. 费用说明："}),(0,I.jsx)("div",{className:"ml-3",children:"使用工具抢到的NFT，每个收取0.5%费用。例如工具抢到一个价值为100 DFS的NFT，则工具会收取0.5 DFS作为费用，抢购成功了，才会收取。"})]}),(0,I.jsx)(w.Z,{title:(0,I.jsx)("div",{className:" font-semibold text-lg hardline",children:"创建交易"}),style:{width:"400px"},children:(0,I.jsxs)(N.A,{formRef:dt,onFinish:gt,onValuesChange:_t,layout:"vertical",loading:We,initialValues:{disorderCreate:!0,split:1,startCreate:1},submitter:{searchConfig:{submitText:"创建"},render:function(e,t){return[t[1],t[0]]}},children:[(0,I.jsx)(y.Z,{name:"pidCreate",label:(0,I.jsxs)("div",{children:["项目",(0,I.jsx)(j.Z,{spin:Xe,className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"},onClick:Ct})]}),valueEnum:Y,placeholder:"",rules:[{required:!0,whitespace:!0,message:"".concat(rt),pattern:/^.+$/}],fieldProps:{size:"large",autoFocus:!1,showSearch:!0,filterOption:function(e,t){var r=t.label.split("-"),n=m()(r,3),a=n[0],s=n[1],c=n[2];return(a.padStart(3,"0")+s+c).toLowerCase().includes(e.toLowerCase())},optionItemRender:function(e){var t=e.label.split("-"),r=m()(t,4),n=r[0],a=r[1],s=r[2],c=r[3];return(0,I.jsxs)("div",{className:"flex items-center",children:[(0,I.jsx)("div",{className:"mr-2",children:n.padStart(3,"0")}),(0,I.jsx)(D.C,{className:"mr-2",size:"default",src:c}),(0,I.jsxs)("div",{children:[a," @",s]})]})}}}),(0,I.jsx)(Z.Z,{label:"购买数量",name:"countCreate",placeholder:"",min:1,rules:[{required:!0,message:"".concat(rt),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large"}}),(0,I.jsx)(Z.Z,{label:(0,I.jsxs)("div",{children:["开始序号#",(0,I.jsx)(L.Z,{placement:"topLeft",title:"从具体某个序号开始进行购买",children:(0,I.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"startCreate",placeholder:"",min:1,rules:[{required:!0,message:"".concat(rt),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1}}),(0,I.jsx)(Z.Z,{label:(0,I.jsxs)("div",{children:["结束序号#",(0,I.jsx)(L.Z,{placement:"topLeft",title:"只购买当前序号之前的NFT",children:(0,I.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"endCreate",placeholder:"可选，默认是当前序号的最大值",min:1,rules:[{required:!1,message:"".concat(rt),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large"}}),(0,I.jsx)(Z.Z,{label:(0,I.jsxs)("div",{children:["拆分文件数量",(0,I.jsx)(L.Z,{placement:"topLeft",title:"将所有交易信息拆分成多个文件来保存",children:(0,I.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"split",placeholder:"",min:1,rules:[{required:!0,message:"".concat(rt),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1}}),(0,I.jsx)(C.Z,{name:"disorderCreate",label:(0,I.jsxs)("div",{children:["是否乱序",(0,I.jsx)(L.Z,{placement:"topLeft",title:"是否以乱序的方式来进行购买",children:(0,I.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(rt),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0}}),(0,I.jsx)(F.Z,{name:"amountCreate",label:(0,I.jsxs)("div",{children:["总金额",(0,I.jsx)(L.Z,{placement:"topLeft",title:"此次全部交易所需要的总金额，包含手续费。",children:(0,I.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0}}),(0,I.jsx)("div",{className:" text-red-600 text-lg mb-3",children:"注意：交易文件只在一个小时内有效！"}),s]})}),(0,I.jsx)(w.Z,{title:(0,I.jsx)("div",{className:" font-semibold text-lg hardline",children:nt}),style:{width:"400px"},children:(0,I.jsxs)(N.A,{formRef:ft,onFinish:bt,onReset:yt,submitter:{searchConfig:{submitText:at},render:function(e,t){return[t[1],(0,I.jsx)(O.ZP,{loading:Ie,onClick:Ft,children:"校对"},"check"),(0,I.jsx)(O.ZP,{onClick:Mt,children:"日志"},"log"),t[0]]}},initialValues:{disorderSend:!0,auto:!0,repeatSend:10,intervalSend:1e3,leadTimeSend:0},children:[(0,I.jsx)(_.Z,{label:"交易文件",name:"transactionInfo",action:"upload.do",fieldProps:{accept:".json",onChange:Nt,beforeUpload:function(){return!1},listType:"picture",onPreview:function(e){return mt.current.handleOpen(e)},fileList:W},rules:[{required:!0,whitespace:!0,message:"".concat(rt),pattern:/.*/}]}),(0,I.jsx)(Z.Z,{label:(0,I.jsxs)("div",{children:["整体重复发送次数",(0,I.jsx)(L.Z,{placement:"topLeft",title:"整体全部发送完成算一次，这里指定重复次数。重复发送失败了，不会影响金额",children:(0,I.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"repeatSend",placeholder:"",min:1,max:20,rules:[{required:!0,message:"".concat(rt),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:10}}),(0,I.jsx)(Z.Z,{label:(0,I.jsxs)("div",{children:["整体重复发送间隔(ms)",(0,I.jsx)(L.Z,{placement:"topLeft",title:"整体全部发送完成算一次，这里指定重复的间隔时间",children:(0,I.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"intervalSend",placeholder:"",min:300,rules:[{required:!0,message:"".concat(rt),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1e3}}),(0,I.jsx)(Z.Z,{label:(0,I.jsxs)("div",{children:["提前发送时间(ms)",(0,I.jsx)(L.Z,{placement:"topLeft",title:"在下一轮开始前多少毫秒发送交易",children:(0,I.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"leadTimeSend",placeholder:"",max:2e3,min:0,rules:[{required:!0,message:"".concat(rt),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:0}}),(0,I.jsx)(C.Z,{name:"disorderSend",label:(0,I.jsxs)("div",{children:["是否乱序",(0,I.jsx)(L.Z,{placement:"topLeft",title:"是否以乱序的方式来发送交易",children:(0,I.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(rt),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0}}),(0,I.jsx)(C.Z,{name:"auto",label:(0,I.jsxs)("div",{children:["是否自动发送",(0,I.jsx)(L.Z,{placement:"topLeft",title:"倒计时结束后，是否自动发送交易。开启与否，不影响手动操作来发",children:(0,I.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(rt),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0}}),(0,I.jsx)(F.Z,{name:"amountSend",label:(0,I.jsxs)("div",{children:["总金额",(0,I.jsx)(L.Z,{placement:"topLeft",title:"此次全部交易所需要的总金额，包含手续费",children:(0,I.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0}}),(0,I.jsx)(N.A.Item,{label:(0,I.jsxs)("div",{className:" font-semibold text-lg ",children:[(0,I.jsx)("span",{className:"hardline",children:"倒计时 "}),Ye.pid?"(".concat(Ye.pid,"-").concat(Ye.project_name," @").concat(Ye.creator,")"):""]}),children:(0,I.jsxs)("div",{className:"flex items-center gap-x-5",children:[(0,I.jsx)(h.Z,{className:"text-2xl",value:_e,onFinish:kt,onChange:St}),(0,I.jsx)("div",{className:"text-xl",children:"".concat(we)})]})}),(0,I.jsxs)(N.A.Item,{label:(0,I.jsxs)("div",{className:" font-semibold text-lg hardline",children:[(0,I.jsx)("span",{children:"结果 "}),be.length?"(".concat(be.length,")"):""]}),children:[(0,I.jsx)("div",{children:"成功：".concat(X,"，失败：").concat(ne,"，处理中：").concat(ie,"，待处理：").concat(de)}),!!be.length&&(0,I.jsx)("div",{className:"flex flex-wrap gap-5 mt-3",children:Object.keys(ut.current).map((function(e,t){return(0,I.jsx)(V.Z,{color:ut.current[e].status,children:"#".concat(e)},t)}))})]}),(0,I.jsxs)(N.A.Item,{label:(0,I.jsx)("div",{className:" font-semibold text-lg hardline",children:(0,I.jsxs)("div",{children:[(0,I.jsx)("span",{children:"校对 "}),be.length?"(".concat(be.length,")"):"",(0,I.jsx)(L.Z,{placement:"topLeft",title:"交易结束后，可点击校对按钮，判断交易结果是否跟链上数据匹配",children:(0,I.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]})}),children:[(0,I.jsx)("div",{children:"拥有：".concat(he)}),!!be.length&&(0,I.jsx)("div",{className:"flex flex-wrap gap-5 mt-3",children:Object.keys(He).map((function(e,t){return(0,I.jsx)(V.Z,{color:He[e],children:"#".concat(e)},t)}))})]})]})}),s,(0,I.jsx)(x.s,{ref:mt})]}):(0,I.jsx)(I.Fragment,{})})}}}]);