"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2716],{91604:function(e,n,t){t.d(n,{Z:function(){return v}});var r=t(1413),a=t(87462),o=t(62435),i={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},s=t(84089),c=function(e,n){return o.createElement(s.Z,(0,a.Z)({},e,{ref:n,icon:i}))};var l=o.forwardRef(c),u=t(28459),d=t(2058),f=t(9105),m=t(90789),p=t(86074),h=o.forwardRef((function(e,n){var t=e.fieldProps,a=e.title,i=void 0===a?"单击或拖动文件到此区域进行上传":a,s=e.icon,c=void 0===s?(0,p.jsx)(l,{}):s,m=e.description,h=void 0===m?"支持单次或批量上传":m,v=e.action,g=e.accept,x=e.onChange,b=e.value,w=e.children,y=e.max,C=e.proFieldProps,j=(0,o.useContext)(u.ZP.ConfigContext),P=(0,o.useContext)(f.A),k=(null==C?void 0:C.mode)||P.mode||"edit",F=j.getPrefixCls("upload"),S=(void 0===y||!b||(null==b?void 0:b.length)<y)&&"read"!==k&&!0!==(null==C?void 0:C.readonly);return(0,p.jsxs)(d.Z.Dragger,(0,r.Z)((0,r.Z)({ref:n,name:"files",action:v,accept:g,fileList:b},t),{},{onChange:function(e){null==x||x(e),null!=t&&t.onChange&&(null==t||t.onChange(e))},style:(0,r.Z)((0,r.Z)({},null==t?void 0:t.style),{},{display:S?void 0:"none"}),children:[(0,p.jsx)("p",{className:"".concat(F,"-drag-icon"),children:c}),(0,p.jsx)("p",{className:"".concat(F,"-text"),children:i}),(0,p.jsx)("p",{className:"".concat(F,"-hint"),children:h}),w?(0,p.jsx)("div",{className:"".concat(F,"-extra"),style:{padding:16},children:w}):null]}))})),v=(0,m.G)(h,{getValueFromEvent:function(e){return e.fileList}})},218:function(e,n,t){t.d(n,{s:function(){return f}});var r=t(5574),a=t.n(r),o=t(37476),i=t(90672),s=t(59530),c=t(45360),l=t(62435),u=t(86074),d=l.forwardRef((function(e,n){var t=c.ZP.useMessage(),r=a()(t,2),d=r[0],f=r[1],m=(0,l.useRef)(),p=(0,l.useState)(!1),h=a()(p,2),v=h[0],g=h[1],x=(0,l.useState)(""),b=a()(x,2),w=b[0],y=b[1],C=(0,l.useState)(""),j=a()(C,2),P=j[0],k=j[1],F=(0,s.useIntl)(),S=F.formatMessage({id:"msig.intlPreviewFail"}),L=F.formatMessage({id:"msig.intlClose"}),Z=(0,l.useCallback)((function(e){var n=new FileReader;n.readAsText(e.originFileObj),n.onload=function(){try{var t,r=JSON.parse(n.result);if(r)null===(t=m.current)||void 0===t||t.setFieldValue("content",JSON.stringify(r,null,2)),y(JSON.stringify(r,null,2)),k(e.name),g(!0);else d.error("".concat(S))}catch(e){d.error("".concat(S))}}}),[]);return(0,l.useImperativeHandle)(n,(function(){return{handleOpen:Z}})),(0,u.jsxs)(o.Y,{formRef:m,title:(0,u.jsx)("div",{className:"mt-3",children:P}),open:v,onOpenChange:function(e){g(e)},layout:"vertical",width:"700px",modalProps:{style:{top:25}},submitter:{searchConfig:{resetText:L},render:function(e,n){return[n[0]]}},children:[(0,u.jsx)(i.Z,{name:"content",fieldProps:{autoSize:{minRows:5},allowClear:!1,autoFocus:!1,onChange:void 0,value:w,size:"large"}}),f]})})),f=(0,l.memo)(d)},19068:function(e,n,t){t.r(n);var r=t(15009),a=t.n(r),o=t(99289),i=t.n(o),s=t(5574),c=t.n(s),l=t(218),u=t(64119),d=t(11774),f=t(38345),m=t(97269),p=t(91604),h=t(52688),v=t(59530),g=t(80507),x=t(45360),b=t(62435),w=t(86074);n.default=function(){var e=x.ZP.useMessage(),n=c()(e,2),t=n[0],r=n[1],o=(0,v.useSelector)((function(e){return e.global.session})),s=(0,v.useSelector)((function(e){return e.global.account})),y=(0,b.useRef)(),C=(0,b.useRef)(),j=(0,b.useState)([]),P=c()(j,2),k=P[0],F=P[1],S=(0,b.useState)([]),L=c()(S,2),Z=L[0],M=L[1],N=(0,v.useIntl)(),R=N.formatMessage({id:"common.intlInputException"}),O=N.formatMessage({id:"msig.intlUploadFail"}),T=N.formatMessage({id:"msig.intlUploadSuccess"}),A=N.formatMessage({id:"common.intlPleaseConnectWallet"}),z=N.formatMessage({id:"common.intlPleaseConnectNetwork"}),V=N.formatMessage({id:"tools.deploy.intlDeploy"}),q=N.formatMessage({id:"tools.deploy.intlDeployContract"}),H=N.formatMessage({id:"common.intlTxSuccess"}),I=N.formatMessage({id:"common.intlTxFail"}),J=N.formatMessage({id:"tools.deploy.intlAddPermisson"}),U=(0,b.useCallback)(function(){var e=i()(a()().mark((function e(n){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("removed"!==n.file.status){e.next=3;break}return F(n.fileList),e.abrupt("return");case 3:(r=new FileReader).readAsText(n.fileList[n.fileList.length-1].originFileObj),r.onload=function(){try{JSON.parse(r.result)?(F(n.fileList),t.success("".concat(T))):t.error("".concat(O))}catch(e){(0,u.Tv)(e,t)}};case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[]),D=(0,b.useCallback)(function(){var e=i()(a()().mark((function e(n){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("removed"!==n.file.status){e.next=3;break}return M(n.fileList),e.abrupt("return");case 3:(r=new FileReader).readAsText(n.fileList[n.fileList.length-1].originFileObj),r.onload=function(){try{"application/wasm"===n.file.type?(M(n.fileList),t.success("".concat(T))):t.error("".concat(O))}catch(e){(0,u.Tv)(e,t)}};case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[]),E=(0,b.useCallback)(function(){var e=i()(a()().mark((function e(n){var r,i,l,d,f,m,p,h,v,x,b,w,y,C;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o&&o.broadcast){e.next=6;break}return t.error("".concat(A)),e.abrupt("return",!1);case 6:if(s){e.next=9;break}return t.error("".concat(z)),e.abrupt("return",!1);case 9:return e.next=11,new Promise((function(e){var n=new FileReader;n.readAsText(k[0].originFileObj),n.onload=function(){return e(n.result)}}));case 11:return r=e.sent,e.next=14,new Promise((function(e){var n=new FileReader;n.readAsArrayBuffer(Z[0].originFileObj),n.onload=function(){return e(n.result)}}));case 14:return i=e.sent,l=g.dL.from(r),d=g.ei.encode({object:l}),f=d.toString(),m=g.Jj.from(i).toString(),(p=[]).push({account:"eosio",name:"setabi",authorization:[o.permissionLevel],data:{account:o.actor,abi:f,memo:""}}),p.push({account:"eosio",name:"setcode",authorization:[o.permissionLevel],data:{account:o.actor,code:m,vmtype:0,vmversion:0}}),n.addPerm&&(h=s.permission("active"),v=h.required_auth.accounts.find((function(e){return e.permission.equals("".concat(o.actor,"@eosio.code"))})),v||(h.addAccount("".concat(o.actor,"@eosio.code")),h.required_auth.keys.sort((function(e,n){var t=e.key.toString(),r=n.key.toString();return t.localeCompare(r)})),x=s.setPermission(h),p.push(x))),e.next=26,(0,u.zI)(o.transact({actions:p}));case 26:b=e.sent,w=c()(b,2),y=w[0],C=w[1],y?t.error(y):C&&C.response?t.success("".concat(H)):t.error("".concat(I)),e.next=36;break;case 33:e.prev=33,e.t0=e.catch(0),(0,u.Tv)(e.t0,t);case 36:case"end":return e.stop()}}),e,null,[[0,33]])})));return function(n){return e.apply(this,arguments)}}(),[k,Z,t,o,s]);return(0,w.jsxs)(d._z,{className:"deploy",ghost:!0,children:[(0,w.jsx)("div",{className:"flex flex-col items-center",children:(0,w.jsx)(f.Z,{title:(0,w.jsx)("div",{className:" text-lg font-semibold",children:q}),style:{maxWidth:"500px"},children:(0,w.jsxs)(m.A,{initialValues:{addPerm:!0},formRef:y,onFinish:function(){var e=i()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E(n));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),onReset:function(){var e;null===(e=y.current)||void 0===e||e.resetFields(),F([]),M([])},submitter:{searchConfig:{submitText:V},render:function(e,n){return[n[1],n[0]]}},children:[(0,w.jsx)(p.Z,{label:(0,w.jsx)("div",{className:" text-lg font-semibold",children:".abi"}),name:"abi",action:"upload.do",fieldProps:{accept:".abi",onChange:U,beforeUpload:function(){return!1},listType:"picture",onPreview:function(e){return C.current.handleOpen(e)},fileList:k,maxCount:1},rules:[{required:!0,whitespace:!0,message:"".concat(R),pattern:/.*/}]}),(0,w.jsx)(p.Z,{label:(0,w.jsx)("div",{className:" text-lg font-semibold",children:".wasm"}),name:"wasm",action:"upload.do",fieldProps:{accept:".wasm",onChange:D,beforeUpload:function(){return!1},listType:"picture",onPreview:function(e){return C.current.handleOpen(e)},fileList:Z,maxCount:1},rules:[{required:!0,whitespace:!0,message:"".concat(R),pattern:/.*/}]}),(0,w.jsx)(h.Z,{rules:[{required:!0}],name:"addPerm",label:J})]})})}),(0,w.jsx)(l.s,{ref:C}),r]})}}}]);