(self.webpackChunk=self.webpackChunk||[]).push([[2674],{98165:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(87462),a=r(62435),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},o=r(84089),c=function(e,t){return a.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:s}))};var i=a.forwardRef(c)},64317:function(e,t,r){"use strict";var n=r(1413),a=r(91),s=r(22270),o=r(62435),c=r(66758),i=r(56499),l=r(86074),u=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],f=function(e,t){var r=e.fieldProps,d=e.children,f=e.params,p=e.proFieldProps,m=e.mode,h=e.valueEnum,x=e.request,v=e.showSearch,g=e.options,b=(0,a.Z)(e,u),j=(0,o.useContext)(c.Z);return(0,l.jsx)(i.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,s.h)(h),request:x,params:f,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({options:g,mode:m,showSearch:v,getPopupContainer:j.getPopupContainer},r),ref:t,proFieldProps:p},b),{},{children:d}))},p=o.forwardRef((function(e,t){var r=e.fieldProps,u=e.children,f=e.params,p=e.proFieldProps,m=e.mode,h=e.valueEnum,x=e.request,v=e.options,g=(0,a.Z)(e,d),b=(0,n.Z)({options:v,mode:m||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},r),j=(0,o.useContext)(c.Z);return(0,l.jsx)(i.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,s.h)(h),request:x,params:f,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({getPopupContainer:j.getPopupContainer},b),ref:t,proFieldProps:p},g),{},{children:u}))})),m=o.forwardRef(f);m.SearchSelect=p,m.displayName="ProFormComponent",t.Z=m},91604:function(e,t,r){"use strict";r.d(t,{Z:function(){return x}});var n=r(1413),a=r(87462),s=r(62435),o={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},c=r(84089),i=function(e,t){return s.createElement(c.Z,(0,a.Z)({},e,{ref:t,icon:o}))};var l=s.forwardRef(i),u=r(28459),d=r(2058),f=r(9105),p=r(90789),m=r(86074),h=s.forwardRef((function(e,t){var r=e.fieldProps,a=e.title,o=void 0===a?"单击或拖动文件到此区域进行上传":a,c=e.icon,i=void 0===c?(0,m.jsx)(l,{}):c,p=e.description,h=void 0===p?"支持单次或批量上传":p,x=e.action,v=e.accept,g=e.onChange,b=e.value,j=e.children,k=e.max,w=e.proFieldProps,y=(0,s.useContext)(u.ZP.ConfigContext),Z=(0,s.useContext)(f.A),S=(null==w?void 0:w.mode)||Z.mode||"edit",N=y.getPrefixCls("upload"),C=(void 0===k||!b||(null==b?void 0:b.length)<k)&&"read"!==S&&!0!==(null==w?void 0:w.readonly);return(0,m.jsxs)(d.Z.Dragger,(0,n.Z)((0,n.Z)({ref:t,name:"files",action:x,accept:v,fileList:b},r),{},{onChange:function(e){null==g||g(e),null!=r&&r.onChange&&(null==r||r.onChange(e))},style:(0,n.Z)((0,n.Z)({},null==r?void 0:r.style),{},{display:C?void 0:"none"}),children:[(0,m.jsx)("p",{className:"".concat(N,"-drag-icon"),children:i}),(0,m.jsx)("p",{className:"".concat(N,"-text"),children:o}),(0,m.jsx)("p",{className:"".concat(N,"-hint"),children:h}),j?(0,m.jsx)("div",{className:"".concat(N,"-extra"),style:{padding:16},children:j}):null]}))})),x=(0,p.G)(h,{getValueFromEvent:function(e){return e.fileList}})},218:function(e,t,r){"use strict";r.d(t,{s:function(){return f}});var n=r(5574),a=r.n(n),s=r(37476),o=r(90672),c=r(59530),i=r(45360),l=r(62435),u=r(86074),d=l.forwardRef((function(e,t){var r=i.ZP.useMessage(),n=a()(r,2),d=n[0],f=n[1],p=(0,l.useRef)(),m=(0,l.useState)(!1),h=a()(m,2),x=h[0],v=h[1],g=(0,l.useState)(""),b=a()(g,2),j=b[0],k=b[1],w=(0,l.useState)(""),y=a()(w,2),Z=y[0],S=y[1],N=(0,c.useIntl)(),C=N.formatMessage({id:"msig.intlPreviewFail"}),F=N.formatMessage({id:"msig.intlClose"}),P=(0,l.useCallback)((function(e){var t=new FileReader;t.readAsText(e.originFileObj),t.onload=function(){try{var r,n=JSON.parse(t.result);if(n)null===(r=p.current)||void 0===r||r.setFieldValue("content",JSON.stringify(n,null,2)),k(JSON.stringify(n,null,2)),S(e.name),v(!0);else d.error("".concat(C))}catch(e){d.error("".concat(C))}}}),[]);return(0,l.useImperativeHandle)(t,(function(){return{handleOpen:P}})),(0,u.jsxs)(s.Y,{formRef:p,title:(0,u.jsx)("div",{className:"mt-3",children:Z}),open:x,onOpenChange:function(e){v(e)},layout:"vertical",width:"700px",modalProps:{style:{top:25}},submitter:{searchConfig:{resetText:F},render:function(e,t){return[t[0]]}},children:[(0,u.jsx)(o.Z,{name:"content",fieldProps:{autoSize:{minRows:5},allowClear:!1,autoFocus:!1,onChange:void 0,value:j,size:"large"}}),f]})})),f=(0,l.memo)(d)},21024:function(e,t,r){"use strict";r.r(t);var n=r(64599),a=r.n(n),s=r(15009),o=r.n(s),c=r(19632),i=r.n(c),l=r(97857),u=r.n(l),d=r(99289),f=r.n(d),p=r(5574),m=r.n(p),h=r(64119),x=r(218),v=r(11774),g=r(38345),b=r(97269),j=r(64317),k=r(31199),w=r(52688),y=r(5966),Z=r(91604),S=r(59530),N=r(80507),C=r(45360),F=r(7134),P=r(83062),_=r(15867),T=r(55054),L=r(66309),M=r(62435),E=r(27484),V=r.n(E),O=r(70178),R=r.n(O),z=r(40956),Y=r(87603),q=r(98165),D=r(25035),I=r(9669),H=r.n(I),A=r(86074);V().extend(R());var $=["dfsnetworkio","dfsnetworkbp","testaccount1","testaccount2","testaccount3"];t.default=function(){var e=(0,S.useDispatch)(),t=C.ZP.useMessage(),r=m()(t,2),n=r[0],s=r[1],c=(0,S.useSelector)((function(e){return e.global.contractKit})),l=(0,S.useSelector)((function(e){return e.global.account})),d=(0,S.useSelector)((function(e){return e.global.session})),p=(0,S.useSelector)((function(e){return e.global.privateKey})),E=(0,S.useSelector)((function(e){return e.ppp.valueEnum})),O=(0,S.useSelector)((function(e){return e.ppp.projects})),R=(0,M.useState)([]),I=m()(R,2),U=I[0],J=I[1],B=(0,M.useState)(0),K=m()(B,2),Q=K[0],W=K[1],G=(0,M.useState)(0),X=m()(G,2),ee=X[0],te=X[1],re=(0,M.useState)(0),ne=m()(re,2),ae=ne[0],se=ne[1],oe=(0,M.useState)(0),ce=m()(oe,2),ie=ce[0],le=ce[1],ue=(0,M.useState)(0),de=m()(ue,2),fe=de[0],pe=de[1],me=(0,M.useState)([]),he=m()(me,2),xe=he[0],ve=he[1],ge=(0,M.useState)(""),be=m()(ge,2),je=be[0],ke=be[1],we=(0,M.useState)(0),ye=m()(we,2),Ze=(ye[0],ye[1]),Se=(0,M.useState)(0),Ne=m()(Se,2),Ce=Ne[0],Fe=Ne[1],Pe=(0,M.useState)(!1),_e=m()(Pe,2),Te=_e[0],Le=_e[1],Me=(0,M.useState)({}),Ee=m()(Me,2),Ve=Ee[0],Oe=Ee[1],Re=(0,M.useState)({}),ze=m()(Re,2),Ye=ze[0],qe=ze[1],De=(0,M.useState)(!1),Ie=m()(De,2),He=Ie[0],Ae=Ie[1],$e=(0,M.useState)(!1),Ue=m()($e,2),Je=Ue[0],Be=Ue[1],Ke=(0,M.useState)(!1),Qe=m()(Ke,2),We=Qe[0],Ge=Qe[1],Xe=(0,S.useIntl)(),et=Xe.formatMessage({id:"coffee.inputException"}),tt=Xe.formatMessage({id:"msig.intlSendTransaction"}),rt=Xe.formatMessage({id:"msig.intlSend"}),nt=Xe.formatMessage({id:"msig.intlUploadFail"}),at=Xe.formatMessage({id:"msig.intlUploadSuccess"}),st=Xe.formatMessage({id:"msig.intlTransactionEmpty"}),ot=Xe.formatMessage({id:"common.intlPleaseConnectWallet"}),ct=Xe.formatMessage({id:"common.intlPleaseConnectNetwork"}),it=(0,M.useRef)({}),lt=(0,M.useRef)(),ut=(0,M.useRef)(),dt=(0,M.useRef)(),ft=(0,M.useCallback)((function(){var e=0,t=0,r=0,n=0;for(var a in it.current)"success"===it.current[a]?t+=1:"error"===it.current[a]?r+=1:"processing"===it.current[a]?n+=1:"default"===it.current[a]&&(e+=1);W(t),te(r),se(n),le(e)}),[]),pt=(0,M.useCallback)(function(){var e=f()(o()().mark((function e(t){var r,a,s,f,x,v,g,b,j,k,w,y,Z,S,C,F,P,_,T,L,M,E,R,z,Y,q,D,I,H,A,U,J,B,K,Q,W,G,X,ee,te,re,ne,ae,se,oe,ce,ie,le,ue,de,fe,pe,me,he,xe,ve,ge;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,d&&d.broadcast){e.next=6;break}return n.error("".concat(ot)),e.abrupt("return");case 6:if(l){e.next=9;break}return n.error("".concat(ct)),e.abrupt("return");case 9:if("owner"===(a=d.permissionLevel.permission.toString())||"active"===a){e.next=13;break}return n.error("permission权限必须是owner或者active"),e.abrupt("return");case 13:return Be(!0),s=t.projectId,f=t.count,x=t.disorder,v=t.split,g=t.start,b=Number(s.split("-")[1]),j=d.actor.toString(),e.next=19,c.load("dfs3protocol");case 19:return k=e.sent,w=k.table("registry"),e.next=23,w.all({scope:"dfs3protocol",from:b,to:b,index_position:"secondary",key_type:"i64"});case 23:if(y=e.sent,Z=O.filter((function(e){return e.id.toNumber()===b})),S=Z[0].creator.toString(),C=Z[0].nft_name.toString(),F=Z[0].project_name,P=Z[0].init_nft_price.value,_=Z[0].init_nft_price.symbol.name,T=Z[0].sec_per_round.toNumber(),L=Z[0].last_round.toString(),L=V().utc(L).local().format("YYYY-MM-DDTHH:mm:ss"),M="","DFS"!==_){e.next=38;break}M="eosio.token",e.next=49;break;case 38:if("USDT"!==_){e.next=42;break}M="usdtusdtusdt",e.next=49;break;case 42:if("ORDI"!==_){e.next=46;break}M="ordiordiordi",e.next=49;break;case 46:return n.error("不支持当前项目"),Be(!1),e.abrupt("return");case 49:if(!(g>y.length)){e.next=53;break}return n.error("开始序号超过当前项目最大值".concat(y.length)),Be(!1),e.abrupt("return");case 53:return y=g>1?y.slice(g-1):y,E={account:"dfsfreecpu11",name:"freecpu",authorization:[{actor:"dfs.service",permission:"cpu"},d.permissionLevel],data:h._9.from({user:j})},R=N.aU.from(E),e.next=58,d.client.v1.chain.get_info();case 58:z=e.sent,Y=z.getTransactionHeader(),q=V()(),D=[],I=0,H="",A=0,x&&y.sort((function(){return Math.random()-.5})),U=0;case 67:if(!(U<y.length)){e.next=112;break}if(J=y[U].owner.toString(),B=y[U].current_price.value,J!==j){e.next=72;break}return e.abrupt("continue",109);case 72:if(!(B>=2*P)){e.next=74;break}return e.abrupt("continue",109);case 74:if(!(I>=f)){e.next=76;break}return e.abrupt("break",112);case 76:if(!(I>=3e3)){e.next=78;break}return e.abrupt("break",112);case 78:return H=V()(q).add(3600-I++,"seconds").utc().format("YYYY-MM-DDTHH:mm:ss"),K=y[U].current_price.toString(),Q=y[U].current_price.value,W=y[U].current_price.symbol,G=N.xR.from(.005*Q,W),X="buy:"+y[U].id.toString(),A+=Q,ee={account:M,name:"transfer",authorization:[d.permissionLevel],data:h.FE.from({from:j,to:"dfs3protocol",quantity:K,memo:X})},te=N.aU.from(ee),re={account:M,name:"transfer",authorization:[d.permissionLevel],data:h.FE.from({from:j,to:"davidaccount",quantity:G,memo:"fee"})},ne=N.aU.from(re),ae=void 0,se=void 0,oe=[],ce=$.includes(j)?[R,te]:[R,te,ne],ae=N.YW.from(u()(u()({},Y),{},{expiration:H,actions:ce})),oe[0]=p.signDigest(ae.signingDigest(d.chain.id.toString())),e.next=97,(0,h.zI)(d.transact({transaction:ae},{broadcast:!1,transactPlugins:[]}));case 97:if(ie=e.sent,le=m()(ie,2),ue=le[0],de=le[1],!ue){e.next=105;break}return n.error(ue),Be(!1),e.abrupt("return",!1);case 105:se=N.uQ.from(u()(u()({},ae),{},{signatures:[].concat(oe,i()(de.signatures))})),fe=y[U].cid.toNumber(),pe=y[U].id.toNumber(),D.push({signedTransaction:se,cid:fe,nftid:pe,amount:Q});case 109:++U,e.next=67;break;case 112:me=1,he=Math.ceil(D.length/v),xe=V()().format("YYYY-MM-DDTHH:mm:ss"),ve=o()().mark((function e(){var t,r,n,a,s,c,i,l,u;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0,r=[],n=[],(a=D.splice(0,he)).forEach((function(e){r.push(e.cid),n.push(e.nftid),t+=e.amount})),s=$.includes(j)?t.toFixed(8)+" "+_:(1.005*t).toFixed(8)+" "+_,r.sort(),n.sort(),c={infos:{pid:b,creator:S,project_name:F,nft_name:C,token_symbol:_,last_round:L,sec_per_round:T,from:j,split:v,disorder:x,start:r[0],end:r[r.length-1],count:a.length,amount:s,cid_array:r,nftid_array:n},transactions:a},i=JSON.stringify(c,null,2),l="data:,".concat(i),(u=document.createElement("a")).href=l,u.download="".concat(j,"_").concat(b,"_").concat(I,"-").concat(me++,"_").concat(C,"_").concat(S,"_").concat(xe,".json"),u.click();case 15:case"end":return e.stop()}}),e)}));case 116:if(!D.length){e.next=120;break}return e.delegateYield(ve(),"t0",118);case 118:e.next=116;break;case 120:return ge=$.includes(j)?A.toFixed(8)+" "+_:(1.005*A).toFixed(8)+" "+_,null===(r=lt.current)||void 0===r||r.setFieldValue("amount",ge),n.success("创建完成"),Be(!1),e.abrupt("return",!0);case 127:e.prev=127,e.t1=e.catch(0),Be(!1),(0,h.Tv)(e.t1,n);case 131:return e.abrupt("return",!0);case 132:case"end":return e.stop()}}),e,null,[[0,127]])})));return function(t){return e.apply(this,arguments)}}(),[c,d,l,O]),mt=(0,M.useCallback)(function(){var e=f()(o()().mark((function e(t){var r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],t.forEach((function(e){if("success"!==it.current[e.cid]){var t=new Promise((function(t,r){it.current[e.cid]="processing",ft(),d.client.v1.chain.push_transaction(e.signedTransaction).then((function(r){r&&r.processed&&"executed"===r.processed.receipt.status?(it.current[e.cid]="success",ft(),t(!0)):("success"!==it.current[e.cid]&&(it.current[e.cid]="error",ft()),t(!1))})).catch((function(r){"success"!==it.current[e.cid]&&(it.current[e.cid]="error",ft()),t(!1)}))}));r.push(t)}}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[d,ft]),ht=(0,M.useCallback)(function(){var e=f()(o()().mark((function e(t){var r,a,s,c;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==xe.length){e.next=3;break}return n.error(st),e.abrupt("return",!1);case 3:for(r=t.disorder,a=t.repeat,s=t.interval,e.prev=4,r?xe.sort((function(){return Math.random()-.5})):xe.sort((function(e,t){return e.cid-t.cid})),mt(xe),c=1;c<a;c++)setTimeout(mt,s*c,xe);return e.abrupt("return",!0);case 11:e.prev=11,e.t0=e.catch(4),(0,h.Tv)(e.t0,n);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}(),[xe,mt]),xt=(0,M.useCallback)((function(e,t){var r=V()(e).add(t,"seconds").valueOf();Fe(r)}),[]),vt=(0,M.useCallback)((function(){var e,t;null!==(e=ut.current)&&void 0!==e&&e.getFieldValue("auto")&&(null===(t=ut.current)||void 0===t||t.submit())}),[]),gt=(0,M.useCallback)(function(){var e=f()(o()().mark((function e(t){var r,s,c,i,l,u,d,f,p,m,x,v,g,b,j,k,w;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=12;break}return it.current={},te(0),W(0),se(0),le(0),ve([]),ke(""),Fe(0),Ze(0),null===(r=ut.current)||void 0===r||r.setFieldValue("amount",""),e.abrupt("return");case 12:e.prev=12,c=[],i=new Set,l=[],u={},d={},f=[],p=0,m={infos:{},transactions:[]},x=a()(t),e.prev=22,g=o()().mark((function e(){var t,r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.value,e.next=3,new Promise((function(e){var r=new FileReader;r.readAsText(t.originFileObj),r.onload=function(){return e(r.result)}}));case 3:r=e.sent,(m=JSON.parse(r)).transactions.forEach((function(e){i.has(e.cid)||(l.push(e),i.add(e.cid))}));case 6:case"end":return e.stop()}}),e)})),x.s();case 25:if((v=x.n()).done){e.next=29;break}return e.delegateYield(g(),"t0",27);case 27:e.next=25;break;case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(22),x.e(e.t1);case 34:return e.prev=34,x.f(),e.finish(34);case 37:b=m.infos.last_round,j=m.infos.sec_per_round,k=V()(b).add(j,"seconds").format("YYYY-MM-DDTHH:mm:ss"),xt(b,j),w=m.infos.token_symbol,l.forEach((function(e){var t=N.uQ.from(e.signedTransaction);c.push({cid:e.cid,nftid:e.nftid,amount:e.amount,signedTransaction:t}),u[e.cid]="default",f.push(e.cid),p+=e.amount})),null===(s=ut.current)||void 0===s||s.setFieldValue("amount",p.toFixed(8)+" "+w),f.sort(),f.forEach((function(e){d[e]=u[e]})),it.current=d,te(0),W(0),se(0),le(c.length),ve(c),ke(k),Ze(j),Oe(m.infos),e.next=60;break;case 57:e.prev=57,e.t2=e.catch(12),(0,h.Tv)(e.t2,n);case 60:case"end":return e.stop()}}),e,null,[[12,57],[22,31,34,37]])})));return function(t){return e.apply(this,arguments)}}(),[xt]),bt=(0,M.useCallback)(function(){var e=f()(o()().mark((function e(t){var r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("removed"!==t.file.status){e.next=4;break}return J(t.fileList),gt(t.fileList),e.abrupt("return");case 4:(r=new FileReader).readAsText(t.fileList[t.fileList.length-1].originFileObj),r.onload=function(){try{JSON.parse(r.result)?(J(t.fileList),gt(t.fileList),n.success("".concat(at))):n.error("".concat(nt))}catch(e){(0,h.Tv)(e,n)}};case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[gt]),jt=(0,M.useCallback)((function(){var e;null===(e=ut.current)||void 0===e||e.resetFields(),J([]),ve([]),ke(""),Fe(0),Ze(0),it.current={},ft()}),[]),kt=(0,M.useCallback)(function(){var t=f()(o()().mark((function t(r){var a,s,c,i,l,u,d,f;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.load("dfs3protocol");case 3:return s=t.sent,c=s.table("projects"),t.next=7,c.all({scope:"dfs3protocol"});case 7:return i=t.sent,t.next=10,H().get("https://api.dfs.land/dfschain/pppvolume2");case 10:200!==(l=t.sent).status&&n.error("获取pppvolume2数据失败"),u=l.data,d=[],i.forEach((function(e){u.hasOwnProperty(e.id.toString())&&d.push(e)})),d.sort((function(e,t){var r=e.id.toString(),n=t.id.toString();return u[n].volume_24h-u[r].volume_24h})),f={},d.forEach((function(e){var t=e.nft_img,r=e.id.toString(),n=e.project_name,a=e.creator.toString();f["pid-"+r]="".concat(r,"-").concat(n,"-").concat(a,"-").concat(t)})),null===(a=lt.current)||void 0===a||a.setFieldValue("pid",""),e(z.N.setValueEnum(f)),e(z.N.setProjects(i)),Ge(!1),t.next=28;break;case 24:t.prev=24,t.t0=t.catch(0),Ge(!1),(0,h.Tv)(t.t0,n);case 28:case"end":return t.stop()}}),t,null,[[0,24]])})));return function(e){return t.apply(this,arguments)}}(),[]),wt=(0,M.useCallback)((function(){return d&&d.broadcast?l?(Ge(!0),void kt(c)):(n.error("".concat(ct)),!1):(n.error("".concat(ot)),!1)}),[d,l,kt,c]),yt=(0,M.useCallback)(f()(o()().mark((function e(){var t,r,a,s,i,u;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,d&&d.broadcast){e.next=6;break}return n.error("".concat(ot)),e.abrupt("return");case 6:if(l){e.next=9;break}return n.error("".concat(ct)),e.abrupt("return");case 9:return Ae(!0),t={},r=d.actor.toString(),e.next=14,c.load("dfs3protocol");case 14:return a=e.sent,s=a.table("registry"),e.next=18,s.all({scope:"dfs3protocol",from:Ve.pid,to:Ve.pid,index_position:"secondary",key_type:"i64"});case 18:i=e.sent,u=0,Object.keys(it.current).forEach((function(e){i.filter((function(t){return t.cid.toString()===e}))[0].owner.toString()===r?(t[e]="success",u+=1):t[e]="default"})),pe(u),qe(t),Ae(!1),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(0),Ae(!1),(0,h.Tv)(e.t0,n);case 30:case"end":return e.stop()}}),e,null,[[0,26]])}))),[c,d,n,Ve,l]),Zt=(0,M.useCallback)((function(){var e=["dfsnetworkio","dfsnetworkbp","testaccount1","testaccount2","testaccount3","jiudaojiudao","manjianetvip","manjianetmkt"];if(Te){if(l){var t=l.accountName.toString();return!!e.includes(t)||(Le(!1),!1)}return!0}if(l){var r=l.accountName.toString();return!!e.includes(r)&&(Le(!0),!0)}return!1}),[l,Te]);return(0,M.useEffect)((function(){!c||Object.keys(E).length||We||(Ge(!0),kt(c))}),[kt,E,c,We]),(0,A.jsx)(v._z,{className:"",ghost:!0,children:Zt()?(0,A.jsxs)("div",{className:"flex flex-wrap justify-around gap-5 items-start",children:[(0,A.jsxs)(g.Z,{className:"my-3 px-2",children:[(0,A.jsx)("div",{className:"mb-2 font-semibold",children:"使用说明："}),(0,A.jsx)("div",{children:"1. 操作步骤如下："}),(0,A.jsxs)("div",{className:"ml-3",children:["连接钱包 ",(0,A.jsx)(Y.Z,{})," 创建交易 ",(0,A.jsx)(Y.Z,{}),"发送交易"]}),(0,A.jsxs)("div",{className:"ml-3",children:["创建交易： 选择项目 ",(0,A.jsx)(Y.Z,{})," 输入购买数量 ",(0,A.jsx)(Y.Z,{})," 点击创建按钮 ",(0,A.jsx)(Y.Z,{})," 保存交易文件"]}),(0,A.jsxs)("div",{className:"ml-3",children:["发送交易：上传交易文件 ",(0,A.jsx)(Y.Z,{})," 等待倒计时结束"]}),(0,A.jsx)("div",{children:"2. 注意事项："}),(0,A.jsx)("div",{className:"ml-3",children:"a）交易文件的有效时间是一个小时，所以要在购买前一个小时内提前生成；"}),(0,A.jsx)("div",{className:"ml-3",children:"b）交易文件生成过程中，需要用户重复进行多次签名，虽然繁琐，但安全，无需用户导入私钥。但如果觉得繁琐或者想全自动化定时运行，需要用户将私钥导入到工具上才可以；"}),(0,A.jsx)("div",{children:"3. 费用说明："}),(0,A.jsx)("div",{className:"ml-3",children:"每个NFT收取0.5%费用。例如工具抢到一个价值为100 DFS的NFT，则工具会收取0.5 DFS，抢购成功了，才会收取。"})]}),(0,A.jsx)(g.Z,{title:(0,A.jsx)("div",{className:" font-semibold text-lg hardline",children:"创建交易"}),style:{width:"450px"},children:(0,A.jsxs)(b.A,{formRef:lt,onFinish:pt,layout:"vertical",loading:Je,initialValues:{disorder:!0,split:1,start:1},submitter:{searchConfig:{submitText:"创建"},render:function(e,t){return[t[1],t[0]]}},children:[(0,A.jsx)(j.Z,{name:"projectId",label:(0,A.jsxs)("div",{children:["项目",(0,A.jsx)(q.Z,{spin:We,className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"},onClick:wt})]}),valueEnum:E,placeholder:"",rules:[{required:!0,whitespace:!0,message:"".concat(et),pattern:/^.+$/}],fieldProps:{size:"large",autoFocus:!1,showSearch:!0,filterOption:function(e,t){var r=t.label.split("-"),n=m()(r,3),a=n[0],s=n[1],o=n[2];return(a.padStart(3,"0")+s+o).toLowerCase().includes(e.toLowerCase())},optionItemRender:function(e){var t=e.label.split("-"),r=m()(t,4),n=r[0],a=r[1],s=r[2],o=r[3];return(0,A.jsxs)("div",{className:"flex items-center",children:[(0,A.jsx)("div",{className:"mr-2",children:n.padStart(3,"0")}),(0,A.jsx)(F.C,{className:"mr-2",size:"default",src:o}),(0,A.jsxs)("div",{children:[a," @",s]})]})}}}),(0,A.jsx)(k.Z,{label:"购买数量",name:"count",placeholder:"",min:1,rules:[{required:!0,message:"".concat(et),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large"}}),(0,A.jsx)(k.Z,{label:(0,A.jsxs)("div",{children:["开始序号#",(0,A.jsx)(P.Z,{placement:"topLeft",title:"从具体某个序号开始进行购买",children:(0,A.jsx)(D.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"start",placeholder:"",min:1,rules:[{required:!0,message:"".concat(et),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1}}),(0,A.jsx)(k.Z,{label:(0,A.jsxs)("div",{children:["拆分文件数量",(0,A.jsx)(P.Z,{placement:"topLeft",title:"将所有交易信息拆分成多个文件来保存",children:(0,A.jsx)(D.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"split",placeholder:"",min:1,rules:[{required:!0,message:"".concat(et),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1}}),(0,A.jsx)(w.Z,{name:"disorder",label:(0,A.jsxs)("div",{children:["是否乱序",(0,A.jsx)(P.Z,{placement:"topLeft",title:"是否以乱序的方式来进行购买",children:(0,A.jsx)(D.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(et),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0}}),(0,A.jsx)(y.Z,{name:"amount",label:(0,A.jsxs)("div",{children:["总金额",(0,A.jsx)(P.Z,{placement:"topLeft",title:"此次全部交易所需要的总金额，包含手续费",children:(0,A.jsx)(D.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0}}),(0,A.jsx)("div",{className:" text-red-600 text-lg mb-3",children:"注意：交易文件只在一个小时内有效！"}),s]})}),(0,A.jsx)(g.Z,{title:(0,A.jsx)("div",{className:" font-semibold text-lg hardline",children:tt}),style:{width:"450px"},children:(0,A.jsxs)(b.A,{formRef:ut,onFinish:ht,onReset:jt,submitter:{searchConfig:{submitText:rt},render:function(e,t){return[t[1],(0,A.jsx)(_.ZP,{loading:He,onClick:yt,children:"校对"},"check"),t[0]]}},initialValues:{disorder:!0,auto:!0,repeat:3,interval:1e3},children:[(0,A.jsx)(Z.Z,{label:"交易文件",name:"transactionInfo",action:"upload.do",fieldProps:{accept:".json",onChange:bt,beforeUpload:function(){return!1},listType:"picture",onPreview:function(e){return dt.current.handleOpen(e)},fileList:U},rules:[{required:!0,whitespace:!0,message:"".concat(et),pattern:/.*/}]}),(0,A.jsx)(k.Z,{label:(0,A.jsxs)("div",{children:["整体重复发送次数",(0,A.jsx)(P.Z,{placement:"topLeft",title:"整体全部发送完成算一次，这里指定重复次数。重复发送失败了，不会影响金额",children:(0,A.jsx)(D.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"repeat",placeholder:"",min:1,max:5,rules:[{required:!0,message:"".concat(et),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:3}}),(0,A.jsx)(k.Z,{label:(0,A.jsxs)("div",{children:["整体重复发送间隔(ms)",(0,A.jsx)(P.Z,{placement:"topLeft",title:"整体全部发送完成算一次，这里指定重复的间隔时间",children:(0,A.jsx)(D.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"interval",placeholder:"",min:300,rules:[{required:!0,message:"".concat(et),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1e3}}),(0,A.jsx)(w.Z,{name:"disorder",label:(0,A.jsxs)("div",{children:["是否乱序",(0,A.jsx)(P.Z,{placement:"topLeft",title:"是否以乱序的方式来发送交易",children:(0,A.jsx)(D.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(et),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0}}),(0,A.jsx)(w.Z,{name:"auto",label:(0,A.jsxs)("div",{children:["是否自动发送",(0,A.jsx)(P.Z,{placement:"topLeft",title:"倒计时结束后，是否自动发送交易。开启与否，不影响手动操作来发",children:(0,A.jsx)(D.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(et),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0}}),(0,A.jsx)(y.Z,{name:"amount",label:(0,A.jsxs)("div",{children:["总金额",(0,A.jsx)(P.Z,{placement:"topLeft",title:"此次全部交易所需要的总金额，包含手续费",children:(0,A.jsx)(D.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0}}),(0,A.jsx)(b.A.Item,{label:(0,A.jsx)("span",{className:" font-medium",children:"倒计时"}),children:(0,A.jsxs)("div",{className:"flex items-center gap-x-5",children:[(0,A.jsx)(T.Z.Countdown,{value:Ce,onFinish:vt}),(0,A.jsx)("div",{className:"text-xl",children:"".concat(je)})]})}),(0,A.jsxs)(b.A.Item,{label:(0,A.jsx)("div",{className:" font-semibold text-lg hardline",children:"结果(".concat(xe.length,")")}),children:[(0,A.jsx)("div",{children:"成功：".concat(Q,"，失败：").concat(ee,"，处理中：").concat(ae,"，待处理：").concat(ie)}),!!xe.length&&(0,A.jsx)("div",{className:"flex flex-wrap gap-5 mt-3",children:Object.keys(it.current).map((function(e,t){return(0,A.jsx)(L.Z,{color:it.current[e],children:"#".concat(e)},t)}))})]}),(0,A.jsxs)(b.A.Item,{label:(0,A.jsx)("div",{className:" font-semibold text-lg hardline",children:(0,A.jsxs)("div",{children:["校对(".concat(xe.length,")"),(0,A.jsx)(P.Z,{placement:"topLeft",title:"交易结束后，可点击校对按钮，判断交易结果是否跟链上数据匹配",children:(0,A.jsx)(D.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]})}),children:[(0,A.jsx)("div",{children:"拥有：".concat(fe)}),!!xe.length&&(0,A.jsx)("div",{className:"flex flex-wrap gap-5 mt-3",children:Object.keys(Ye).map((function(e,t){return(0,A.jsx)(L.Z,{color:Ye[e],children:"#".concat(e)},t)}))})]})]})}),(0,A.jsx)(x.s,{ref:dt})]}):(0,A.jsx)(A.Fragment,{})})}},64599:function(e,t,r){var n=r(96263);e.exports=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0,s=function(){};return{s:s,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){i=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(i)throw o}}}},e.exports.__esModule=!0,e.exports.default=e.exports}}]);