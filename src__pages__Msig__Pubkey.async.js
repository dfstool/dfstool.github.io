(self.webpackChunk=self.webpackChunk||[]).push([[519],{90672:function(e,n,t){"use strict";var r=t(1413),a=t(91),s=t(62435),i=t(56499),o=t(86074),c=["fieldProps","proFieldProps"],u=function(e,n){var t=e.fieldProps,s=e.proFieldProps,u=(0,a.Z)(e,c);return(0,o.jsx)(i.Z,(0,r.Z)({ref:n,valueType:"textarea",fieldProps:t,proFieldProps:s},u))};n.Z=s.forwardRef(u)},61575:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return U}});var r=t(15009),a=t.n(r),s=t(97857),i=t.n(s),o=t(19632),c=t.n(o),u=t(64599),l=t.n(u),f=t(99289),d=t.n(f),p=t(5574),m=t.n(p),g=t(37476),x=t(90672),h=t(59530),v=t(45360),b=t(62435),S=t(86074),k=b.forwardRef((function(e,n){var t=v.ZP.useMessage(),r=m()(t,2),a=r[0],s=r[1],i=(0,b.useRef)(),o=(0,b.useState)(!1),c=m()(o,2),u=c[0],l=c[1],f=(0,b.useState)(""),d=m()(f,2),p=d[0],k=d[1],w=(0,b.useState)(""),y=m()(w,2),j=y[0],C=y[1],M=(0,h.useIntl)(),P=M.formatMessage({id:"msig.intlPreviewFail"}),F=M.formatMessage({id:"msig.intlClose"}),N=(0,b.useCallback)((function(e){var n=new FileReader;n.readAsText(e.originFileObj),n.onload=function(){try{var t,r=JSON.parse(n.result);if(r)null===(t=i.current)||void 0===t||t.setFieldValue("content",JSON.stringify(r,null,2)),k(JSON.stringify(r,null,2)),C(e.name),l(!0);else a.error("".concat(P))}catch(e){a.error("".concat(P))}}}),[]);return(0,b.useImperativeHandle)(n,(function(){return{handleOpen:N}})),(0,S.jsxs)(g.Y,{formRef:i,title:(0,S.jsx)("div",{className:"mt-3",children:j}),open:u,onOpenChange:function(e){l(e)},layout:"vertical",width:"700px",modalProps:{style:{top:25}},submitter:{searchConfig:{resetText:F},render:function(e,n){return[n[0]]}},children:[(0,S.jsx)(x.Z,{name:"content",fieldProps:{autoSize:{minRows:5},allowClear:!1,autoFocus:!1,onChange:void 0,value:p}}),s]})})),w=(0,b.memo)(k),y=t(64119),j=t(11774),C=t(38345),M=t(97269),P=t(1413),F=t(87462),N={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},T=t(84089),Z=function(e,n){return b.createElement(T.Z,(0,F.Z)({},e,{ref:n,icon:N}))};var O=b.forwardRef(Z),R=t(28459),I=t(2058),J=t(9105),A=t(90789),L=b.forwardRef((function(e,n){var t=e.fieldProps,r=e.title,a=void 0===r?"单击或拖动文件到此区域进行上传":r,s=e.icon,i=void 0===s?(0,S.jsx)(O,{}):s,o=e.description,c=void 0===o?"支持单次或批量上传":o,u=e.action,l=e.accept,f=e.onChange,d=e.value,p=e.children,m=e.max,g=e.proFieldProps,x=(0,b.useContext)(R.ZP.ConfigContext),h=(0,b.useContext)(J.A),v=(null==g?void 0:g.mode)||h.mode||"edit",k=x.getPrefixCls("upload"),w=(void 0===m||!d||(null==d?void 0:d.length)<m)&&"read"!==v&&!0!==(null==g?void 0:g.readonly);return(0,S.jsxs)(I.Z.Dragger,(0,P.Z)((0,P.Z)({ref:n,name:"files",action:u,accept:l,fileList:d},t),{},{onChange:function(e){null==f||f(e),null!=t&&t.onChange&&(null==t||t.onChange(e))},style:(0,P.Z)((0,P.Z)({},null==t?void 0:t.style),{},{display:w?void 0:"none"}),children:[(0,S.jsx)("p",{className:"".concat(k,"-drag-icon"),children:i}),(0,S.jsx)("p",{className:"".concat(k,"-text"),children:a}),(0,S.jsx)("p",{className:"".concat(k,"-hint"),children:c}),p?(0,S.jsx)("div",{className:"".concat(k,"-extra"),style:{padding:16},children:p}):null]}))})),_=(0,A.G)(L,{getValueFromEvent:function(e){return e.fileList}}),z=t(80507),E=t(15867),V=t(27484),Y=t.n(V),H=t(70178),D=t.n(H);Y().extend(D());var U=function(){var e=v.ZP.useMessage(),n=m()(e,2),t=n[0],r=n[1],s=(0,h.useSelector)((function(e){return e.global.session})),o=(0,h.useSelector)((function(e){return e.global.account})),u=(0,b.useRef)(),f=(0,b.useRef)(),p=(0,b.useRef)(),g=(0,b.useState)(""),k=m()(g,2),P=k[0],F=k[1],N=(0,b.useState)(""),T=m()(N,2),Z=T[0],O=T[1],R=(0,b.useState)(""),J=m()(R,2),A=J[0],L=J[1],V=(0,b.useState)(1),H=m()(V,2),D=H[0],U=H[1],Q=(0,b.useState)([]),W=m()(Q,2),q=W[0],G=W[1],B=(0,h.useIntl)(),K=B.formatMessage({id:"verify.intlSignSuccess"}),X=B.formatMessage({id:"verify.intlSignFail"}),$=B.formatMessage({id:"common.intlCopySuccess"}),ee=B.formatMessage({id:"common.intlInputException"}),ne=B.formatMessage({id:"msig.intlImportFail"}),te=B.formatMessage({id:"msig.intlImportSuccess"}),re=B.formatMessage({id:"msig.intlUploadFail"}),ae=B.formatMessage({id:"msig.intlUploadSuccess"}),se=B.formatMessage({id:"common.intlPleaseConnectWallet"}),ie=B.formatMessage({id:"common.intlPleaseConnectNetwork"}),oe=B.formatMessage({id:"msig.intlSignedTransaction"}),ce=B.formatMessage({id:"msig.intlSign"}),ue=B.formatMessage({id:"msig.intlImportTransaction"}),le=B.formatMessage({id:"msig.intlExportSignedTransaction"}),fe=B.formatMessage({id:"msig.intlCopySignedTransaction"}),de=B.formatMessage({id:"msig.intlTransactionInfo"}),pe=B.formatMessage({id:"msig.intlSendTransaction"}),me=B.formatMessage({id:"msig.intlSend"}),ge=B.formatMessage({id:"msig.intlSignAndSend"}),xe=B.formatMessage({id:"msig.intlNoNeedInput"}),he=B.formatMessage({id:"msig.intlTransactionEmpty"}),ve=B.formatMessage({id:"msig.intlTransactionDifferent"}),be=B.formatMessage({id:"common.intlTxSuccess"}),Se=(0,b.useCallback)(function(){var e=d()(a()().mark((function e(n){var r,f,d,p,g,x,h,v,b,S,k,w,j,C,M,P,N,T,Z,R,I,J,A,_,E,V,H,D;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s&&s.broadcast){e.next=5;break}return t.error("".concat(se)),e.abrupt("return",!1);case 5:if(o){e.next=8;break}return t.error("".concat(ie)),e.abrupt("return",!1);case 8:r=JSON.parse(n.transactionInfo),f=z.uQ.from(r),d=z.YW.from(r),p=[],g=new Set,d.actions.forEach((function(e){g.add(e.account.toString())})),x=l()(g),e.prev=15,x.s();case 17:if((h=x.n()).done){e.next=33;break}return v=h.value,e.next=21,(0,y.zI)(s.client.v1.chain.get_abi(v));case 21:if(b=e.sent,S=m()(b,2),k=S[0],w=S[1],!k){e.next=30;break}return t.error(k),e.abrupt("return",!1);case 30:p.push({abi:z.dL.from(w.abi),account:z.VG.from(v)});case 31:e.next=17;break;case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(15),x.e(e.t0);case 38:return e.prev=38,x.f(),e.finish(38);case 41:return e.next=43,(0,y.zI)(s.transact({transaction:d},{broadcast:!1,transactPlugins:[],abis:p}));case 43:if(j=e.sent,C=m()(j,2),M=C[0],P=C[1],!M){e.next=52;break}return t.error(M),e.abrupt("return",!1);case 52:if(!P){e.next=84;break}T=P.resolved.transaction,Z=P.signatures[0],R=Array.from(new Set([].concat(c()(f.signatures.map(String)),[Z]))),I=z.uQ.from(i()(i()({},T),{},{signatures:R})),J=z.Pc.from(Z),A=J.recoverDigest(P.resolved.signingDigest).toString(),_=o.data.permissions,E=0;case 61:if(!(E<_.length)){e.next=77;break}if(_[E].perm_name.toString()!==s.permission.toString()){e.next=74;break}V=_[E].required_auth.keys,H=0;case 65:if(!(H<V.length)){e.next=73;break}if(V[H].key.toString()!==A){e.next=70;break}return O(A),U(V[H].weight.value),e.abrupt("break",73);case 70:H++,e.next=65;break;case 73:return e.abrupt("break",77);case 74:E++,e.next=61;break;case 77:D=Y()(T.expiration.toString()).utc().format("YYYY-MM-DDTHH:mm:ss"),L(D),null===(N=u.current)||void 0===N||N.setFieldValue("signedTransaction",JSON.stringify(I,null,2)),F(JSON.stringify(I,null,2)),t.success("".concat(K)),e.next=85;break;case 84:t.error("".concat(X));case 85:return e.abrupt("return",!0);case 86:case"end":return e.stop()}}),e,null,[[15,35,38,41]])})));return function(n){return e.apply(this,arguments)}}(),[s,o]),ke=(0,b.useCallback)(d()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.navigator.clipboard.writeText(P);case 2:t.success("".concat($));case 3:case"end":return e.stop()}}),e)}))),[P]),we=(0,b.useCallback)(function(){var e=d()(a()().mark((function e(n){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=new FileReader).readAsText(n.fileList[0].originFileObj),r.onload=function(){try{var e,n=JSON.parse(r.result);if(n)null===(e=u.current)||void 0===e||e.setFieldValue("transactionInfo",JSON.stringify(n,null,2)),t.success("".concat(te));else t.error("".concat(ne))}catch(e){t.error("".concat(ne))}};case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[]),ye=(0,b.useCallback)(function(){var e=d()(a()().mark((function e(n){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("removed"!==n.file.status){e.next=3;break}return G(n.fileList),e.abrupt("return");case 3:(r=new FileReader).readAsText(n.fileList[n.fileList.length-1].originFileObj),r.onload=function(){try{JSON.parse(r.result)?(G(n.fileList),t.success("".concat(ae))):t.error("".concat(re))}catch(e){t.error("".concat(re))}};case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[]),je=(0,b.useCallback)((function(){var e=s.actor.toString(),n=s.permission.toString(),t="data:,".concat(P),r=document.createElement("a");r.href=t,r.download="".concat(e,"@").concat(n,"#").concat(Z,"_weight@").concat(D,"_expiration@").concat(A,"_signed.json"),r.click()}),[P,s,Z,A,D]),Ce=(0,b.useCallback)(d()(a()().mark((function e(){var n,r,o,c,u,f,d,p,m;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==q.length){e.next=3;break}return t.error(he),e.abrupt("return",!1);case 3:e.prev=3,n=new Set,r="",o=l()(q),e.prev=7,u=a()().mark((function e(){var s,i,o;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=c.value,e.next=3,new Promise((function(e){var n=new FileReader;n.readAsText(s.originFileObj),n.onload=function(){return e(n.result)}}));case 3:if(i=e.sent,(o=JSON.parse(i)).signatures.forEach((function(e){n.add(e)})),r){e.next=11;break}o.signatures=[],r=JSON.stringify(o),e.next=15;break;case 11:if(o.signatures=[],r===JSON.stringify(o)){e.next=15;break}return t.error(ve),e.abrupt("return",{v:!1});case 15:case"end":return e.stop()}}),e)})),o.s();case 10:if((c=o.n()).done){e.next=17;break}return e.delegateYield(u(),"t0",12);case 12:if(!(f=e.t0)){e.next=15;break}return e.abrupt("return",f.v);case 15:e.next=10;break;case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(7),o.e(e.t1);case 22:return e.prev=22,o.f(),e.finish(22);case 25:return d=z.YW.from(JSON.parse(r)),p=z.uQ.from(i()(i()({},d),{},{signatures:Array.from(n)})),e.next=29,s.client.v1.chain.push_transaction(p);case 29:(m=e.sent)&&m.processed&&"executed"===m.processed.receipt.status&&t.success(be),e.next=36;break;case 33:e.prev=33,e.t2=e.catch(3),(0,y.Tv)(e.t2,t);case 36:case"end":return e.stop()}}),e,null,[[3,33],[7,19,22,25]])}))),[q,t,s]);return(0,S.jsxs)(j._z,{className:"msig",ghost:!0,children:[(0,S.jsxs)("div",{className:"flex justify-evenly flex-wrap items-start",children:[(0,S.jsx)(C.Z,{className:" mb-4",title:(0,S.jsx)("span",{className:" font-semibold text-lg hardline",children:oe}),children:(0,S.jsxs)(M.A,{formRef:u,onFinish:function(){var e=d()(a()().mark((function e(n){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Se(n));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),onReset:function(){var e;null===(e=u.current)||void 0===e||e.resetFields(),F("")},submitter:{searchConfig:{submitText:ce},render:function(e,n){return[(0,S.jsx)(I.Z,{accept:".json",maxCount:1,showUploadList:!1,onChange:we,beforeUpload:function(){return!1},children:(0,S.jsx)(E.ZP,{type:"primary",children:ue})},"upload"),n[1],(0,S.jsx)(E.ZP,{type:"primary",onClick:je,children:le},"export"),(0,S.jsx)(E.ZP,{onClick:ke,children:fe},"copy"),n[0]]}},children:[(0,S.jsx)(x.Z,{name:"transactionInfo",label:de,fieldProps:{autoSize:{minRows:7},autoFocus:!1},rules:[{required:!0,whitespace:!0,message:"".concat(ee)}]}),(0,S.jsx)(x.Z,{name:"signedTransaction",label:oe,placeholder:xe,fieldProps:{autoSize:{minRows:7},autoFocus:!1,onChange:void 0,value:P}})]})}),(0,S.jsx)(C.Z,{title:(0,S.jsx)("span",{className:" font-semibold text-lg hardline mb-4",children:pe}),children:(0,S.jsx)(M.A,{formRef:f,onFinish:d()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ce());case 1:case"end":return e.stop()}}),e)}))),onReset:function(){var e;null===(e=f.current)||void 0===e||e.resetFields(),G([])},submitter:{searchConfig:{submitText:me},render:function(e,n){return[n[1],(0,S.jsx)(E.ZP,{children:ge},"send"),n[0]]}},children:(0,S.jsx)(_,{label:de,name:"transactionInfo",action:"upload.do",fieldProps:{accept:".json",onChange:ye,beforeUpload:function(){return!1},listType:"picture",onPreview:function(e){return p.current.handleOpen(e)},fileList:q}})})}),(0,S.jsx)(w,{ref:p})]}),r]})}},64599:function(e,n,t){var r=t(96263);e.exports=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=r(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,s=function(){};return{s:s,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==t.return||t.return()}finally{if(c)throw i}}}},e.exports.__esModule=!0,e.exports.default=e.exports}}]);