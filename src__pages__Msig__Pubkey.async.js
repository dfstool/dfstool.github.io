(self.webpackChunk=self.webpackChunk||[]).push([[519],{90672:function(e,r,n){"use strict";var t=n(1413),a=n(91),s=n(62435),i=n(56499),o=n(86074),c=["fieldProps","proFieldProps"],u=function(e,r){var n=e.fieldProps,s=e.proFieldProps,u=(0,a.Z)(e,c);return(0,o.jsx)(i.Z,(0,t.Z)({ref:r,valueType:"textarea",fieldProps:n,proFieldProps:s},u))};r.Z=s.forwardRef(u)},10812:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return Q}});var t=n(15009),a=n.n(t),s=n(97857),i=n.n(s),o=n(19632),c=n.n(o),u=n(64599),l=n.n(u),f=n(99289),d=n.n(f),p=n(5574),m=n.n(p),g=n.p+"static/msigPubkey.c1821967.png",x=n(37476),h=n(90672),v=n(59530),b=n(45360),k=n(62435),S=n(86074),w=k.forwardRef((function(e,r){var n=b.ZP.useMessage(),t=m()(n,2),a=t[0],s=t[1],i=(0,k.useRef)(),o=(0,k.useState)(!1),c=m()(o,2),u=c[0],l=c[1],f=(0,k.useState)(""),d=m()(f,2),p=d[0],g=d[1],w=(0,k.useState)(""),y=m()(w,2),j=y[0],C=y[1],N=(0,v.useIntl)(),M=N.formatMessage({id:"msig.intlPreviewFail"}),T=N.formatMessage({id:"msig.intlClose"}),P=(0,k.useCallback)((function(e){var r=new FileReader;r.readAsText(e.originFileObj),r.onload=function(){try{var n,t=JSON.parse(r.result);if(t)null===(n=i.current)||void 0===n||n.setFieldValue("content",JSON.stringify(t,null,2)),g(JSON.stringify(t,null,2)),C(e.name),l(!0);else a.error("".concat(M))}catch(e){a.error("".concat(M))}}}),[]);return(0,k.useImperativeHandle)(r,(function(){return{handleOpen:P}})),(0,S.jsxs)(x.Y,{formRef:i,title:(0,S.jsx)("div",{className:"mt-3",children:j}),open:u,onOpenChange:function(e){l(e)},layout:"vertical",width:"700px",modalProps:{style:{top:25}},submitter:{searchConfig:{resetText:T},render:function(e,r){return[r[0]]}},children:[(0,S.jsx)(h.Z,{name:"content",fieldProps:{autoSize:{minRows:5},allowClear:!1,autoFocus:!1,onChange:void 0,value:p}}),s]})})),y=(0,k.memo)(w),j=n(64119),C=n(11774),N=n(38345),M=n(97269),T=n(1413),P=n(87462),F={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},Z=n(84089),O=function(e,r){return k.createElement(Z.Z,(0,P.Z)({},e,{ref:r,icon:F}))};var R=k.forwardRef(O),I=n(28459),J=n(2058),A=n(9105),L=n(90789),_=k.forwardRef((function(e,r){var n=e.fieldProps,t=e.title,a=void 0===t?"单击或拖动文件到此区域进行上传":t,s=e.icon,i=void 0===s?(0,S.jsx)(R,{}):s,o=e.description,c=void 0===o?"支持单次或批量上传":o,u=e.action,l=e.accept,f=e.onChange,d=e.value,p=e.children,m=e.max,g=e.proFieldProps,x=(0,k.useContext)(I.ZP.ConfigContext),h=(0,k.useContext)(A.A),v=(null==g?void 0:g.mode)||h.mode||"edit",b=x.getPrefixCls("upload"),w=(void 0===m||!d||(null==d?void 0:d.length)<m)&&"read"!==v&&!0!==(null==g?void 0:g.readonly);return(0,S.jsxs)(J.Z.Dragger,(0,T.Z)((0,T.Z)({ref:r,name:"files",action:u,accept:l,fileList:d},n),{},{onChange:function(e){null==f||f(e),null!=n&&n.onChange&&(null==n||n.onChange(e))},style:(0,T.Z)((0,T.Z)({},null==n?void 0:n.style),{},{display:w?void 0:"none"}),children:[(0,S.jsx)("p",{className:"".concat(b,"-drag-icon"),children:i}),(0,S.jsx)("p",{className:"".concat(b,"-text"),children:a}),(0,S.jsx)("p",{className:"".concat(b,"-hint"),children:c}),p?(0,S.jsx)("div",{className:"".concat(b,"-extra"),style:{padding:16},children:p}):null]}))})),z=(0,L.G)(_,{getValueFromEvent:function(e){return e.fileList}}),E=n(80507),V=n(99021),Y=n(15867),H=n(27484),D=n.n(H),U=n(70178),W=n.n(U);D().extend(W());var Q=function(){var e=b.ZP.useMessage(),r=m()(e,2),n=r[0],t=r[1],s=(0,v.useSelector)((function(e){return e.global.session})),o=(0,v.useSelector)((function(e){return e.global.account})),u=(0,k.useRef)(),f=(0,k.useRef)(),p=(0,k.useRef)(),x=(0,k.useState)(""),w=m()(x,2),T=w[0],P=w[1],F=(0,k.useState)(""),Z=m()(F,2),O=Z[0],R=Z[1],I=(0,k.useState)(""),A=m()(I,2),L=A[0],_=A[1],H=(0,k.useState)(1),U=m()(H,2),W=U[0],Q=U[1],G=(0,k.useState)([]),q=m()(G,2),B=q[0],K=q[1],X=(0,v.useIntl)(),$=X.formatMessage({id:"verify.intlSignSuccess"}),ee=X.formatMessage({id:"verify.intlSignFail"}),re=X.formatMessage({id:"common.intlCopySuccess"}),ne=X.formatMessage({id:"common.intlInputException"}),te=X.formatMessage({id:"msig.intlImportFail"}),ae=X.formatMessage({id:"msig.intlImportSuccess"}),se=X.formatMessage({id:"msig.intlUploadFail"}),ie=X.formatMessage({id:"msig.intlUploadSuccess"}),oe=X.formatMessage({id:"common.intlPleaseConnectWallet"}),ce=X.formatMessage({id:"common.intlPleaseConnectNetwork"}),ue=X.formatMessage({id:"msig.intlSignedTransaction"}),le=X.formatMessage({id:"msig.intlSign"}),fe=X.formatMessage({id:"msig.intlImportTransaction"}),de=X.formatMessage({id:"msig.intlExportSignedTransaction"}),pe=X.formatMessage({id:"msig.intlCopySignedTransaction"}),me=X.formatMessage({id:"msig.intlTransactionInfo"}),ge=X.formatMessage({id:"msig.intlSendTransaction"}),xe=X.formatMessage({id:"msig.intlSend"}),he=X.formatMessage({id:"msig.intlSignAndSend"}),ve=X.formatMessage({id:"msig.intlNoNeedInput"}),be=X.formatMessage({id:"msig.intlTransactionEmpty"}),ke=X.formatMessage({id:"msig.intlTransactionDifferent"}),Se=X.formatMessage({id:"common.intlTxSuccess"}),we=X.formatMessage({id:"common.intlTxFail"}),ye=X.formatMessage({id:"contract.intlCreateTransaction"}),je=X.formatMessage({id:"msig.intlCreatTxTip1"}),Ce=X.formatMessage({id:"msig.intlCreatTxTip2"}),Ne=X.formatMessage({id:"msig.intlCreatTxTip3"}),Me=(0,k.useCallback)(function(){var e=d()(a()().mark((function e(r){var t,f,d,p,g,x,h,v,b,k,S,w,y,C,N,M,T,F,Z,O,I,J,A,L,z,V,Y,H;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s&&s.broadcast){e.next=5;break}return n.error("".concat(oe)),e.abrupt("return",!1);case 5:if(o){e.next=8;break}return n.error("".concat(ce)),e.abrupt("return",!1);case 8:t=JSON.parse(r.transactionInfo),f=E.uQ.from(t),d=E.YW.from(t),p=[],g=new Set,d.actions.forEach((function(e){g.add(e.account.toString())})),x=l()(g),e.prev=15,x.s();case 17:if((h=x.n()).done){e.next=33;break}return v=h.value,e.next=21,(0,j.zI)(s.client.v1.chain.get_abi(v));case 21:if(b=e.sent,k=m()(b,2),S=k[0],w=k[1],!S){e.next=30;break}return n.error(S),e.abrupt("return",!1);case 30:p.push({abi:E.dL.from(w.abi),account:E.VG.from(v)});case 31:e.next=17;break;case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(15),x.e(e.t0);case 38:return e.prev=38,x.f(),e.finish(38);case 41:return e.next=43,(0,j.zI)(s.transact({transaction:d},{broadcast:!1,transactPlugins:[],abis:p}));case 43:if(y=e.sent,C=m()(y,2),N=C[0],M=C[1],!N){e.next=52;break}return n.error(N),e.abrupt("return",!1);case 52:if(!M){e.next=84;break}F=M.resolved.transaction,Z=M.signatures[0],O=Array.from(new Set([].concat(c()(f.signatures.map(String)),[Z]))),I=E.uQ.from(i()(i()({},F),{},{signatures:O})),J=E.Pc.from(Z),A=J.recoverDigest(M.resolved.signingDigest).toString(),L=o.data.permissions,z=0;case 61:if(!(z<L.length)){e.next=77;break}if(L[z].perm_name.toString()!==s.permission.toString()){e.next=74;break}V=L[z].required_auth.keys,Y=0;case 65:if(!(Y<V.length)){e.next=73;break}if(V[Y].key.toString()!==A){e.next=70;break}return R(A),Q(V[Y].weight.value),e.abrupt("break",73);case 70:Y++,e.next=65;break;case 73:return e.abrupt("break",77);case 74:z++,e.next=61;break;case 77:H=D()(F.expiration.toString()).utc().format("YYYY-MM-DDTHH:mm:ss"),_(H),null===(T=u.current)||void 0===T||T.setFieldValue("signedTransaction",JSON.stringify(I,null,2)),P(JSON.stringify(I,null,2)),n.success("".concat($)),e.next=85;break;case 84:n.error("".concat(ee));case 85:return e.abrupt("return",!0);case 86:case"end":return e.stop()}}),e,null,[[15,35,38,41]])})));return function(r){return e.apply(this,arguments)}}(),[s,o]),Te=(0,k.useCallback)(d()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.navigator.clipboard.writeText(T);case 2:n.success("".concat(re));case 3:case"end":return e.stop()}}),e)}))),[T]),Pe=(0,k.useCallback)(function(){var e=d()(a()().mark((function e(r){var t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new FileReader).readAsText(r.fileList[0].originFileObj),t.onload=function(){try{var e,r=JSON.parse(t.result);if(r)null===(e=u.current)||void 0===e||e.setFieldValue("transactionInfo",JSON.stringify(r,null,2)),n.success("".concat(ae));else n.error("".concat(te))}catch(e){n.error("".concat(te))}};case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),[]),Fe=(0,k.useCallback)(function(){var e=d()(a()().mark((function e(r){var t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("removed"!==r.file.status){e.next=3;break}return K(r.fileList),e.abrupt("return");case 3:(t=new FileReader).readAsText(r.fileList[r.fileList.length-1].originFileObj),t.onload=function(){try{JSON.parse(t.result)?(K(r.fileList),n.success("".concat(ie))):n.error("".concat(se))}catch(e){n.error("".concat(se))}};case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),[]),Ze=(0,k.useCallback)((function(){var e=s.actor.toString(),r=s.permission.toString(),n="data:,".concat(T),t=document.createElement("a");t.href=n,t.download="".concat(e,"@").concat(r,"#").concat(O,"_weight@").concat(W,"_expiration@").concat(L,"_signed.json"),t.click()}),[T,s,O,L,W]),Oe=(0,k.useCallback)(d()(a()().mark((function e(){var r,t,o,c,u,f,d,p,m;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==B.length){e.next=3;break}return n.error(be),e.abrupt("return",!1);case 3:e.prev=3,r=new Set,t="",o=l()(B),e.prev=7,u=a()().mark((function e(){var s,i,o;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=c.value,e.next=3,new Promise((function(e){var r=new FileReader;r.readAsText(s.originFileObj),r.onload=function(){return e(r.result)}}));case 3:if(i=e.sent,(o=JSON.parse(i)).signatures.forEach((function(e){r.add(e)})),t){e.next=11;break}o.signatures=[],t=JSON.stringify(o),e.next=15;break;case 11:if(o.signatures=[],t===JSON.stringify(o)){e.next=15;break}return n.error(ke),e.abrupt("return",{v:!1});case 15:case"end":return e.stop()}}),e)})),o.s();case 10:if((c=o.n()).done){e.next=17;break}return e.delegateYield(u(),"t0",12);case 12:if(!(f=e.t0)){e.next=15;break}return e.abrupt("return",f.v);case 15:e.next=10;break;case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(7),o.e(e.t1);case 22:return e.prev=22,o.f(),e.finish(22);case 25:return d=E.YW.from(JSON.parse(t)),p=E.uQ.from(i()(i()({},d),{},{signatures:Array.from(r)})),e.next=29,s.client.v1.chain.push_transaction(p);case 29:(m=e.sent)&&m.processed&&"executed"===m.processed.receipt.status?n.success(Se):n.error(we),e.next=36;break;case 33:e.prev=33,e.t2=e.catch(3),(0,j.Tv)(e.t2,n);case 36:case"end":return e.stop()}}),e,null,[[3,33],[7,19,22,25]])}))),[B,n,s]),Re=(0,k.useCallback)(d()(a()().mark((function e(){var r,t,c,u,f,d,p,g,x,h,v,b,k,S,w,y,C,N,M,T,P,F,Z,O;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==B.length){e.next=3;break}return n.error(be),e.abrupt("return",!1);case 3:if(s&&s.broadcast){e.next=8;break}return n.error("".concat(oe)),e.abrupt("return");case 8:if(o){e.next=11;break}return n.error("".concat(ce)),e.abrupt("return");case 11:e.prev=11,r=new Set,t="",c=l()(B),e.prev=15,f=a()().mark((function e(){var s,i,o;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=u.value,e.next=3,new Promise((function(e){var r=new FileReader;r.readAsText(s.originFileObj),r.onload=function(){return e(r.result)}}));case 3:if(i=e.sent,(o=JSON.parse(i)).signatures.forEach((function(e){r.add(e)})),t){e.next=11;break}o.signatures=[],t=JSON.stringify(o),e.next=15;break;case 11:if(o.signatures=[],t===JSON.stringify(o)){e.next=15;break}return n.error(ke),e.abrupt("return",{v:!1});case 15:case"end":return e.stop()}}),e)})),c.s();case 18:if((u=c.n()).done){e.next=25;break}return e.delegateYield(f(),"t0",20);case 20:if(!(d=e.t0)){e.next=23;break}return e.abrupt("return",d.v);case 23:e.next=18;break;case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(15),c.e(e.t1);case 30:return e.prev=30,c.f(),e.finish(30);case 33:p=E.YW.from(JSON.parse(t)),g=[],x=new Set,p.actions.forEach((function(e){x.add(e.account.toString())})),h=l()(x),e.prev=38,h.s();case 40:if((v=h.n()).done){e.next=56;break}return b=v.value,e.next=44,(0,j.zI)(s.client.v1.chain.get_abi(b));case 44:if(k=e.sent,S=m()(k,2),w=S[0],y=S[1],!w){e.next=53;break}return n.error(w),e.abrupt("return",!1);case 53:g.push({abi:E.dL.from(y.abi),account:E.VG.from(b)});case 54:e.next=40;break;case 56:e.next=61;break;case 58:e.prev=58,e.t2=e.catch(38),h.e(e.t2);case 61:return e.prev=61,h.f(),e.finish(61);case 64:return e.next=66,(0,j.zI)(s.transact({transaction:p},{broadcast:!1,transactPlugins:[],abis:g}));case 66:if(C=e.sent,N=m()(C,2),M=N[0],T=N[1],!M){e.next=75;break}return n.error(M),e.abrupt("return",!1);case 75:return P=T.resolved.transaction,F=T.signatures[0],r.add(F),Z=E.uQ.from(i()(i()({},P),{},{signatures:Array.from(r)})),e.next=81,s.client.v1.chain.push_transaction(Z);case 81:(O=e.sent)&&O.processed&&"executed"===O.processed.receipt.status?n.success(Se):n.error(we);case 83:e.next=88;break;case 85:e.prev=85,e.t3=e.catch(11),(0,j.Tv)(e.t3,n);case 88:case"end":return e.stop()}}),e,null,[[11,85],[15,27,30,33],[38,58,61,64]])}))),[B,n,s,o]);return(0,S.jsxs)(C._z,{className:"msig",ghost:!0,children:[(0,S.jsxs)("div",{className:"flex justify-evenly flex-wrap items-start",children:[(0,S.jsxs)(N.Z,{className:" mb-4",title:(0,S.jsx)("span",{className:" font-semibold text-lg hardline",children:ye}),children:[(0,S.jsx)("div",{children:je}),(0,S.jsx)("div",{children:Ce}),(0,S.jsx)("div",{children:Ne}),(0,S.jsx)(V.Z,{src:g,width:300})]}),(0,S.jsx)(N.Z,{className:" mb-4",title:(0,S.jsx)("span",{className:" font-semibold text-lg hardline",children:ue}),children:(0,S.jsxs)(M.A,{style:{overflowWrap:"anywhere"},formRef:u,onFinish:function(){var e=d()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Me(r));case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),onReset:function(){var e;null===(e=u.current)||void 0===e||e.resetFields(),P("")},submitter:{searchConfig:{submitText:le},render:function(e,r){return(0,S.jsxs)("div",{style:{marginTop:"10px"},children:[(0,S.jsxs)("div",{className:"flex",children:[(0,S.jsx)(J.Z,{className:"mr-[8px]",accept:".json",maxCount:1,showUploadList:!1,onChange:Pe,beforeUpload:function(){return!1},children:(0,S.jsx)(Y.ZP,{type:"primary",children:fe})},"upload"),(0,S.jsx)("div",{className:"mr-[8px]",children:r[1]}),(0,S.jsx)(Y.ZP,{className:"mr-[8px]",type:"primary",onClick:Ze,children:de},"export")]}),(0,S.jsxs)("div",{className:"flex mt-[14px]",children:[(0,S.jsx)(Y.ZP,{className:"mr-[8px]",onClick:Te,children:pe},"copy"),(0,S.jsx)("div",{className:"mr-[8px]",children:r[0]})]})]})}},children:[(0,S.jsx)(h.Z,{name:"transactionInfo",label:me,fieldProps:{autoSize:{minRows:7},autoFocus:!1},rules:[{required:!0,whitespace:!0,message:"".concat(ne)}]}),(0,S.jsx)(h.Z,{name:"signedTransaction",label:ue,placeholder:ve,fieldProps:{autoSize:{minRows:7},autoFocus:!1,onChange:void 0,value:T}})]})}),(0,S.jsx)(N.Z,{title:(0,S.jsx)("span",{className:" font-semibold text-lg hardline mb-4",children:ge}),children:(0,S.jsx)(M.A,{formRef:f,onFinish:d()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Oe());case 1:case"end":return e.stop()}}),e)}))),onReset:function(){var e;null===(e=f.current)||void 0===e||e.resetFields(),K([])},submitter:{searchConfig:{submitText:xe},render:function(e,r){return[r[1],(0,S.jsx)(Y.ZP,{onClick:Re,children:he},"send"),r[0]]}},children:(0,S.jsx)(z,{label:me,name:"transactionInfo",action:"upload.do",fieldProps:{accept:".json",onChange:Fe,beforeUpload:function(){return!1},listType:"picture",onPreview:function(e){return p.current.handleOpen(e)},fileList:B}})})}),(0,S.jsx)(y,{ref:p})]}),t]})}},64599:function(e,r,n){var t=n(96263);e.exports=function(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=t(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var a=0,s=function(){};return{s:s,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}},e.exports.__esModule=!0,e.exports.default=e.exports}}]);