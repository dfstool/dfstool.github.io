"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[545],{69258:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var r=n(15009),s=n.n(r),o=n(52677),a=n.n(o),c=n(99289),l=n.n(c),i=n(5574),u=n.n(i),d=n(59530),f=n(62435),p=n(45360),x=n(2487),h=n(11774),v=n(38345),g=n(37476),j=n(98097),m=n(27484),S=n.n(m),k=n(70178),b=n.n(k),y=n(38823),N=n.n(y),O=n(86074);S().extend(b()),S().extend(N());var w=f.forwardRef((function(e,t){var n=p.ZP.useMessage(),r=u()(n,2),o=r[0],c=r[1],i=(0,d.useSelector)((function(e){return e.global.contractKit})),x=(0,f.useState)(),h=u()(x,2),v=h[0],m=h[1],k=(0,f.useState)(),b=u()(k,2),y=b[0],N=b[1],w=(0,f.useRef)(),D=(0,f.useState)(!1),I=u()(D,2),C=I[0],F=I[1],Z=(0,f.useState)(!0),M=u()(Z,2),_=M[0],E=M[1],J=(0,f.useCallback)(function(){var e=l()(s()().mark((function e(t,n){var r,c,l;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.load("dfsweb3desoc");case 3:return r=e.sent,c=r.table("profiles"),e.next=7,c.all({scope:"dfsweb3desoc",from:n.voter.toString(),to:n.voter.toString()});case 7:l=e.sent,m(l[0]),E(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),e.t0 instanceof Error?(console.log(e.t0.message),o.error(e.t0.message)):e.t0.response?(console.log(e.t0.response),o.error(JSON.stringify(e.t0.response.data))):e.t0.request?(console.log("no response"),o.error("No response")):(console.log(e.t0),"object"===a()(e.t0)?o.error(JSON.stringify(e.t0)):o.error(e.t0));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}(),[]),K=(0,f.useCallback)((function(e){J(i,e),N(e),F(!0)}),[i]);(0,f.useImperativeHandle)(t,(function(){return{handleOpen:K}}));var R=(0,f.useCallback)(l()(s()().mark((function e(){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)}))),[]),q=(0,f.useCallback)((function(e){return e?"DFS Node Online - 广州"===e?"DFS Node - 广州@":"DFS Node Online - 杭州"===e?"DFS Node - 杭州@":"DFS Node Online - 香港"===e?"DFS Node - 香港@":"DFS-美国弗吉尼亚-Node"===e?"DFS-美国弗吉尼亚@":e+"@":""}),[]),z=(0,f.useMemo)((function(){return[{title:"sex",dataIndex:"sex",key:"sex",render:function(e,t){return Object.keys(t).length?(0,O.jsx)("span",{children:t.sex.toNumber()}):(0,O.jsx)("span",{children:"null"})}},{title:"cover",dataIndex:"cover",key:"cover",render:function(e,t){return Object.keys(t).length?(0,O.jsx)("span",{children:t.cover}):(0,O.jsx)("span",{children:"null"})}},{title:"desc",dataIndex:"desc",key:"desc",render:function(e,t){return Object.keys(t).length?(0,O.jsx)("span",{children:t.desc}):(0,O.jsx)("span",{children:"null"})}},{title:"avatar",dataIndex:"avatar",key:"avatar",render:function(e,t){return Object.keys(t).length?(0,O.jsx)("span",{children:t.avatar}):(0,O.jsx)("span",{children:"null"})}},{title:"join",dataIndex:"join",key:"join",render:function(e,t){return Object.keys(t).length?(0,O.jsx)("span",{children:S().utc(t.join.toString()).local().format()}):(0,O.jsx)("span",{children:"null"})}},{title:"update",dataIndex:"update",key:"update",render:function(e,t){return Object.keys(t).length?(0,O.jsx)("span",{children:S().utc(t.update.toString()).local().format()}):(0,O.jsx)("span",{children:"null"})}}]}),[]);return(0,O.jsxs)(g.Y,{formRef:w,title:"",open:C,onFinish:R,onOpenChange:function(e){F(e)},layout:"horizontal",width:"350px",submitter:!1,children:[(0,O.jsx)(j.vY,{title:(0,O.jsx)("div",{className:"flex items-center",children:(0,O.jsx)("div",{className:"",children:q(null==v?void 0:v.nick)+(null==y?void 0:y.voter.toString())})}),loading:_,column:1,dataSource:v,columns:z}),c]})})),D=(0,f.memo)(w),I=n(19601),C=function(){var e=(0,d.useDispatch)(),t=p.ZP.useMessage(),n=u()(t,2),r=n[0],o=n[1],c=(0,d.useSelector)((function(e){return e.global.contractKit})),i=(0,f.useState)(!1),g=u()(i,2),j=g[0],m=g[1],S=(0,d.useSelector)((function(e){return e.vote.kingDataSource})),k=(0,f.useRef)(),b=(0,d.useIntl)().formatMessage({id:"vote.intlTheKingOfVotes"}),y=(0,f.useCallback)(function(){var t=l()(s()().mark((function t(n){var o,c,l,i;return s()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.load("dfsbpsvoters");case 3:return o=t.sent,c=o.table("voters"),t.next=7,c.all();case 7:l=t.sent,(i=l.sort((function(e,t){return t.vote_power.value-e.vote_power.value}))).forEach((function(e,t){i[t].rank=t+1})),e(I.N.setKingDataSource(i)),m(!1),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),m(!1),t.t0 instanceof Error?(console.log(t.t0.message),r.error(t.t0.message)):t.t0.response?(console.log(t.t0.response),r.error(JSON.stringify(t.t0.response.data))):t.t0.request?(console.log("no response"),r.error("No response")):(console.log(t.t0),"object"===a()(t.t0)?r.error(JSON.stringify(t.t0)):r.error(t.t0));case 18:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}(),[]);return(0,f.useEffect)((function(){c?(S.length?m(!1):m(!0),y(c)):m(!0)}),[c,y]),(0,O.jsx)(h._z,{className:"",ghost:!0,children:(0,O.jsx)("div",{className:"flex justify-center",children:(0,O.jsxs)(v.Z,{className:"flex justify-center",title:(0,O.jsx)("span",{className:"text-xl font-semibold",children:b}),headerBordered:!0,headStyle:{justifyContent:"center"},style:{width:"500px"},children:[(0,O.jsx)(x.Z,{dataSource:S,loading:j,renderItem:function(e){return(0,O.jsxs)(x.Z.Item,{className:"hover:cursor-pointer",onClick:function(){return k.current.handleOpen(e)},children:[(0,O.jsx)(x.Z.Item.Meta,{title:"".concat(e.rank,". ")+e.voter.toString(),description:"Last Vote: "+e.last_vote.toString()}),(0,O.jsx)("div",{className:"font-semibold",children:(e.vote_power.value/1e8).toFixed(0)})]})}}),(0,O.jsx)(D,{ref:k}),o]})})})}}}]);