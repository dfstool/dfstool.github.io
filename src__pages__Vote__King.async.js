"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[545],{69258:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var r=n(15009),s=n.n(r),o=n(52677),a=n.n(o),c=n(99289),l=n.n(c),i=n(5574),u=n.n(i),d=n(37476),f=n(98097),p=n(59530),x=n(45360),h=n(27484),v=n.n(h),g=n(38823),j=n.n(g),m=n(70178),S=n.n(m),k=n(62435),b=n(86074);v().extend(S()),v().extend(j());var y=k.forwardRef((function(e,t){var n=x.ZP.useMessage(),r=u()(n,2),o=r[0],c=r[1],i=(0,p.useSelector)((function(e){return e.global.contractKit})),h=(0,k.useState)(),g=u()(h,2),j=g[0],m=g[1],S=(0,k.useState)(),y=u()(S,2),N=y[0],O=y[1],w=(0,k.useRef)(),D=(0,k.useState)(!1),I=u()(D,2),C=I[0],F=I[1],Z=(0,k.useState)(!0),M=u()(Z,2),_=M[0],E=M[1],J=(0,k.useCallback)(function(){var e=l()(s()().mark((function e(t,n){var r,c,l;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.load("dfsweb3desoc");case 3:return r=e.sent,c=r.table("profiles"),e.next=7,c.all({scope:"dfsweb3desoc",from:n.voter.toString(),to:n.voter.toString()});case 7:l=e.sent,m(l[0]),E(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),e.t0 instanceof Error?(console.log(e.t0.message),o.error(e.t0.message)):e.t0.response?(console.log(e.t0.response),o.error(JSON.stringify(e.t0.response.data))):e.t0.request?(console.log("no response"),o.error("No response")):(console.log(e.t0),"object"===a()(e.t0)?o.error(JSON.stringify(e.t0)):o.error(e.t0));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}(),[]),K=(0,k.useCallback)((function(e){J(i,e),O(e),F(!0)}),[i]);(0,k.useImperativeHandle)(t,(function(){return{handleOpen:K}}));var R=(0,k.useCallback)(l()(s()().mark((function e(){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)}))),[]),q=(0,k.useCallback)((function(e){return e?"DFS Node Online - 广州"===e?"DFS Node - 广州@":"DFS Node Online - 杭州"===e?"DFS Node - 杭州@":"DFS Node Online - 香港"===e?"DFS Node - 香港@":"DFS-美国弗吉尼亚-Node"===e?"DFS-美国弗吉尼亚@":e+"@":""}),[]),z=(0,k.useMemo)((function(){return[{title:"sex",dataIndex:"sex",key:"sex",render:function(e,t){return Object.keys(t).length?(0,b.jsx)("span",{children:t.sex.toNumber()}):(0,b.jsx)("span",{children:"null"})}},{title:"cover",dataIndex:"cover",key:"cover",render:function(e,t){return Object.keys(t).length?(0,b.jsx)("span",{children:t.cover}):(0,b.jsx)("span",{children:"null"})}},{title:"desc",dataIndex:"desc",key:"desc",render:function(e,t){return Object.keys(t).length?(0,b.jsx)("span",{children:t.desc}):(0,b.jsx)("span",{children:"null"})}},{title:"avatar",dataIndex:"avatar",key:"avatar",render:function(e,t){return Object.keys(t).length?(0,b.jsx)("span",{children:t.avatar}):(0,b.jsx)("span",{children:"null"})}},{title:"join",dataIndex:"join",key:"join",render:function(e,t){return Object.keys(t).length?(0,b.jsx)("span",{children:v().utc(t.join.toString()).local().format()}):(0,b.jsx)("span",{children:"null"})}},{title:"update",dataIndex:"update",key:"update",render:function(e,t){return Object.keys(t).length?(0,b.jsx)("span",{children:v().utc(t.update.toString()).local().format()}):(0,b.jsx)("span",{children:"null"})}}]}),[]);return(0,b.jsxs)(d.Y,{formRef:w,title:"",open:C,onFinish:R,onOpenChange:function(e){F(e)},layout:"horizontal",width:"350px",submitter:!1,children:[(0,b.jsx)(f.vY,{title:(0,b.jsx)("div",{className:"flex items-center",children:(0,b.jsx)("div",{className:"",children:q(null==j?void 0:j.nick)+(null==N?void 0:N.voter.toString())})}),loading:_,column:1,dataSource:j,columns:z}),c]})})),N=(0,k.memo)(y),O=n(19601),w=n(11774),D=n(38345),I=n(2487),C=function(){var e=(0,p.useDispatch)(),t=x.ZP.useMessage(),n=u()(t,2),r=n[0],o=n[1],c=(0,p.useSelector)((function(e){return e.global.contractKit})),i=(0,k.useState)(!1),d=u()(i,2),f=d[0],h=d[1],v=(0,p.useSelector)((function(e){return e.vote.kingDataSource})),g=(0,k.useRef)(),j=(0,p.useIntl)().formatMessage({id:"vote.intlTheKingOfVotes"}),m=(0,k.useCallback)(function(){var t=l()(s()().mark((function t(n){var o,c,l,i;return s()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.load("dfsbpsvoters");case 3:return o=t.sent,c=o.table("voters"),t.next=7,c.all();case 7:l=t.sent,(i=l.sort((function(e,t){return t.vote_power.value-e.vote_power.value}))).forEach((function(e,t){i[t].rank=t+1})),e(O.N.setKingDataSource(i)),h(!1),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),h(!1),t.t0 instanceof Error?(console.log(t.t0.message),r.error(t.t0.message)):t.t0.response?(console.log(t.t0.response),r.error(JSON.stringify(t.t0.response.data))):t.t0.request?(console.log("no response"),r.error("No response")):(console.log(t.t0),"object"===a()(t.t0)?r.error(JSON.stringify(t.t0)):r.error(t.t0));case 18:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}(),[]);return(0,k.useEffect)((function(){c?(v.length?h(!1):h(!0),m(c)):h(!0)}),[c,m]),(0,b.jsx)(w._z,{className:"",ghost:!0,children:(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsxs)(D.Z,{className:"flex justify-center",title:(0,b.jsx)("span",{className:"text-xl font-semibold",children:j}),headerBordered:!0,headStyle:{justifyContent:"center"},style:{width:"500px"},children:[(0,b.jsx)(I.Z,{dataSource:v,loading:f,renderItem:function(e){return(0,b.jsxs)(I.Z.Item,{className:"hover:cursor-pointer",onClick:function(){return g.current.handleOpen(e)},children:[(0,b.jsx)(I.Z.Item.Meta,{title:"".concat(e.rank,". ")+e.voter.toString(),description:"Last Vote: "+e.last_vote.toString()}),(0,b.jsx)("div",{className:"font-semibold",children:(e.vote_power.value/1e8).toFixed(0)})]})}}),(0,b.jsx)(N,{ref:g}),o]})})})}}}]);