"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3574],{98165:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(87462),s=n(62435),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},o=n(84089),c=function(e,t){return s.createElement(o.Z,(0,r.Z)({},e,{ref:t,icon:a}))};var u=s.forwardRef(c)},25209:function(e,t,n){n.r(t);var r=n(15009),s=n.n(r),a=n(97857),o=n.n(a),c=n(99289),u=n.n(c),i=n(5574),l=n.n(i),d=n(40956),f=n(64119),p=n(98165),m=n(11774),x=n(92340),h=n(59530),g=n(80507),v=n(45360),k=n(7134),b=n(34041),y=n(27484),w=n.n(y),S=n(70178),j=n.n(S),N=n(62435),_=n(9669),C=n.n(_),D=(n(8849),n(86074));w().extend(j());t.default=function(){var e=v.ZP.useMessage(),t=l()(e,2),n=t[0],r=t[1],a=(0,h.useNavigate)(),c=(0,h.useDispatch)(),i=(0,h.useSelector)((function(e){return e.global.session})),y=(0,h.useSelector)((function(e){return e.ppp.pppSwapLog})),S=(0,h.useSelector)((function(e){return e.global.contractKit})),j=(0,N.useState)(!1),_=l()(j,2),M=_[0],A=_[1],T=(0,N.useState)(!1),z=l()(T,2),F=z[0],I=z[1],R=(0,N.useState)(!1),Z=l()(R,2),E=Z[0],P=Z[1],H=(0,N.useState)(""),L=l()(H,2),O=L[0],Y=L[1],V=(0,N.useState)([]),B=l()(V,2),U=B[0],q=B[1],K=(0,N.useState)([]),G=l()(K,2),J=G[0],Q=G[1],W=(0,N.useState)([]),X=l()(W,2),$=X[0],ee=X[1],te=(0,N.useState)({}),ne=l()(te,2),re=ne[0],se=ne[1],ae=(0,N.useState)([]),oe=l()(ae,2),ce=oe[0],ue=oe[1],ie=(0,N.useRef)(0),le=(0,N.useRef)(void 0),de=(0,h.useIntl)(),fe=de.formatMessage({id:"swaplog.intlUser"}),pe=de.formatMessage({id:"swaplog.intlFrom"}),me=de.formatMessage({id:"swaplog.intlTo"}),xe=de.formatMessage({id:"swaplog.intlTime"}),he=(0,N.useCallback)(function(){var e=u()(s()().mark((function e(t){var r,a,u,i,p,m,x,h,v,k,b,y,S,j,N,_,C,D,M,T,z;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,clearTimeout(ie.current),r=[],a=[],u=[],i=[],!(p=Number(le.current))){e.next=13;break}return e.next=10,t.client.v1.chain.get_table_rows({code:"loglogloglog",table:"logs",scope:"loglogloglog",lower_bound:g.zM.from(p),upper_bound:g.zM.from(p),index_position:"secondary",key_type:"i64",limit:200,reverse:!0});case 10:m=e.sent,e.next=16;break;case 13:return e.next=15,t.client.v1.chain.get_table_rows({code:"loglogloglog",table:"logs",scope:"loglogloglog",limit:1e3,reverse:!0});case 15:m=e.sent;case 16:x=0;case 17:if(!(x<m.rows.length)){e.next=33;break}if(h=m.rows[x],v=h.in.split(" "),k=l()(v,2),b=k[0],y=k[1],S=h.out.split(" "),j=l()(S,2),N=j[0],_=j[1],C=m.rows[x].mid,D="",M="",T="",z=0,!(C<25)){e.next=28;break}return e.abrupt("continue",30);case 28:"DFS"===y||"USDT"===y||"ORDI"===y?(D="Buy",M=re[_],T=h.out,z=Number(N)):(D="Sell",M=re[y],T=h.in,z=Number(b)),r.push(o()(o()({},h),{},{key:x,create_time:w().utc(h.create_time).local().format("MM-DDTHH:mm:ss"),inSym:y,outSym:_,inAmount:Number(b),outAmount:Number(N),type:D,logo:M,amount:T,amountValue:z}));case 30:x++,e.next=17;break;case 33:r.forEach((function(e){a.includes(e.inSym)||a.push(e.inSym),u.includes(e.outSym)||u.push(e.outSym),i.includes(e.user)||i.push(e.user)})),q(a.sort()),Q(u.sort()),ee(i.sort()),c(d.N.setPPPSwapLog(r)),Y(w()().format("YYYY-MM-DDTHH:mm:ss")),A(!1),ie.current=setTimeout(he,5e3,t),e.next=47;break;case 43:e.prev=43,e.t0=e.catch(0),A(!1),(0,f.Tv)(e.t0,n);case 47:case"end":return e.stop()}}),e,null,[[0,43]])})));return function(t){return e.apply(this,arguments)}}(),[n,i,re]),ge=(0,N.useCallback)(function(){var e=u()(s()().mark((function e(t){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:le.current=t.split("-")[2],A(!0),he(i);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[he,i]),ve=(0,N.useCallback)(u()(s()().mark((function e(){return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!le.current){e.next=5;break}return P(!0),e.next=4,he(i);case 4:P(!1);case 5:case"end":return e.stop()}}),e)}))),[he,i]),ke=(0,N.useCallback)(u()(s()().mark((function e(){var t,r,a,o,c,u,i,l;return s()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,I(!0),t=[{value:"eosio.token-DFS-0-DFS/DFS",label:(0,D.jsxs)("div",{className:"flex items-center",children:[(0,D.jsx)(k.C,{className:"mr-2",size:"default",src:"https://dfs.land/assets/tokens/eosio.token-DFS.png"}),(0,D.jsx)("div",{className:"flex justify-between grow",children:(0,D.jsx)("div",{children:"All Token"})})]}),desc:""}],e.next=5,S.load("dfs3protocol");case 5:return r=e.sent,a=r.table("projects"),e.next=9,a.all();case 9:return o=e.sent,e.next=12,C().get("https://api.dfs.land/dfschain/pppvolume2");case 12:200!==(c=e.sent).status&&n.error("获取pppvolume2数据失败"),u=c.data,i=[],o.forEach((function(e){u.hasOwnProperty(e.id.toString())&&i.push(e)})),i.sort((function(e,t){var n=e.id.toString(),r=t.id.toString();return u[r].volume_24h-u[n].volume_24h})),l={},i.forEach((function(e){var n=e.token_per_nft.symbol.name,r=e.init_nft_price.symbol.name,s=e.mid.toNumber();l[n]=e.token_url,t.push({value:"dfsppptokens-".concat(n,"-").concat(s,"-").concat(r,"/").concat(n),label:(0,D.jsxs)("div",{className:"flex items-center",children:[(0,D.jsx)(k.C,{className:"mr-2",size:"default",src:l[n]}),(0,D.jsxs)("div",{className:"flex justify-between grow",children:[(0,D.jsx)("div",{children:n}),(0,D.jsx)("div",{children:"dfsppptokens"})]})]}),desc:n})})),ue(t),se(l),I(!1),e.next=29;break;case 25:e.prev=25,e.t0=e.catch(0),I(!1),(0,f.Tv)(e.t0,n);case 29:case"end":return e.stop()}}),e,null,[[0,25]])}))),[S,f.Tv]);(0,N.useEffect)((function(){S&&!ce.length&&ke()}),[S,ke]);var be=(0,N.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",render:function(e,t){return(0,D.jsx)("span",{children:t.key+1})}},{title:"".concat(fe),dataIndex:"user",key:"user",sorter:function(e,t){return e.user.localeCompare(t.user)},filters:$.map((function(e){return{text:e,value:e}})),onFilter:function(e,t){return e===t.user},render:function(e,t){return(0,D.jsx)("a",{onClick:function(){return a("/query/account?search=".concat(t.user,"&tab=info"))},children:t.user})}},{title:"".concat(xe),dataIndex:"create_time",key:"create_time",sorter:function(e,t){return w().utc(e.create_time).unix()-w().utc(t.create_time).unix()},render:function(e,t){return(0,D.jsx)("span",{children:t.create_time})}},{title:"操作",dataIndex:"type",key:"type",render:function(e,t){return"Sell"===t.type?(0,D.jsx)("span",{className:" text-red-600",children:t.type}):(0,D.jsx)("span",{className:" text-green-600",children:t.type})}},{title:"数量",dataIndex:"amount",key:"amount",sorter:function(e,t){return t.amountValue-e.amountValue},render:function(e,t){return(0,D.jsxs)("div",{className:"flex items-center",children:[(0,D.jsx)(k.C,{className:"mr-2",src:t.logo}),(0,D.jsx)("div",{children:t.amount})]})}},{title:"".concat(pe),dataIndex:"in",key:"in",filters:U.map((function(e){return{text:e,value:e}})),onFilter:function(e,t){return e===t.inSym},sorter:function(e,t){return t.inAmount-e.inAmount},render:function(e,t){return(0,D.jsx)("span",{children:t.in})}},{title:"".concat(me),dataIndex:"to",key:"to",filters:J.map((function(e){return{text:e,value:e}})),onFilter:function(e,t){return e===t.outSym},sorter:function(e,t){return t.outAmount-e.outAmount},render:function(e,t){return(0,D.jsx)("span",{children:t.out})}}]}),[U,J,$]);return(0,D.jsxs)(m._z,{className:"ppp-swaplog",ghost:!0,children:[(0,D.jsx)(b.default,{loading:F,size:"large",style:{width:"100%"},className:"mb-2",onChange:ge,options:ce,showSearch:!0,filterOption:function(e,t){return t.desc.toLowerCase().includes(e.toLowerCase())},optionRender:function(e){var t=e.key.split("-"),n=l()(t,2),r=n[0],s=n[1],a=r+"-"+s,o="dfsppptokens"===r?re[s]:"https://dfs.land/assets/tokens/"+a+".png";return"DFS"===s&&(s="All Token",r=""),(0,D.jsxs)("div",{className:"flex items-center",children:[(0,D.jsx)(k.C,{className:"mr-2",size:"default",src:o}),(0,D.jsxs)("div",{className:"flex justify-between grow",children:[(0,D.jsx)("div",{children:s}),(0,D.jsx)("div",{children:r})]})]})}}),(0,D.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,D.jsxs)("div",{children:[(0,D.jsx)(p.Z,{spin:E,className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"},onClick:ve}),(0,D.jsx)("span",{className:"ml-[8px]",children:O})]})}),(0,D.jsx)(x.Z,{className:"mb-3",scroll:{x:!0},size:"small",columns:be,dataSource:y,defaultData:[],search:!1,options:!1,pagination:!1,tableAlertRender:!1,tableAlertOptionRender:!1,loading:{spinning:M,size:"large"}}),r]})}},8849:function(){}}]);