(self.webpackChunk=self.webpackChunk||[]).push([[1477],{98165:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(87462),s=r(62435),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},o=r(84089),i=function(e,t){return s.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:a}))};var c=s.forwardRef(i)},64317:function(e,t,r){"use strict";var n=r(1413),s=r(91),a=r(22270),o=r(62435),i=r(66758),c=r(56499),u=r(86074),l=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=function(e,t){var r=e.fieldProps,d=e.children,p=e.params,m=e.proFieldProps,f=e.mode,h=e.valueEnum,v=e.request,x=e.showSearch,g=e.options,b=(0,s.Z)(e,l),j=(0,o.useContext)(i.Z);return(0,u.jsx)(c.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,a.h)(h),request:v,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({options:g,mode:f,showSearch:x,getPopupContainer:j.getPopupContainer},r),ref:t,proFieldProps:m},b),{},{children:d}))},m=o.forwardRef((function(e,t){var r=e.fieldProps,l=e.children,p=e.params,m=e.proFieldProps,f=e.mode,h=e.valueEnum,v=e.request,x=e.options,g=(0,s.Z)(e,d),b=(0,n.Z)({options:x,mode:f||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},r),j=(0,o.useContext)(i.Z);return(0,u.jsx)(c.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,a.h)(h),request:v,params:p,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({getPopupContainer:j.getPopupContainer},b),ref:t,proFieldProps:m},g),{},{children:l}))})),f=o.forwardRef(p);f.SearchSelect=m,f.displayName="ProFormComponent",t.Z=f},30867:function(e,t,r){"use strict";r.d(t,{Z:function(){return p}});var n=r(62435),s=r(75633),a=r(5574),o=r.n(a),i=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]];function c(e,t){var r=t.format,n=void 0===r?"":r,s=new Date(e).getTime(),a=Date.now();return function(e,t){var r=e,n=/\[[^\]]*]/g,s=(t.match(n)||[]).map((function(e){return e.slice(1,-1)})),a=t.replace(n,"[]"),c=i.reduce((function(e,t){var n=o()(t,2),s=n[0],a=n[1];if(e.includes(s)){var i=Math.floor(r/a);return r-=i*a,e.replace(new RegExp("".concat(s,"+"),"g"),(function(e){var t=e.length;return i.toString().padStart(t,"0")}))}return e}),a),u=0;return c.replace(n,(function(){var e=s[u];return u+=1,e}))}(Math.max(s-a,0),n)}var u=r(51409),l=r(86074);var d=function(e){var t=e.value,r=e.format,a=void 0===r?"HH:mm:ss":r,o=e.onChange,i=e.onFinish,d=e.className,p=(0,s.N)(),m=n.useRef(null),f=function(){var e=function(e){return new Date(e).getTime()}(t);e>=Date.now()&&(m.current=(0,u.Zi)((function(){p(),null==o||o(e-Date.now()),e<Date.now()&&(null==i||i(),m.current&&((0,u.cv)(m.current),m.current=null))}),33.333333333333336))};return n.useEffect((function(){return f(),function(){m.current&&((0,u.cv)(m.current),m.current=null)}}),[t]),(0,l.jsx)("div",{className:d,children:c(t,{format:a})})},p=n.memo(d)},53944:function(e,t,r){"use strict";r.r(t);var n=r(19632),s=r.n(n),a=r(97857),o=r.n(a),i=r(15009),c=r.n(i),u=r(99289),l=r.n(u),d=r(5574),p=r.n(d),m=r(30867),f=r(40956),h=r(64119),v=r(87603),x=r(25035),g=r(98165),b=r(11774),j=r(38345),w=r(97269),y=r(64317),k=r(31199),N=r(52688),S=r(5966),Z=r(59530),T=r(80507),_=r(45360),A=r(83062),C=r(7134),M=r(66309),F=r(15867),E=r(9669),P=r.n(E),D=r(27484),I=r.n(D),L=r(70178),z=r.n(L),q=r(62435),R=r(51409),V=r(86074);I().extend(z());var O=[];t.default=function(){var e=(0,Z.useDispatch)(),t=_.ZP.useMessage(),r=p()(t,2),n=r[0],a=r[1],i=(0,Z.useSelector)((function(e){return e.global.contractKit})),u=(0,Z.useSelector)((function(e){return e.global.account})),d=(0,Z.useSelector)((function(e){return e.global.session})),E=(0,Z.useSelector)((function(e){return e.global.privateKey})),D=(0,Z.useSelector)((function(e){return e.ppp.valueEnum})),L=(0,Z.useSelector)((function(e){return e.ppp.stats})),z=(0,Z.useSelector)((function(e){return e.ppp.vipAccounts})),Y=(0,Z.useSelector)((function(e){return e.ppp.accessAccounts})),U=(0,q.useState)(0),H=p()(U,2),$=H[0],W=H[1],K=(0,q.useState)(0),J=p()(K,2),B=J[0],G=J[1],X=(0,q.useState)(0),Q=p()(X,2),ee=Q[0],te=Q[1],re=(0,q.useState)(0),ne=p()(re,2),se=ne[0],ae=ne[1],oe=(0,q.useState)(0),ie=p()(oe,2),ce=ie[0],ue=ie[1],le=(0,q.useState)([]),de=p()(le,2),pe=de[0],me=de[1],fe=(0,q.useState)(""),he=p()(fe,2),ve=he[0],xe=he[1],ge=(0,q.useState)(0),be=p()(ge,2)[1],je=(0,q.useState)(0),we=p()(je,2),ye=we[0],ke=we[1],Ne=(0,q.useState)(!1),Se=p()(Ne,2),Ze=Se[0],Te=Se[1],_e=(0,q.useState)({}),Ae=p()(_e,2),Ce=Ae[0],Me=Ae[1],Fe=(0,q.useState)({}),Ee=p()(Fe,2),Pe=Ee[0],De=Ee[1],Ie=(0,q.useState)(!1),Le=p()(Ie,2),ze=Le[0],qe=Le[1],Re=(0,q.useState)(!1),Ve=p()(Re,2),Oe=Ve[0],Ye=Ve[1],Ue=(0,q.useState)(!1),He=p()(Ue,2),$e=He[0],We=He[1],Ke=(0,q.useState)(!1),Je=p()(Ke,2),Be=Je[0],Ge=Je[1],Xe=(0,Z.useIntl)(),Qe=Xe.formatMessage({id:"coffee.inputException"}),et=Xe.formatMessage({id:"msig.intlTransactionEmpty"}),tt=Xe.formatMessage({id:"common.intlPleaseConnectWallet"}),rt=Xe.formatMessage({id:"common.intlPleaseConnectNetwork"}),nt=(0,q.useRef)([]),st=(0,q.useRef)(!1),at=(0,q.useRef)({}),ot=(0,q.useRef)(),it=(0,q.useRef)(0),ct=(0,q.useRef)(!0),ut=(0,q.useCallback)((function(){var e=0,t=0,r=0,n=0;for(var s in at.current)"success"===at.current[s].status?t+=1:"error"===at.current[s].status?r+=1:"processing"===at.current[s].status?n+=1:"default"===at.current[s].status&&(e+=1);W(t),G(r),te(n),ae(e)}),[]),lt=(0,q.useCallback)((function(e,t){var r=I()(e).add(t,"seconds").valueOf();ke(r)}),[]),dt=(0,q.useCallback)(function(){var e=l()(c()().mark((function e(t){var r;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],t.forEach((function(e){if("success"!==at.current[e.cid].status&&"processing"!==at.current[e.cid].status&&("error"!==at.current[e.cid].status||!at.current[e.cid].message.includes("invalid price"))){var t=new Promise((function(t){at.current[e.cid].status="processing",ut(),d.client.v1.chain.push_transaction(e.signedTransaction).then((function(r){r&&r.processed&&"executed"===r.processed.receipt.status?(at.current[e.cid].status="success",ut(),t(!0)):("success"!==at.current[e.cid].status&&(at.current[e.cid].status="error",O.push({cid:e.cid,error:JSON.stringify(r),pos:"then"}),console.log(r),ut()),t(!1))})).catch((function(r){if("success"!==at.current[e.cid].status){if(at.current[e.cid].status="error",ut(),O.push({cid:e.cid,error:JSON.stringify(r),pos:"catch"}),r instanceof Error)if(r.message.includes("eosio_assert_message assertion failure"))r.details[0].message.includes("invalid price")&&(at.current[e.cid].message="invalid price");console.log(r)}t(!1)}))}));r.push(t)}}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[d,ut]),pt=(0,q.useCallback)(function(){var e=l()(c()().mark((function e(t){var r,s,a,o,l,p,m,f,v,x,g,b,j,w,y,k,N,S,Z,_,A,C,M,F,E,P;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,d&&d.broadcast){e.next=6;break}return n.error("".concat(tt)),e.abrupt("return");case 6:if(u){e.next=9;break}return n.error("".concat(rt)),e.abrupt("return");case 9:if("owner"===(s=d.permissionLevel.permission.toString())||"active"===s){e.next=13;break}return n.error("permission权限必须是owner或者active"),e.abrupt("return");case 13:return Ye(!0),a=t.pidAuto,o=t.countAuto,l=t.disorderAuto,p=t.startAuto,m=t.endAuto,f=Number(a.split("-")[1]),v=d.actor.toString(),e.next=19,i.load("dfs3protocol");case 19:return x=e.sent,e.next=22,d.client.v1.chain.get_table_rows({code:"dfs3protocol",table:"registry",scope:"dfs3protocol",key_type:"i64",index_position:"secondary",lower_bound:T.zM.from(f),upper_bound:T.zM.from(f),limit:1e3});case 22:return g=e.sent,b=g.rows,j=x.table("projects"),e.next=27,j.all({scope:"dfs3protocol",from:f,to:f});case 27:if(w=e.sent,y=w[0].init_nft_price.value,k=w[0].init_nft_price.symbol.name,N=w[0].sec_per_round.toNumber(),S=w[0].last_round.toString(),S=I().utc(S).local().format("YYYY-MM-DDTHH:mm:ss"),Z=I()(S).add(N,"seconds").format("YYYY-MM-DDTHH:mm:ss"),"DFS"===k||"USDT"===k||"ORDI"===k){e.next=38;break}return n.error("不支持当前项目"),Ye(!1),e.abrupt("return");case 38:if(!(p>b.length)){e.next=42;break}return n.error("开始序号超过当前项目最大值".concat(b.length)),Ye(!1),e.abrupt("return");case 42:if(!m){e.next=51;break}if(!(p>m)){e.next=47;break}return n.error("开始序号超过结束序号"),Ye(!1),e.abrupt("return");case 47:_=b.length>m?m:b.length,b=b.slice(p-1,_),e.next=52;break;case 51:b=b.slice(p-1);case 52:A=0,C=0,l&&b.sort((function(){return Math.random()-.5})),M=0;case 56:if(!(M<b.length)){e.next=73;break}if(F=b[M].owner,E=Number(b[M].current_price.split(" ")[0]),F!==v){e.next=61;break}return e.abrupt("continue",70);case 61:if(!(E>=2*y)){e.next=63;break}return e.abrupt("continue",70);case 63:if(!(A>=o)){e.next=65;break}return e.abrupt("break",73);case 65:if(!(A>=3e3)){e.next=67;break}return e.abrupt("break",73);case 67:A+=1,C+=E;case 70:++M,e.next=56;break;case 73:return P=z.includes(v)?C.toFixed(8)+" "+k:(1.005*C).toFixed(8)+" "+k,null===(r=ot.current)||void 0===r||r.setFieldValue("amountAuto",P),xe(Z),lt(S,N),st.current=!1,Ge(!0),Ye(!1),e.abrupt("return",!0);case 83:e.prev=83,e.t0=e.catch(0),Ye(!1),(0,h.Tv)(e.t0,n);case 87:case"end":return e.stop()}}),e,null,[[0,83]])})));return function(t){return e.apply(this,arguments)}}(),[lt,u,i,d,z]),mt=(0,q.useCallback)((function(){var e,t=nt.current;if(0===t.length)return n.error(et),console.log(et),!1;var r=null===(e=ot.current)||void 0===e?void 0:e.getFieldsValue(),s=r.disorderAuto,a=r.repeatAuto,o=r.intervalAuto,i=r.loop;try{s?t.sort((function(){return Math.random()-.5})):t.sort((function(e,t){return e.cid-t.cid})),console.log("handleCountDownFinishAuto",I()().format()),O.push({position:"handleCountDownFinishAuto",time:I()().format()}),dt(t);for(var c=1;c<a;c++)(0,R.iK)(dt,o*c,t);return i&&(ct.current=!0,(0,R.gr)(it.current),it.current=(0,R.iK)((function(){var e;return null===(e=ot.current)||void 0===e?void 0:e.submit()}),6e5)),!0}catch(e){(0,h.Tv)(e,n)}}),[pe,dt]),ft=(0,q.useCallback)((function(){var e;null===(e=ot.current)||void 0===e||e.resetFields(),G(0),W(0),te(0),ae(0),me([]),xe(""),ke(0),be(0),at.current={},De({}),Me({}),ue(0),ut(),st.current=!1,ct.current=!0}),[ut]),ht=(0,q.useCallback)(function(){var t=l()(c()().mark((function t(r){var s,a,o,i,u,l,d,p,m,v;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.load("dfs3protocol");case 3:return a=t.sent,o=a.table("projects"),i=a.table("stat"),t.next=8,o.all({scope:"dfs3protocol"});case 8:return u=t.sent,t.next=11,i.all({scope:"dfs3protocol"});case 11:return l=t.sent,t.next=14,P().get("https://api.dfs.land/dfschain/pppvolume2");case 14:200!==(d=t.sent).status&&n.error("获取pppvolume2数据失败"),p=d.data,m=[],u.forEach((function(e){p.hasOwnProperty(e.id.toString())&&m.push(e)})),m.sort((function(e,t){var r=e.id.toString(),n=t.id.toString();return p[n].volume_24h-p[r].volume_24h})),v={},m.forEach((function(e){var t=e.nft_img,r=e.id.toString(),n=e.project_name,s=e.creator.toString();v["pid-"+r]="".concat(r,"-").concat(n,"-").concat(s,"-").concat(t)})),null===(s=ot.current)||void 0===s||s.setFieldValue("pidAuto",""),e(f.N.setValueEnum(v)),e(f.N.setStats(l)),We(!1),t.next=32;break;case 28:t.prev=28,t.t0=t.catch(0),We(!1),(0,h.Tv)(t.t0,n);case 32:case"end":return t.stop()}}),t,null,[[0,28]])})));return function(e){return t.apply(this,arguments)}}(),[]),vt=(0,q.useCallback)((function(){return d&&d.broadcast?u?(We(!0),void ht(i)):(n.error("".concat(rt)),!1):(n.error("".concat(tt)),!1)}),[d,u,ht,i]),xt=(0,q.useCallback)(l()(c()().mark((function e(){var t,r,s,a;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pe.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,qe(!0),t={},e.next=7,d.client.v1.chain.get_table_rows({code:"dfs3protocol",table:"registry",scope:"dfs3protocol",key_type:"i64",index_position:"secondary",lower_bound:T.zM.from(Ce.pid),upper_bound:T.zM.from(Ce.pid),limit:1e3});case 7:r=e.sent,s=r.rows,a=0,pe.forEach((function(e){var r=e.from,n=e.cid;s.filter((function(t){return t.cid===e.cid}))[0].owner===r?(t[n]="success",a+=1):t[n]="default"})),ue(a),De(t),qe(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),qe(!1),(0,h.Tv)(e.t0,n);case 20:case"end":return e.stop()}}),e,null,[[2,16]])}))),[i,n,Ce,pe,d]),gt=(0,q.useCallback)((function(e){if(e.hasOwnProperty("countAuto")){var t,r=null===(t=ot.current)||void 0===t?void 0:t.getFieldValue("pidAuto");if(!r)return;var s,a=e.countAuto,o=r.split("-")[1],i=L.filter((function(e){return e.cid.toString()===o}))[0].supply.toNumber();if(a>i)return n.error("购买数量超过当前项目最大值".concat(i)),void(null===(s=ot.current)||void 0===s||s.setFieldValue("startAuto",1))}}),[L,n]),bt=(0,q.useCallback)(l()(c()().mark((function e(){var t,r,a,l,m,f,v,x,g,b,j,w,y,k,N,S,Z,_,A,C,M,F,P,D,L,q,R,V,O,Y,U,H,$,K,J,B,X,Q,ee,re,ne,se,oe,ie,ce,le,de,pe,fe,he,ve,xe,ge,be,je,we,ye;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,d&&d.broadcast){e.next=7;break}return n.error("".concat(tt)),console.log(tt),e.abrupt("return");case 7:if(u){e.next=11;break}return n.error("".concat(rt)),console.log(rt),e.abrupt("return");case 11:if("owner"===(a=d.permissionLevel.permission.toString())||"active"===a){e.next=16;break}return n.error("permission权限必须是owner或者active"),console.log("permission权限必须是owner或者active"),e.abrupt("return");case 16:return Ye(!0),l=null===(t=ot.current)||void 0===t?void 0:t.getFieldsValue(),m=l.pidAuto,f=l.countAuto,v=l.disorderAuto,x=l.startAuto,g=l.endAuto,b=Number(m.split("-")[1]),j=d.actor.toString(),e.next=22,i.load("dfs3protocol");case 22:return w=e.sent,e.next=25,d.client.v1.chain.get_table_rows({code:"dfs3protocol",table:"registry",scope:"dfs3protocol",key_type:"i64",index_position:"secondary",lower_bound:T.zM.from(b),upper_bound:T.zM.from(b),limit:1e3});case 25:return y=e.sent,k=y.rows,N=w.table("projects"),e.next=30,N.all({scope:"dfs3protocol",from:b,to:b});case 30:if(S=e.sent,Z=S[0].creator.toString(),_=S[0].nft_name.toString(),A=S[0].project_name,C=S[0].init_nft_price.value,M=S[0].init_nft_price.symbol.name,F="","DFS"!==M){e.next=41;break}F="eosio.token",e.next=53;break;case 41:if("USDT"!==M){e.next=45;break}F="usdtusdtusdt",e.next=53;break;case 45:if("ORDI"!==M){e.next=49;break}F="ordiordiordi",e.next=53;break;case 49:return n.error("不支持当前项目"),Ye(!1),console.log("不支持当前项目"),e.abrupt("return");case 53:if(!(x>k.length)){e.next=58;break}return n.error("开始序号超过当前项目最大值".concat(k.length)),Ye(!1),console.log("开始序号超过当前项目最大值".concat(k.length)),e.abrupt("return");case 58:if(!g){e.next=67;break}if(!(x>g)){e.next=63;break}return n.error("开始序号超过结束序号"),Ye(!1),e.abrupt("return");case 63:P=k.length>g?g:k.length,k=k.slice(x-1,P),e.next=68;break;case 67:k=k.slice(x-1);case 68:return D={account:"dfsfreecpu11",name:"freecpu",authorization:[{actor:"dfs.service",permission:"cpu"},d.permissionLevel],data:h._9.from({user:j})},L=T.aU.from(D),e.next=72,d.client.v1.chain.get_info();case 72:q=e.sent,R=q.getTransactionHeader(),V=I()(),O=[],Y={},U=0,H="",$=0,v&&k.sort((function(){return Math.random()-.5})),K=0;case 82:if(!(K<k.length)){e.next=130;break}if(J=k[K].owner,B=Number(k[K].current_price.split(" ")[0]),J!==j){e.next=87;break}return e.abrupt("continue",127);case 87:if(!(B>=2*C)){e.next=89;break}return e.abrupt("continue",127);case 89:if(!(U>=f)){e.next=91;break}return e.abrupt("break",130);case 91:if(!(U>=3e3)){e.next=93;break}return e.abrupt("break",130);case 93:return H=I()(V).add(3600-U++,"seconds").utc().format("YYYY-MM-DDTHH:mm:ss"),X=k[K].current_price,Q=T.xR.from(X),ee=Q.value,re=Q.symbol,ne=T.xR.from(.005*ee,re),se="buy:"+k[K].id.toString(),$+=ee,oe={account:F,name:"transfer",authorization:[d.permissionLevel],data:h.FE.from({from:j,to:"dfs3protocol",quantity:X,memo:se})},ie=T.aU.from(oe),ce={account:F,name:"transfer",authorization:[d.permissionLevel],data:h.FE.from({from:j,to:"davidaccount",quantity:ne,memo:"fee"})},le=T.aU.from(ce),de=void 0,pe=void 0,fe=[],he=z.includes(j)?[L,ie]:[L,ie,le],de=T.YW.from(o()(o()({},R),{},{expiration:H,actions:he})),fe[0]=E.signDigest(de.signingDigest(d.chain.id.toString())),e.next=113,(0,h.zI)(d.transact({transaction:de},{broadcast:!1,transactPlugins:[]}));case 113:if(ve=e.sent,xe=p()(ve,2),ge=xe[0],be=xe[1],!ge){e.next=122;break}return n.error(ge),Ye(!1),console.log(ge),e.abrupt("return");case 122:pe=T.uQ.from(o()(o()({},de),{},{signatures:[].concat(fe,s()(be.signatures))})),je=k[K].cid,we=k[K].id,Y[je]={status:"default",message:""},O.push({signedTransaction:pe,cid:je,nftid:we,amount:ee,from:j});case 127:++K,e.next=82;break;case 130:ye=z.includes(j)?$.toFixed(8)+" "+M:(1.005*$).toFixed(8)+" "+M,null===(r=ot.current)||void 0===r||r.setFieldValue("amountAuto",ye),at.current=Y,De({}),G(0),W(0),te(0),ae(O.length),me(O),nt.current=O,ue(0),Me({pid:b,creator:Z,nft_name:_,project_name:A}),ue(0),n.success("创建完成"),Ye(!1),console.log("创建完成"),e.next=153;break;case 148:e.prev=148,e.t0=e.catch(0),Ye(!1),(0,h.Tv)(e.t0,n),console.log(e.t0);case 153:case"end":return e.stop()}}),e,null,[[0,148]])}))),[i,d,u,z]),jt=(0,q.useCallback)((function(e){var t;e<18e5&&!st.current&&(st.current=!0,bt());var r=null===(t=ot.current)||void 0===t?void 0:t.getFieldValue("leadTimeAuto");r&&e<r&&ct.current&&(ct.current=!1,dt(nt.current),console.log(I()().format(),"handleCountdownChangeAuto",e),O.push({position:"handleCountdownChangeAuto",time:I()().format(),value:e}))}),[bt,dt]),wt=(0,q.useCallback)((function(){Ge(!1),ke(0),(0,R.gr)(it.current),ct.current=!0}),[]),yt=(0,q.useCallback)((function(){if(Ze){if(u){var e=u.accountName.toString();return!!Y.includes(e)||(Te(!1),!1)}return!0}if(u){var t=u.accountName.toString();return!!Y.includes(t)&&(Te(!0),!0)}return!1}),[u,Ze,Y]),kt=(0,q.useCallback)((function(){var e=I()().format("YYYY-MM-DDTHH:mm:ss"),t=JSON.stringify(O,null,2),r="data:,".concat(t),n=document.createElement("a");n.href=r,n.download="log_".concat(e,".json"),n.click()}),[]),Nt=(0,q.useCallback)((function(){G(0),W(0),te(0),ae(0),me([]),xe(""),ke(0),be(0),at.current={},De({}),Me({}),ue(0),ut(),st.current=!1,ct.current=!0}),[ut]);return(0,q.useEffect)((function(){!i||Object.keys(D).length||$e||(We(!0),ht(i))}),[ht,D,i,$e]),(0,V.jsx)(b._z,{className:"",ghost:!0,children:yt()?(0,V.jsxs)("div",{className:"flex flex-wrap justify-center gap-5",children:[(0,V.jsxs)(j.Z,{title:(0,V.jsx)("div",{className:" font-semibold text-lg hardline",children:"使用说明"}),style:{maxWidth:"500px"},children:[(0,V.jsx)("div",{children:"1. 操作步骤如下："}),(0,V.jsxs)("div",{className:"ml-3",children:['a）进入"工具-简易钱包"页面 ',(0,V.jsx)(v.Z,{})," 导入私钥"," ",(0,V.jsx)(v.Z,{})," 点击右上角钱包图标 ",(0,V.jsx)(v.Z,{})," ","选择账号连接"]}),(0,V.jsxs)("div",{className:"ml-3",children:['b）进入"工具-PPP工具-自动扫货"页面 ',(0,V.jsx)(v.Z,{})," ",'选择"自动交易"表格 ',(0,V.jsx)(v.Z,{})," 选择项目"," ",(0,V.jsx)(v.Z,{})," 输入购买数量 ",(0,V.jsx)(v.Z,{})," ","点击启动按钮"]}),(0,V.jsx)("div",{className:"mt-3",children:"2. 注意事项："}),(0,V.jsx)("div",{className:"ml-3",children:"a）自动交易方式需要用户导入私钥才可以正常执行。私钥只保存在浏览器的数据库中，不会上传到服务器，请评估好风险后再使用。"}),(0,V.jsx)("div",{className:"mt-3",children:"3. 费用说明："}),(0,V.jsx)("div",{className:"ml-3",children:"使用工具抢到的NFT，每个收取0.5%费用。例如工具抢到一个价值为100 DFS的NFT，则工具会收取0.5 DFS作为费用，抢购成功了，才会收取。"})]}),(0,V.jsxs)(j.Z,{title:(0,V.jsxs)("div",{className:" font-semibold text-lg hardline",children:["自动交易",(0,V.jsx)(A.Z,{placement:"topLeft",title:'需要在"工具-简易钱包"页面中导入私钥，然后点击右上角的钱包图标进行连接后，才能正常使用',children:(0,V.jsx)(x.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),style:{maxWidth:"500px"},children:[(0,V.jsxs)(w.A,{formRef:ot,onFinish:pt,onValuesChange:gt,onReset:ft,loading:Oe,disabled:Be,layout:"vertical",initialValues:{disorderAuto:!0,startAuto:1,repeatAuto:10,intervalAuto:1e3,leadTimeAuto:0,loop:!0},submitter:{searchConfig:{submitText:"启动"},render:function(e,t){return[t[1],t[0]]}},children:[(0,V.jsx)(y.Z,{name:"pidAuto",label:(0,V.jsxs)("div",{children:["项目",(0,V.jsx)(g.Z,{spin:$e,className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"},onClick:vt})]}),valueEnum:D,placeholder:"",rules:[{required:!0,whitespace:!0,message:"".concat(Qe),pattern:/^.+$/}],fieldProps:{size:"large",autoFocus:!1,showSearch:!0,onChange:Nt,filterOption:function(e,t){var r=t.label.split("-"),n=p()(r,3),s=n[0],a=n[1],o=n[2];return(s.padStart(3,"0")+a+o).toLowerCase().includes(e.toLowerCase())},optionItemRender:function(e){var t=e.label.split("-"),r=p()(t,4),n=r[0],s=r[1],a=r[2],o=r[3];return(0,V.jsxs)("div",{className:"flex items-center",children:[(0,V.jsx)("div",{className:"mr-2",children:n.padStart(3,"0")}),(0,V.jsx)(C.C,{className:"mr-2",size:"default",src:o}),(0,V.jsxs)("div",{children:[s," @",a]})]})}}}),(0,V.jsx)(k.Z,{label:"购买数量",name:"countAuto",placeholder:"",min:1,rules:[{required:!0,message:"".concat(Qe),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large"}}),(0,V.jsx)(k.Z,{label:(0,V.jsxs)("div",{children:["开始序号#",(0,V.jsx)(A.Z,{placement:"topLeft",title:"从具体某个序号开始进行购买",children:(0,V.jsx)(x.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"startAuto",placeholder:"",min:1,rules:[{required:!0,message:"".concat(Qe),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1}}),(0,V.jsx)(k.Z,{label:(0,V.jsxs)("div",{children:["结束序号#",(0,V.jsx)(A.Z,{placement:"topLeft",title:"只购买当前序号之前的NFT",children:(0,V.jsx)(x.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"endAuto",placeholder:"可选，默认是当前序号的最大值",min:1,rules:[{required:!1,message:"".concat(Qe),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large"}}),(0,V.jsx)(k.Z,{label:(0,V.jsxs)("div",{children:["整体重复发送次数",(0,V.jsx)(A.Z,{placement:"topLeft",title:"整体全部发送完成算一次，这里指定重复次数。重复发送失败了，不会影响金额",children:(0,V.jsx)(x.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"repeatAuto",placeholder:"",min:1,max:20,rules:[{required:!0,message:"".concat(Qe),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:10}}),(0,V.jsx)(k.Z,{label:(0,V.jsxs)("div",{children:["整体重复发送间隔(ms)",(0,V.jsx)(A.Z,{placement:"topLeft",title:"整体全部发送完成算一次，这里指定重复的间隔时间",children:(0,V.jsx)(x.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"intervalAuto",placeholder:"",min:300,rules:[{required:!0,message:"".concat(Qe),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1e3}}),(0,V.jsx)(k.Z,{label:(0,V.jsxs)("div",{children:["提前发送时间(ms)",(0,V.jsx)(A.Z,{placement:"topLeft",title:"在下一轮开始前多少毫秒发送交易",children:(0,V.jsx)(x.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"leadTimeAuto",placeholder:"",max:2e3,min:0,rules:[{required:!0,message:"".concat(Qe),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:0}}),(0,V.jsx)(N.Z,{name:"disorderAuto",label:(0,V.jsxs)("div",{children:["是否乱序",(0,V.jsx)(A.Z,{placement:"topLeft",title:"是否以乱序的方式来发送交易",children:(0,V.jsx)(x.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(Qe),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0}}),(0,V.jsx)(N.Z,{name:"loop",label:(0,V.jsxs)("div",{children:["是否循环运行",(0,V.jsx)(A.Z,{placement:"topLeft",title:"当前轮次运行完后，是否进行下一轮运行",children:(0,V.jsx)(x.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(Qe),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0}}),(0,V.jsx)(S.Z,{name:"amountAuto",label:(0,V.jsxs)("div",{children:["总金额",(0,V.jsx)(A.Z,{placement:"topLeft",title:"此次全部交易所需要的总金额，包含手续费。",children:(0,V.jsx)(x.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0}}),(0,V.jsx)(w.A.Item,{label:(0,V.jsxs)("div",{className:" font-semibold text-lg ",children:[(0,V.jsx)("span",{className:"hardline",children:"倒计时 "}),Ce.pid?"(".concat(Ce.pid,"-").concat(Ce.project_name," @").concat(Ce.creator,")"):""]}),children:(0,V.jsxs)("div",{className:"flex items-center gap-x-5",children:[(0,V.jsx)(m.Z,{className:"text-2xl",value:ye,onFinish:mt,onChange:jt}),(0,V.jsx)("div",{className:"text-xl",children:"".concat(ve)})]})}),(0,V.jsxs)(w.A.Item,{label:(0,V.jsxs)("div",{className:" font-semibold text-lg hardline",children:[(0,V.jsx)("span",{children:"结果 "}),pe.length?"(".concat(pe.length,")"):""]}),children:[(0,V.jsx)("div",{children:"成功：".concat($,"，失败：").concat(B,"，处理中：").concat(ee,"，待处理：").concat(se)}),!!pe.length&&(0,V.jsx)("div",{className:"flex flex-wrap gap-5 mt-3",children:Object.keys(at.current).map((function(e,t){return(0,V.jsx)(M.Z,{color:at.current[e].status,children:"#".concat(e)},t)}))})]}),(0,V.jsxs)(w.A.Item,{label:(0,V.jsx)("div",{className:" font-semibold text-lg hardline",children:(0,V.jsxs)("div",{children:[(0,V.jsx)("span",{children:"校对 "}),pe.length?"(".concat(pe.length,")"):"",(0,V.jsx)(A.Z,{placement:"topLeft",title:"交易结束后，可点击校对按钮，判断交易结果是否跟链上数据匹配",children:(0,V.jsx)(x.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]})}),children:[(0,V.jsx)("div",{children:"拥有：".concat(ce)}),!!pe.length&&(0,V.jsx)("div",{className:"flex flex-wrap gap-5 mt-3",children:Object.keys(Pe).map((function(e,t){return(0,V.jsx)(M.Z,{color:Pe[e],children:"#".concat(e)},t)}))})]})]}),(0,V.jsxs)("div",{className:"mt-2 ",children:[(0,V.jsx)(F.ZP,{type:"primary",className:"mr-2",onClick:wt,children:"停止"}),(0,V.jsx)(F.ZP,{className:"mr-2",loading:ze,onClick:xt,children:"校对"}),(0,V.jsx)(F.ZP,{onClick:kt,children:"日志"}),","]})]}),a]}):(0,V.jsx)("div",{children:"此工具为收费功能，有需要请联系开发者。"})})}},76650:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,s=536870912,a=2*s,o=function(e,t){return function(r){var o=t.get(r),i=void 0===o?r.size:o<a?o+1:0;if(!r.has(i))return e(r,i);if(r.size<s){for(;r.has(i);)i=Math.floor(Math.random()*a);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,c=r(i),u=o(c,i),l=t(u);e.addUniqueNumber=l,e.generateUniqueNumber=u}(t)},51409:function(e,t,r){"use strict";r.d(t,{cv:function(){return a},gr:function(){return o},Zi:function(){return i},iK:function(){return c}});var n=r(76650);const s=((e,t)=>{let r=null;return()=>{if(null!==r)return r;const n=new Blob([t],{type:"application/javascript; charset=utf-8"}),s=URL.createObjectURL(n);return r=e(s),setTimeout((()=>URL.revokeObjectURL(s))),r}})((e=>{const t=new Map([[0,()=>{}]]),r=new Map([[0,()=>{}]]),s=new Map,a=new Worker(e);a.addEventListener("message",(({data:e})=>{if(void 0!==(n=e).method&&"call"===n.method){const{params:{timerId:n,timerType:a}}=e;if("interval"===a){const e=t.get(n);if(void 0===typeof e)throw new Error("The timer is in an undefined state.");if("number"==typeof e){const t=s.get(e);if(void 0===t||t.timerId!==n||t.timerType!==a)throw new Error("The timer is in an undefined state.")}else"function"==typeof e&&e()}else if("timeout"===a){const e=r.get(n);if(void 0===typeof e)throw new Error("The timer is in an undefined state.");if("number"==typeof e){const t=s.get(e);if(void 0===t||t.timerId!==n||t.timerType!==a)throw new Error("The timer is in an undefined state.")}else"function"==typeof e&&(e(),r.delete(n))}}else{if(!(e=>"number"==typeof e.id&&"boolean"==typeof e.result)(e)){const{error:{message:t}}=e;throw new Error(t)}{const{id:n}=e,a=s.get(n);if(void 0===a)throw new Error("The timer is in an undefined state.");const{timerId:o,timerType:i}=a;s.delete(n),"interval"===i?t.delete(o):r.delete(o)}}var n}));return{clearInterval:e=>{if("function"==typeof t.get(e)){const r=(0,n.generateUniqueNumber)(s);s.set(r,{timerId:e,timerType:"interval"}),t.set(e,r),a.postMessage({id:r,method:"clear",params:{timerId:e,timerType:"interval"}})}},clearTimeout:e=>{if("function"==typeof r.get(e)){const t=(0,n.generateUniqueNumber)(s);s.set(t,{timerId:e,timerType:"timeout"}),r.set(e,t),a.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})}},setInterval:(e,r=0,...s)=>{const o=(0,n.generateUniqueNumber)(t);return t.set(o,(()=>{e(...s),"function"==typeof t.get(o)&&a.postMessage({id:null,method:"set",params:{delay:r,now:performance.timeOrigin+performance.now(),timerId:o,timerType:"interval"}})})),a.postMessage({id:null,method:"set",params:{delay:r,now:performance.timeOrigin+performance.now(),timerId:o,timerType:"interval"}}),o},setTimeout:(e,t=0,...s)=>{const o=(0,n.generateUniqueNumber)(r);return r.set(o,(()=>e(...s))),a.postMessage({id:null,method:"set",params:{delay:t,now:performance.timeOrigin+performance.now(),timerId:o,timerType:"timeout"}}),o}}}),'(()=>{"use strict";const e=new Map,t=new Map,r=t=>{const r=e.get(t);return void 0!==r&&(clearTimeout(r),e.delete(t),!0)},s=e=>{const r=t.get(e);return void 0!==r&&(clearTimeout(r),t.delete(e),!0)},o=(e,t)=>{const r=performance.now(),s=e+t-r-performance.timeOrigin;return{expected:r+s,remainingDelay:s}},i=(e,t,r,s)=>{const o=r-performance.now();o>0?e.set(t,setTimeout(i,o,e,t,r,s)):(e.delete(t),postMessage({id:null,method:"call",params:{timerId:t,timerType:s}}))};addEventListener("message",(({data:n})=>{try{if("clear"===n.method){const{id:e,params:{timerId:t,timerType:o}}=n;if("interval"===o)postMessage({id:e,result:r(t)});else{if("timeout"!==o)throw new Error(\'The given type "\'.concat(o,\'" is not supported\'));postMessage({id:e,result:s(t)})}}else{if("set"!==n.method)throw new Error(\'The given method "\'.concat(n.method,\'" is not supported\'));{const{params:{delay:r,now:s,timerId:a,timerType:m}}=n;if("interval"===m)((t,r,s)=>{const{expected:n,remainingDelay:a}=o(t,s);e.set(r,setTimeout(i,a,e,r,n,"interval"))})(r,a,s);else{if("timeout"!==m)throw new Error(\'The given type "\'.concat(m,\'" is not supported\'));((e,r,s)=>{const{expected:n,remainingDelay:a}=o(e,s);t.set(r,setTimeout(i,a,t,r,n,"timeout"))})(r,a,s)}}}}catch(e){postMessage({error:{message:e.message},id:n.id,result:null})}}))})();'),a=e=>s().clearInterval(e),o=e=>s().clearTimeout(e),i=(...e)=>s().setInterval(...e),c=(...e)=>s().setTimeout(...e)}}]);