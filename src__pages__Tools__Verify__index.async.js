"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7510],{46889:function(e,r,t){t.r(r),t.d(r,{default:function(){return q}});var n=t(15009),a=t.n(n),s=t(97857),i=t.n(s),o=t(99289),c=t.n(o),u=t(5574),l=t.n(u),f=t(72004),d=t.n(f),m=t(12444),p=t.n(m),g=t(31996),b=t.n(g),x=t(26037),h=t.n(x),v=t(9783),k=t.n(v),y=t(64119),w=t(11774),S=t(38345),j=t(97269),F=t(5966),P=t(90672),z=t(59530),I=t(80507),M=t(45360),R=t(15867),C=t(62435),Z=t(86074),_=function(e){b()(t,e);var r=h()(t);function t(){return p()(this,t),r.apply(this,arguments)}return d()(t)}(I.AU);k()(_,"abiName","retire"),k()(_,"abiFields",[{name:"quantity",type:I.xR},{name:"memo",type:"string"}]);var q=function(){var e=M.ZP.useMessage(),r=l()(e,2),t=r[0],n=r[1],s=(0,z.useSelector)((function(e){return e.global.session})),o=(0,z.useSelector)((function(e){return e.global.account})),u=(0,C.useRef)(),f=(0,C.useRef)(),d=(0,C.useRef)(),m=(0,C.useState)(""),p=l()(m,2),g=p[0],b=p[1],x=(0,C.useState)(!0),h=l()(x,2),v=h[0],k=h[1],q=(0,z.useIntl)(),A=q.formatMessage({id:"common.intlCopy"}),N=q.formatMessage({id:"verify.intlSignSuccess"}),K=q.formatMessage({id:"verify.intlSignFail"}),V=q.formatMessage({id:"common.intlCopySuccess"}),D=q.formatMessage({id:"common.intlInputException"}),L=q.formatMessage({id:"verify.intlVerifySignature"}),T=q.formatMessage({id:"verify.intlSign"}),E=q.formatMessage({id:"common.intlPleaseConnectWallet"}),U=q.formatMessage({id:"common.intlPleaseConnectNetwork"}),B=q.formatMessage({id:"verify.intlRawInfo"}),Q=q.formatMessage({id:"verify.intlSignInfo"}),W=q.formatMessage({id:"verify.intlVerifyAccount"}),G=q.formatMessage({id:"common.intlResult"}),H=q.formatMessage({id:"verify.intlAccountInfo"}),J=q.formatMessage({id:"verify.intlPublicKey"}),O=(0,C.useCallback)(function(){var e=c()(a()().mark((function e(r){var n,c,f,d,m,p,g,b,x,h,v,k,w;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s&&s.broadcast){e.next=5;break}return t.error("".concat(E)),e.abrupt("return");case 5:if(o){e.next=8;break}return t.error("".concat(U)),e.abrupt("return");case 8:return n={action:{account:"eosio.token",name:"retire",authorization:[s.permissionLevel],data:{quantity:"0.00000000 DFS",memo:r.rawInfo}}},e.next=11,(0,y.zI)(s.transact(n,{broadcast:!1,transactPlugins:[]}));case 11:return c=e.sent,f=l()(c,2),d=f[0],m=f[1],d?t.error(d):m?(g=m.resolved.transaction,b=m.signatures[0],x=I.uQ.from(i()(i()({},g),{},{signatures:[b]})),h=I.f1.fromSigned(x),v=h.packed_context_free_data.toString(),k=h.packed_trx.toString(),w=b+"-"+v+"-"+k,null===(p=u.current)||void 0===p||p.setFieldValue("signInfo",w),t.success("".concat(N))):t.error("".concat(K)),e.abrupt("return",!0);case 17:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),[s,o]),X=(0,C.useCallback)(function(){var e=c()(a()().mark((function e(r){var n,i,o,c,u,f,m,p,g,x,h,v,w,S,j,F,P,z,M,R,C,Z,q,A,N,K,V;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=3;break}return t.error("".concat(E)),e.abrupt("return");case 3:if(i=r.rawInfo,o=r.targetAccount,c=r.signInfo.split("-"),u=c[0],f=c[1],m=c[2],p={signatures:[u],compression:1,packed_context_free_data:f,packed_trx:m},g=I.f1.from(p),x=g.getTransaction(),h=x.actions[0].authorization,v=I.aU.from({account:"eosio.token",name:"retire",authorization:h,data:_.from({quantity:"0.00000000 DFS",memo:i})}),x.actions[0]=v,w=x.signingDigest(s.chain.id),S=I.Pc.from(u),j=S.recoverDigest(w),F=j.toLegacyString(),P=j.toString(),z=h[0].actor.toString(),M=h[0].permission.toString(),R=!1,null===(n=d.current)||void 0===n||n.setFieldsValue({accountInfo:h[0].toString(),publicKey1:F,publicKey2:P}),o!==z){e.next=51;break}return e.next=27,(0,y.zI)(s.client.v1.chain.get_account(z));case 27:if(C=e.sent,Z=l()(C,2),q=Z[0],A=Z[1],!q){e.next=35;break}t.error(q),e.next=51;break;case 35:N=0;case 36:if(!(N<A.permissions.length)){e.next=51;break}if(A.permissions[N].perm_name.toString()!==M){e.next=48;break}K=A.permissions[N].required_auth.keys,V=0;case 41:if(!(V<K.length)){e.next=48;break}if(K[V].key.toString()!==F&&K[V].key.toString()!==P){e.next=45;break}return R=!0,e.abrupt("break",48);case 45:V++,e.next=41;break;case 48:N++,e.next=36;break;case 51:return b(R?"":"error"),k(!1),setTimeout((function(){var e;null===(e=d.current)||void 0===e||e.validateFields()}),100),e.abrupt("return",!0);case 55:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),[s]),Y=(0,C.useCallback)((function(){var e,r;null===(e=f.current)||void 0===e||e.resetFields(),null===(r=d.current)||void 0===r||r.resetFields(),k(!0),b("")}),[]),$=(0,C.useCallback)(c()(a()().mark((function e(){var r,n;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null===(r=u.current)||void 0===r?void 0:r.getFieldValue("signInfo"),e.next=3,window.navigator.clipboard.writeText(n);case 3:t.success("".concat(V));case 4:case"end":return e.stop()}}),e)}))),[]);return(0,Z.jsxs)(w._z,{className:"verify",ghost:!0,children:[(0,Z.jsxs)("div",{className:"flex justify-evenly flex-wrap items-start",children:[(0,Z.jsxs)(S.Z,{className:"mb-4",title:(0,Z.jsx)("div",{className:" font-semibold text-lg hardline",children:L}),style:{width:"450px"},bodyStyle:{paddingBlockEnd:"0px"},children:[(0,Z.jsxs)(j.A,{formRef:f,onFinish:function(){var e=c()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X(r));case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),onReset:Y,children:[(0,Z.jsx)(F.Z,{name:"rawInfo",label:B,fieldProps:{size:"large",autoFocus:!1},rules:[{required:!0,whitespace:!0,message:"".concat(D)}]}),(0,Z.jsx)(P.Z,{name:"signInfo",label:Q,fieldProps:{autoSize:{minRows:7},autoFocus:!1,allowClear:!0,size:"large"},rules:[{required:!0,whitespace:!0,message:"".concat(D)}]}),(0,Z.jsx)(F.Z,{name:"targetAccount",label:W,fieldProps:{size:"large",autoFocus:!1},rules:[{required:!0,whitespace:!0,message:"".concat(D)}]})]}),(0,Z.jsx)("div",{className:" font-semibold text-lg hardline mb-[16px] mt-[24px]",children:G}),(0,Z.jsxs)(j.A,{formRef:d,submitter:!1,children:[(0,Z.jsx)(F.Z,{name:"accountInfo",label:H,placeholder:"",disabled:v,fieldProps:{size:"large",autoFocus:!1,allowClear:!1,status:g},rules:[{required:!0,whitespace:!0,validator:function(){return"error"===g?Promise.reject():Promise.resolve()}}],hasFeedback:!0}),(0,Z.jsx)(P.Z,{name:"publicKey1",label:"".concat(J)+"(Legacy)",placeholder:"",disabled:v,fieldProps:{autoSize:{minRows:3},size:"large",autoFocus:!1,status:g},rules:[{required:!0,whitespace:!0,validator:function(){return"error"===g?Promise.reject():Promise.resolve()}}],hasFeedback:!0}),(0,Z.jsx)(P.Z,{name:"publicKey2",label:J,placeholder:"",status:"error",disabled:v,fieldProps:{autoSize:{minRows:3},size:"large",autoFocus:!1,status:g},rules:[{required:!0,whitespace:!0,validator:function(){return"error"===g?Promise.reject():Promise.resolve()}}],hasFeedback:!0})]})]}),(0,Z.jsx)(S.Z,{title:(0,Z.jsx)("div",{className:" font-semibold text-lg hardline",children:T}),style:{width:"450px"},children:(0,Z.jsxs)(j.A,{formRef:u,onFinish:function(){var e=c()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O(r));case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),submitter:{render:function(e,r){return[r[1],r[0],(0,Z.jsx)(R.ZP,{onClick:$,children:A},"copy")]}},children:[(0,Z.jsx)(F.Z,{name:"rawInfo",label:B,fieldProps:{size:"large",autoFocus:!1},rules:[{required:!0,whitespace:!0,message:"".concat(D)}]}),(0,Z.jsx)(P.Z,{name:"signInfo",disabled:!0,label:Q,placeholder:"",fieldProps:{autoSize:{minRows:7},autoFocus:!1,size:"large"}})]})})]}),n]})}}}]);