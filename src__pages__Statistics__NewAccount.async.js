"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[841],{38585:function(t,e,a){a.r(e),a.d(e,{default:function(){return F}});var r=a(97857),s=a.n(r),n=a(15009),c=a.n(n),i=a(99289),o=a.n(i),l=a(5574),u=a.n(l),d=a(5621),p=a(31120),f=a(64119),m=a(62435),h=a(20701),y=a(11924),g=a(79360),b=a(24770),x=a(79642),k=function(t,e){var a={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(a[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(a[r[s]]=t[r[s]])}return a},v=(0,m.forwardRef)((function(t,e){var a=t.chartRef,r=t.style,s=void 0===r?{height:"inherit"}:r,n=t.className,c=t.loading,i=t.loadingTemplate,o=t.errorTemplate,l=k(t,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),u=(0,y.Z)(h.x1,l),d=u.chart,p=u.container;return(0,m.useEffect)((function(){(0,g.J)(a,d.current)}),[d.current]),(0,m.useImperativeHandle)(e,(function(){return{getChart:function(){return d.current}}})),m.createElement(b.Z,{errorTemplate:o},c&&m.createElement(x.Z,{loadingTemplate:i,theme:t.theme}),m.createElement("div",{className:n,style:s,ref:p}))})),E=a(11774),S=a(38345),M=a(59530),j=a(45360),w=a(57953),A=a(32983),D=a(9669),O=a.n(D),Z=a(55835),N=a(27484),P=a.n(N),I=a(70178),_=a.n(I),T=a(86074);P().extend(_());var F=function(){var t=(0,M.useDispatch)(),e=j.ZP.useMessage(),a=u()(e,2),r=a[0],n=a[1],i=(0,m.useState)(!1),l=u()(i,2),h=l[0],y=l[1],g=(0,M.useSelector)((function(t){return t.statistics.dailyAccountDataSource})),b=(0,M.useSelector)((function(t){return t.statistics.weeklyAccountDataSource})),x=(0,M.useSelector)((function(t){return t.statistics.monthlyAccountDataSource})),k=(0,M.useIntl)(),D=k.formatMessage({id:"statistics.intlMissingData"}),N=k.formatMessage({id:"statistics.intlDailyAccount"}),I=k.formatMessage({id:"statistics.intlDailyAccountSum"}),_=k.formatMessage({id:"statistics.intlWeeklyAccount"}),F=k.formatMessage({id:"statistics.intlWeeklyAccountSum"}),L=k.formatMessage({id:"statistics.intlMonthlyAccount"}),R=k.formatMessage({id:"statistics.intlMonthlyAccountSum"}),C=(0,m.useCallback)(o()(c()().mark((function t(){var e,a,s,n,i,o,l,d,m,h,y,g,b,x,k,v,E,S,M,j,w,A,N,P,I,_,T,F,L;return c()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="eosio:newaccount",a="000d9cae502dd1cc895745e204f83cc892bc4c450f92a03ecd4fe057709853cc",s=(0,Z.js)("md5"),n=a+e,s.update(n),i=s.digest("hex").substring(0,8),o={key:i,chainId:a,account:e,skip:0,lastUpdate:"2020-01-01T01:01:01.000Z",error:!1,data:[]},t.next=9,p.db.txList.where({key:i}).toArray();case 9:(l=t.sent).length&&(o=l[0]),d=[],m=500,h=o.lastUpdate,y=o.skip;case 15:return t.next=18,(0,f.zI)(O().get("https://api2.dfsmoon.com/v2/history/get_actions?track=true&sort=asc&simple=true&noBinary=true&account=".concat(e.split(":")[0],"&after=").concat(h,"&limit=").concat(m,"&filter=").concat(e)));case 18:if(g=t.sent,b=u()(g,2),x=b[0],k=b[1],x||200!==k.status){t.next=65;break}if(v=k.data.simple_actions,E=v.length,S=k.data.total.value,M=1,0!==S){t.next=30;break}return p.db.txList.put(o),t.abrupt("return",o.data);case 30:for(j=0;j<v.length;j++)y<=j&&d.push(v[j]);if(d.length){t.next=34;break}return o.error&&r.error(D),t.abrupt("return",o.data);case 34:w=d.length-1;case 35:if(!(w>0)){t.next=44;break}if(d[w].transaction_id!==d[w-1].transaction_id){t.next=40;break}M+=1,t.next=41;break;case 40:return t.abrupt("break",44);case 41:w--,t.next=35;break;case 44:if(y=M,E!==m){t.next=50;break}A=d[d.length-1].timestamp,h=A,t.next=63;break;case 50:return d.forEach((function(t){o.data.push(t)})),N=d[d.length-1].timestamp,o.lastUpdate=N,o.skip=y,t.next=56,(0,f.zI)(O().get("https://api2.dfsmoon.com/v2/history/get_actions?track=true&simple=true&noBinary=true&account=".concat(e.split(":")[0],"&skip=0&limit=1&filter=").concat(e)));case 56:return P=t.sent,I=u()(P,2),_=I[0],T=I[1],_||200!==T.status?r.error(_):(F=T.data.total.value,o.data.length!==F?(o.error=!0,r.error(D)):o.error=!1),p.db.txList.put(o),t.abrupt("return",o.data);case 63:t.next=69;break;case 65:return d.length&&(d.forEach((function(t){o.data.push(t)})),L=d[d.length-1].timestamp,o.lastUpdate=L,o.skip=y,o.error=!0),p.db.txList.put(o),r.error(x),t.abrupt("return",o.data);case 69:t.next=15;break;case 71:case"end":return t.stop()}}),t)}))),[r]),z=(0,m.useCallback)(o()(c()().mark((function e(){var a,s,n,i,o,l,u,p,m,h;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=[],s=[],n=[],e.next=6,C();case 6:i=e.sent,o={},l={},u={},p=0,m=0,h=0,i.forEach((function(t){var e=P().utc(t.timestamp).local().format().slice(0,10),a=P().utc(t.timestamp).local().format("YYYY-ww"),r=P().utc(t.timestamp).local().format().slice(0,7);o.hasOwnProperty(e)?o[e]+=1:o[e]=1,l.hasOwnProperty(a)?l[a]+=1:l[a]=1,u.hasOwnProperty(r)?u[r]+=1:u[r]=1})),o["2024-01-01"]+=9,l["2024-01"]+=9,u["2024-01"]+=9,Object.keys(o).forEach((function(t){p+=o[t],a.push({day:t,value:o[t],category:N}),a.push({day:t,value:p,category:I})})),Object.keys(l).forEach((function(t){m+=l[t],s.push({day:t,value:l[t],category:_}),s.push({day:t,value:m,category:F})})),Object.keys(u).forEach((function(t){h+=u[t],n.push({day:t,value:u[t],category:L}),n.push({day:t,value:h,category:R})})),t(d.N.setDailyAccountDataSource(a)),t(d.N.setWeeklyAccountDataSource(s)),t(d.N.setMonthlyAccountDataSource(n)),y(!1),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(0),y(!1),(0,f.Tv)(e.t0,r);case 30:case"end":return e.stop()}}),e,null,[[0,26]])}))),[C]),U={data:g,xField:"day",xAxis:{type:"time",mask:"MM-DD"},yField:"value",seriesField:"category",slider:{start:0,end:1},smooth:!0,label:{}},Y={data:b,xField:"day",yField:"value",seriesField:"category",slider:{start:0,end:1},smooth:!0,label:{}},G={data:x,xField:"day",yField:"value",seriesField:"category",slider:{start:0,end:1},smooth:!0,label:{}};return(0,m.useEffect)((function(){g.length?y(!1):y(!0),z()}),[z]),(0,T.jsxs)(E._z,{className:"",ghost:!0,children:[(0,T.jsxs)(w.Z,{size:"large",spinning:h,children:[(0,T.jsx)(S.Z,{className:"mb-3",children:g.length?(0,T.jsx)(v,s()(s()({},U),{},{loading:h})):(0,T.jsx)(A.Z,{image:A.Z.PRESENTED_IMAGE_SIMPLE})}),(0,T.jsx)(S.Z,{className:"mb-3",children:b.length?(0,T.jsx)(v,s()(s()({},Y),{},{loading:h})):(0,T.jsx)(A.Z,{image:A.Z.PRESENTED_IMAGE_SIMPLE})}),(0,T.jsx)(S.Z,{className:"mb-3",children:x.length?(0,T.jsx)(v,s()(s()({},G),{},{loading:h})):(0,T.jsx)(A.Z,{image:A.Z.PRESENTED_IMAGE_SIMPLE})})]}),n]})}}}]);