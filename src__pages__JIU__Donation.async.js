"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8418],{70799:function(t,e,a){a.r(e);var n=a(9783),r=a.n(n),s=a(15009),o=a.n(s),i=a(99289),c=a.n(i),u=a(5574),l=a.n(u),d=a(19064),f=a(51869),p=a(39417),h=a(81876),m=a(31120),x=a(64119),g=a(11774),k=a(38345),b=a(59530),y=a(45360),v=a(2487),w=a(9669),j=a.n(w),S=a(55835),N=a(62435),O=a(86074);e.default=function(){var t=(0,b.useDispatch)(),e=y.ZP.useMessage(),a=l()(e,2),n=a[0],s=a[1],i=(0,b.useNavigate)(),u=(0,b.useSelector)((function(t){return t.global.contractKit})),w=(0,N.useState)(!1),P=l()(w,2),D=P[0],C=P[1],V=(0,b.useSelector)((function(t){return t.jiu.donationDataSource})),E=(0,N.useState)(0),M=l()(E,2),I=M[0],U=M[1],Z=(0,N.useState)(0),_=l()(Z,2),z=_[0],L=_[1],T=(0,b.useIntl)(),A=T.formatMessage({id:"jiu.intlMissingData"}),B=T.formatMessage({id:"jiu.intlDonationRank"}),q=T.formatMessage({id:"jiu.intlDonationUsers"}),F=T.formatMessage({id:"jiu.intlDonationValue"}),$=T.formatMessage({id:"jiu.intlDonationAccount"}),K=(0,N.useCallback)(c()(o()().mark((function t(){var e,a,r,s,i,c,u,d,f,p,h,g,k,b,y,v,w,N,O,P,D,C,V,E,M,I,U,Z,_;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="jiutothemoon",a="000d9cae502dd1cc895745e204f83cc892bc4c450f92a03ecd4fe057709853cc",r=(0,S.js)("md5"),s=a+e,r.update(s),i=r.digest("hex").substring(0,8),c={key:i,chainId:a,account:e,skip:0,lastUpdate:"2020-01-01T01:01:01.000Z",error:!1,data:[]},t.next=9,m.db.txList.where({key:i}).toArray();case 9:(u=t.sent).length&&(c=u[0]),d=[],f=500,p=c.lastUpdate,h=c.skip;case 15:return t.next=18,(0,x.zI)(j().get("https://api2.dfsmoon.com/v2/history/get_actions?track=true&sort=asc&simple=true&noBinary=true&account=".concat(e,"&after=").concat(p,"&limit=").concat(f)));case 18:if(g=t.sent,k=l()(g,2),b=k[0],y=k[1],b||200!==y.status){t.next=65;break}if(v=y.data.simple_actions,w=v.length,N=y.data.total.value,O=1,0!==N){t.next=30;break}return m.db.txList.put(c),t.abrupt("return",c.data);case 30:for(P=0;P<v.length;P++)h<=P&&d.push(v[P]);if(d.length){t.next=34;break}return c.error&&n.error(A),t.abrupt("return",c.data);case 34:D=d.length-1;case 35:if(!(D>0)){t.next=44;break}if(d[D].transaction_id!==d[D-1].transaction_id){t.next=40;break}O+=1,t.next=41;break;case 40:return t.abrupt("break",44);case 41:D--,t.next=35;break;case 44:if(h=O,w!==f){t.next=50;break}C=d[d.length-1].timestamp,p=C,t.next=63;break;case 50:return d.forEach((function(t){c.data.push(t)})),V=d[d.length-1].timestamp,c.lastUpdate=V,c.skip=h,t.next=56,(0,x.zI)(j().get("https://api2.dfsmoon.com/v2/history/get_actions?track=true&simple=true&noBinary=true&account=".concat(e,"&skip=0&limit=1")));case 56:return E=t.sent,M=l()(E,2),I=M[0],U=M[1],I||200!==U.status?n.error(I):(Z=U.data.total.value,c.data.length!==Z?(c.error=!0,n.error(A)):c.error=!1),m.db.txList.put(c),t.abrupt("return",c.data);case 63:t.next=69;break;case 65:return d.length&&(d.forEach((function(t){c.data.push(t)})),_=d[d.length-1].timestamp,c.lastUpdate=_,c.skip=h,c.error=!0),m.db.txList.put(c),n.error(b),t.abrupt("return",c.data);case 69:t.next=15;break;case 71:case"end":return t.stop()}}),t)}))),[n]),R=(0,N.useCallback)(c()(o()().mark((function t(){var e,a,n,r,s,i;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.load("swapswapswap");case 2:return e=t.sent,a=e.table("markets"),t.next=6,a.all();case 6:return n=t.sent,"usdtusdtusdt-USDT",s="eosio.token-DFS",i=[],(r={})["usdtusdtusdt-USDT"]=1,r[s]=(0,x.ri)(n[0].reserve0)/(0,x.ri)(n[0].reserve1),n.forEach((function(t){var e=t.contract0.toString()+"-"+t.sym0.toString().split(",")[1],a=t.contract1.toString()+"-"+t.sym1.toString().split(",")[1],n=(0,x.ri)(t.reserve0),o=(0,x.ri)(t.reserve1);"eosio.token"===t.contract0.toString()?r.hasOwnProperty(a)||(r[a]=n/o*r[s]):"eosio.token"===t.contract1.toString()?r.hasOwnProperty(e)||(r[e]=o/n*r[s]):"usdtusdtusdt"===t.contract0.toString()?r.hasOwnProperty(a)||(r[a]=n/o):"usdtusdtusdt"===t.contract1.toString()?r.hasOwnProperty(e)||(r[e]=o/n):i.push({key0:e,key1:a,value0:n,value1:o})})),i.forEach((function(t){r.hasOwnProperty(t.key0)&&!r.hasOwnProperty(t.key1)?r[t.key1]=t.value0/t.value1*r[t.key0]:!r.hasOwnProperty(t.key0)&&r.hasOwnProperty(t.key1)?r[t.key0]=t.value1/t.value0*r[t.key1]:r.hasOwnProperty(t.key0)||r.hasOwnProperty(t.key1)||(r[t.key0]=0,r[t.key1]=0)})),t.abrupt("return",r);case 16:case"end":return t.stop()}}),t)}))),[u]),Y=(0,N.useCallback)(c()(o()().mark((function e(){var a,s,i,c,u,l,d,f,p,m;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=0,s={},i=[],e.next=6,R();case 6:return c=e.sent,e.next=9,K();case 9:u=e.sent,u.filter((function(t){return"transfer"===t.action&&"jiutothemoon"===t.data.to&&"dfsminingout"!==t.data.from&&"swapswapswap"!==t.data.from&&"jiuoperation"!==t.data.from&&"dfsrefreward"!==t.data.from})).forEach((function(t){var e=t.data.from,n=t.contract,o=t.data.amount,i=t.data.symbol,u=n+"-"+i,l=t.data.quantity.split(" ")[0].split(".")[1].length,d=c[u]*o;s.hasOwnProperty(e)?(s[e].hasOwnProperty(u)?(s[e][u].amount+=o,s[e][u].value+=d):s[e][u]={amount:o,symbol:i,precision:l,value:d},s[e].totalValue+=d,a+=d):(s[e]=r()(r()({},u,{amount:o,symbol:i,precision:l,value:d}),"totalValue",d),a+=d)})),d=c[l="eosio.token-DFS"],s.wangwang1234[l].amount-=100,s.wangwang1234[l].value-=100*d,s.wangwang1234.totalValue-=100*d,a-=100*d,s.coffeeflykof[l].amount-=10,s.coffeeflykof[l].value-=10*d,s.coffeeflykof.totalValue-=10*d,a-=10*d,s.nanjingliuhe[l].amount-=9,s.nanjingliuhe[l].value-=9*d,s.nanjingliuhe.totalValue-=9*d,a-=9*d,f=o()().mark((function t(e){var n,r;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.hasOwnProperty(e)&&(n=/.+-.+/,r=[],Object.keys(s[e]).forEach((function(t){n.test(t)&&r.push(s[e][t])})),i.push({donation:r,totalValue:s[e].totalValue,account:e,ratio:s[e].totalValue/a}));case 1:case"end":return t.stop()}}),t)})),e.t0=o()().keys(s);case 28:if((e.t1=e.t0()).done){e.next=33;break}return p=e.t1.value,e.delegateYield(f(p),"t2",31);case 31:e.next=28;break;case 33:m=i.sort((function(t,e){return e.totalValue-t.totalValue})),t(h.N.setDonationDataSource(m)),U(m.length),L(a),C(!1),e.next=44;break;case 40:e.prev=40,e.t3=e.catch(0),C(!1),(0,x.Tv)(e.t3,n);case 44:case"end":return e.stop()}}),e,null,[[0,40]])}))),[K,R]),G=(0,N.useCallback)((function(t,e){return 1===t?(0,O.jsxs)("div",{className:"flex items-center ml-[-8px] font-semibold text-lg",children:[(0,O.jsx)("img",{src:d,width:"40px"}),e]}):2===t?(0,O.jsxs)("div",{className:"flex items-center ml-[-8px] font-semibold text-lg",children:[(0,O.jsx)("img",{src:p,width:"40px"}),e]}):3===t?(0,O.jsxs)("div",{className:"flex items-center ml-[-8px] font-semibold text-lg",children:[(0,O.jsx)("img",{src:f,width:"40px"}),e]}):"".concat(t,". ")+e}),[]);return(0,N.useEffect)((function(){u?(V.length?C(!1):C(!0),Y()):C(!0)}),[u,Y]),(0,O.jsx)(g._z,{className:"",ghost:!0,children:(0,O.jsx)("div",{className:"flex justify-center",children:(0,O.jsxs)(k.Z,{className:"flex justify-center",title:(0,O.jsx)("div",{className:"text-xl font-semibold",children:B}),headerBordered:!0,headStyle:{justifyContent:"center"},style:{width:"500px"},children:[(0,O.jsxs)("div",{className:"text-base font-semibold",children:[q,"：",I]}),(0,O.jsxs)("div",{className:"text-base font-semibold",children:[F,"：",(0,x.CE)(z,"$")]}),(0,O.jsxs)("div",{className:"text-base font-semibold",children:[$,"：",(0,O.jsx)("span",{className:" cursor-pointer",onClick:function(){return i("/query/account?search=jiutothemoon&tab=info")},children:"jiutothemoon"})]}),(0,O.jsx)(v.Z,{dataSource:V,loading:{spinning:D,size:"large"},renderItem:function(t,e){return(0,O.jsxs)(v.Z.Item,{children:[(0,O.jsx)(v.Z.Item.Meta,{title:G(e+1,t.account),description:(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{children:(0,x.CE)(t.totalValue,"$")}),(0,O.jsxs)("div",{children:[(0,x.CE)(100*t.ratio),"%"]})]})}),(0,O.jsx)("div",{className:"font-semibold",children:t.donation.map((function(t,e){return(0,O.jsx)("div",{style:{textAlign:"right"},children:(0,x.CE)(t.amount)+" "+t.symbol},e)}))})]})}}),s]})})})}},19064:function(t,e,a){t.exports=a.p+"static/one.796dbe39.png"},51869:function(t,e,a){t.exports=a.p+"static/three.1c34dbad.png"},39417:function(t,e,a){t.exports=a.p+"static/two.0435ef4a.png"}}]);