"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[418],{70799:function(e,t,a){a.r(t);var r=a(9783),n=a.n(r),s=a(15009),o=a.n(s),i=a(99289),c=a.n(i),u=a(5574),l=a.n(u),d=a(19064),p=a(51869),f=a(39417),h=a(81876),m=a(31120),x=a(64119),v=a(11774),k=a(38345),b=a(59530),g=a(45360),y=a(2487),j=a(9669),w=a.n(j),S=a(55835),N=a(62435),O=a(86074);t.default=function(){var e=(0,b.useDispatch)(),t=g.ZP.useMessage(),a=l()(t,2),r=a[0],s=a[1],i=(0,b.useNavigate)(),u=(0,b.useSelector)((function(e){return e.global.contractKit})),j=(0,N.useState)(!1),P=l()(j,2),D=P[0],C=P[1],E=(0,b.useSelector)((function(e){return e.jiu.donationDataSource})),V=(0,N.useState)(0),M=l()(V,2),I=M[0],U=M[1],Z=(0,N.useState)(0),_=l()(Z,2),L=_[0],T=_[1],z=(0,b.useIntl)(),A=z.formatMessage({id:"jiu.intlMissingData"}),B=z.formatMessage({id:"jiu.intlDonationRank"}),q=z.formatMessage({id:"jiu.intlDonationUsers"}),F=z.formatMessage({id:"jiu.intlDonationValue"}),$=z.formatMessage({id:"jiu.intlDonationAccount"}),K=(0,N.useCallback)(c()(o()().mark((function e(){var t,a,n,s,i,c,u,d,p,f,h,v,k,b,g,y,j,N,O,P,D,C,E,V,M,I,U,Z,_;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="jiutothemoon",a="000d9cae502dd1cc895745e204f83cc892bc4c450f92a03ecd4fe057709853cc",n=(0,S.js)("md5"),s=a+t,n.update(s),i=n.digest("hex").substring(0,8),c={key:i,chainId:a,account:t,skip:0,lastUpdate:"2020-01-01T01:01:01.000Z",error:!1,data:[]},e.next=9,m.db.txList.where({key:i}).toArray();case 9:(u=e.sent).length&&(c=u[0]),d=[],p=500,f=c.lastUpdate,h=c.skip;case 15:return e.next=18,(0,x.zI)(w().get("https://api2.dfsmoon.com/v2/history/get_actions?track=true&sort=asc&simple=true&noBinary=true&account=".concat(t,"&after=").concat(f,"&limit=").concat(p)));case 18:if(v=e.sent,k=l()(v,2),b=k[0],g=k[1],b||200!==g.status){e.next=65;break}if(y=g.data.simple_actions,j=y.length,N=g.data.total.value,O=1,0!==N){e.next=30;break}return m.db.txList.put(c),e.abrupt("return",c.data);case 30:for(P=0;P<y.length;P++)h<=P&&d.push(y[P]);if(d.length){e.next=34;break}return c.error&&r.error(A),e.abrupt("return",c.data);case 34:D=d.length-1;case 35:if(!(D>0)){e.next=44;break}if(d[D].transaction_id!==d[D-1].transaction_id){e.next=40;break}O+=1,e.next=41;break;case 40:return e.abrupt("break",44);case 41:D--,e.next=35;break;case 44:if(h=O,j!==p){e.next=50;break}C=d[d.length-1].timestamp,f=C,e.next=63;break;case 50:return d.forEach((function(e){c.data.push(e)})),E=d[d.length-1].timestamp,c.lastUpdate=E,c.skip=h,e.next=56,(0,x.zI)(w().get("https://api2.dfsmoon.com/v2/history/get_actions?track=true&simple=true&noBinary=true&account=".concat(t,"&skip=0&limit=1")));case 56:return V=e.sent,M=l()(V,2),I=M[0],U=M[1],I||200!==U.status?r.error(I):(Z=U.data.total.value,c.data.length!==Z?(c.error=!0,r.error(A)):c.error=!1),m.db.txList.put(c),e.abrupt("return",c.data);case 63:e.next=69;break;case 65:return d.length&&(d.forEach((function(e){c.data.push(e)})),_=d[d.length-1].timestamp,c.lastUpdate=_,c.skip=h,c.error=!0),m.db.txList.put(c),r.error(b),e.abrupt("return",c.data);case 69:e.next=15;break;case 71:case"end":return e.stop()}}),e)}))),[r]),R=(0,N.useCallback)(c()(o()().mark((function e(){var t,a,r,n,s,i;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.load("swapswapswap");case 2:return t=e.sent,a=t.table("markets"),e.next=6,a.all();case 6:return r=e.sent,"usdtusdtusdt-USDT",s="eosio.token-DFS",i=[],(n={})["usdtusdtusdt-USDT"]=1,n[s]=r[0].reserve0.value/r[0].reserve1.value,r.forEach((function(e){var t=e.contract0.toString()+"-"+e.sym0.toString().split(",")[1],a=e.contract1.toString()+"-"+e.sym1.toString().split(",")[1];"eosio.token"===e.contract0.toString()?n.hasOwnProperty(a)||(n[a]=e.reserve0.value/e.reserve1.value*n[s]):"eosio.token"===e.contract1.toString()?n.hasOwnProperty(t)||(n[t]=e.reserve1.value/e.reserve0.value*n[s]):"usdtusdtusdt"===e.contract0.toString()?n.hasOwnProperty(a)||(n[a]=e.reserve0.value/e.reserve1.value):"usdtusdtusdt"===e.contract1.toString()?n.hasOwnProperty(t)||(n[t]=e.reserve1.value/e.reserve0.value):i.push({key0:t,key1:a,value0:e.reserve0.value,value1:e.reserve1.value})})),i.forEach((function(e){n.hasOwnProperty(e.key0)&&!n.hasOwnProperty(e.key1)?n[e.key1]=e.value0/e.value1*n[e.key0]:!n.hasOwnProperty(e.key0)&&n.hasOwnProperty(e.key1)?n[e.key0]=e.value1/e.value0*n[e.key1]:n.hasOwnProperty(e.key0)||n.hasOwnProperty(e.key1)||(n[e.key0]=0,n[e.key1]=0)})),e.abrupt("return",n);case 16:case"end":return e.stop()}}),e)}))),[u]),Y=(0,N.useCallback)(c()(o()().mark((function t(){var a,s,i,c,u,l,d,p;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=0,s={},i=[],t.next=6,R();case 6:return c=t.sent,t.next=9,K();case 9:u=t.sent,u.filter((function(e){return"transfer"===e.action&&"jiutothemoon"===e.data.to&&"dfsminingout"!==e.data.from&&"swapswapswap"!==e.data.from})).forEach((function(e){var t=e.data.from,r=e.contract,o=e.data.amount,i=e.data.symbol,u=r+"-"+i,l=e.data.quantity.split(" ")[0].split(".")[1].length,d=c[u]*o;s.hasOwnProperty(t)?(s[t].hasOwnProperty(u)?(s[t][u].amount+=o,s[t][u].value+=d):s[t][u]={amount:o,symbol:i,precision:l,value:d},s[t].totalValue+=d,a+=d):(s[t]=n()(n()({},u,{amount:o,symbol:i,precision:l,value:d}),"totalValue",d),a+=d)})),l=o()().mark((function e(t){var r,n;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.hasOwnProperty(t)&&(r=/.+-.+/,n=[],Object.keys(s[t]).forEach((function(e){r.test(e)&&n.push(s[t][e])})),i.push({donation:n,totalValue:s[t].totalValue,account:t,ratio:s[t].totalValue/a}));case 1:case"end":return e.stop()}}),e)})),t.t0=o()().keys(s);case 14:if((t.t1=t.t0()).done){t.next=19;break}return d=t.t1.value,t.delegateYield(l(d),"t2",17);case 17:t.next=14;break;case 19:p=i.sort((function(e,t){return t.totalValue-e.totalValue})),e(h.N.setDonationDataSource(p)),U(p.length),T(a),C(!1),t.next=30;break;case 26:t.prev=26,t.t3=t.catch(0),C(!1),(0,x.Tv)(t.t3,r);case 30:case"end":return t.stop()}}),t,null,[[0,26]])}))),[K,R]),G=(0,N.useCallback)((function(e,t){return 1===e?(0,O.jsxs)("div",{className:"flex items-center ml-[-8px] font-semibold text-lg",children:[(0,O.jsx)("img",{src:d,width:"40px"}),t]}):2===e?(0,O.jsxs)("div",{className:"flex items-center ml-[-8px] font-semibold text-lg",children:[(0,O.jsx)("img",{src:f,width:"40px"}),t]}):3===e?(0,O.jsxs)("div",{className:"flex items-center ml-[-8px] font-semibold text-lg",children:[(0,O.jsx)("img",{src:p,width:"40px"}),t]}):"".concat(e,". ")+t}),[]);return(0,N.useEffect)((function(){u?(E.length?C(!1):C(!0),Y()):C(!0)}),[u,Y]),(0,O.jsx)(v._z,{className:"",ghost:!0,children:(0,O.jsx)("div",{className:"flex justify-center",children:(0,O.jsxs)(k.Z,{className:"flex justify-center",title:(0,O.jsx)("div",{className:"text-xl font-semibold",children:B}),headerBordered:!0,headStyle:{justifyContent:"center"},style:{width:"500px"},children:[(0,O.jsxs)("div",{className:"text-base font-semibold",children:[q,"：",I]}),(0,O.jsxs)("div",{className:"text-base font-semibold",children:[F,"：",(0,x.CE)(L,"$")]}),(0,O.jsxs)("div",{className:"text-base font-semibold",children:[$,"：",(0,O.jsx)("span",{className:" cursor-pointer",onClick:function(){return i("/query/account?search=jiutothemoon&tab=info")},children:"jiutothemoon"})]}),(0,O.jsx)(y.Z,{dataSource:E,loading:D,renderItem:function(e,t){return(0,O.jsxs)(y.Z.Item,{children:[(0,O.jsx)(y.Z.Item.Meta,{title:G(t+1,e.account),description:(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{children:(0,x.CE)(e.totalValue,"$")}),(0,O.jsx)("div",{children:(100*e.ratio).toFixed(2)+"%"})]})}),(0,O.jsx)("div",{className:"font-semibold",children:e.donation.map((function(e,t){return(0,O.jsx)("div",{style:{textAlign:"right"},children:(0,x.CE)(e.amount)+" "+e.symbol},t)}))})]})}}),s]})})})}},19064:function(e,t,a){e.exports=a.p+"static/one.796dbe39.png"},51869:function(e,t,a){e.exports=a.p+"static/three.1c34dbad.png"},39417:function(e,t,a){e.exports=a.p+"static/two.0435ef4a.png"}}]);