"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[418],{70799:function(e,t,a){a.r(t);var r=a(9783),n=a.n(r),s=a(15009),o=a.n(s),c=a(99289),u=a.n(c),i=a(5574),l=a.n(i),d=a(81876),f=a(31120),h=a(64119),p=a(11774),v=a(38345),m=a(59530),x=a(45360),k=a(2487),y=a(9669),b=a.n(y),g=a(55835),j=a(62435),w=a(86074);t.default=function(){var e=(0,m.useDispatch)(),t=x.ZP.useMessage(),a=l()(t,2),r=a[0],s=a[1],c=(0,m.useNavigate)(),i=(0,m.useSelector)((function(e){return e.global.contractKit})),y=(0,j.useState)(!1),S=l()(y,2),O=S[0],P=S[1],D=(0,m.useSelector)((function(e){return e.jiu.donationDataSource})),N=(0,j.useState)(0),C=l()(N,2),E=C[0],V=C[1],M=(0,j.useState)(0),I=l()(M,2),Z=I[0],A=I[1],F=(0,m.useIntl)(),L=F.formatMessage({id:"jiu.intlMissingData"}),T=F.formatMessage({id:"jiu.intlDonationRank"}),U=F.formatMessage({id:"jiu.intlDonationUsers"}),_=F.formatMessage({id:"jiu.intlDonationValue"}),q=F.formatMessage({id:"jiu.intlDonationAccount"}),z=(0,j.useCallback)(u()(o()().mark((function e(){var t,a,n,s,c,u,i,d,p,v,m,x,k,y;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,g.js)("md5"),"000d9cae502dd1cc895745e204f83cc892bc4c450f92a03ecd4fe057709853ccjiutothemoon",t.update("000d9cae502dd1cc895745e204f83cc892bc4c450f92a03ecd4fe057709853ccjiutothemoon"),a=t.digest("hex").substring(0,8),n={key:a,chainId:"000d9cae502dd1cc895745e204f83cc892bc4c450f92a03ecd4fe057709853cc",account:"jiutothemoon",skip:0,error:!1,data:[]},e.next=7,f.db.txList.where({key:a}).toArray();case 7:if(!(s=e.sent).length){e.next=13;break}if(n=s[0],!s.error){e.next=13;break}return r.error(L),e.abrupt("return",n.data);case 13:c=[],u=100,i=n.skip;case 16:return e.next=19,(0,h.zI)(b().get("https://api2.dfsmoon.com/v2/history/get_actions?track=true&sort=asc&simple=true&noBinary=true&account=jiutothemoon&skip=".concat(i,"&limit=").concat(u)));case 19:if(d=e.sent,p=l()(d,2),v=p[0],m=p[1],v||200!==m.status){e.next=44;break}if(x=m.data.total.value,k=m.data.simple_actions,y=k.length,0!==x){e.next=30;break}return f.db.txList.put(n),e.abrupt("return",n.data);case 30:if(x!==n.data.length){e.next=32;break}return e.abrupt("return",n.data);case 32:if(k.forEach((function(e){c.push(e)})),y!==u){e.next=37;break}i+=u,e.next=42;break;case 37:return c.forEach((function(e){n.data.push(e)})),n.skip=i+y+1,n.data.length!==x&&(n.error=!0,r.error(L)),f.db.txList.put(n),e.abrupt("return",n.data);case 42:e.next=46;break;case 44:return r.error(v),e.abrupt("return",n.data);case 46:e.next=16;break;case 48:case"end":return e.stop()}}),e)}))),[r]),B=(0,j.useCallback)(u()(o()().mark((function e(){var t,a,r,n,s,c;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.load("swapswapswap");case 2:return t=e.sent,a=t.table("markets"),e.next=6,a.all();case 6:return r=e.sent,"usdtusdtusdt-USDT",s="eosio.token-DFS",c=[],(n={})["usdtusdtusdt-USDT"]=1,n[s]=r[0].reserve0.value/r[0].reserve1.value,r.forEach((function(e){var t=e.contract0.toString()+"-"+e.sym0.toString().split(",")[1],a=e.contract1.toString()+"-"+e.sym1.toString().split(",")[1];"eosio.token"===e.contract0.toString()?n.hasOwnProperty(a)||(n[a]=e.reserve0.value/e.reserve1.value*n[s]):"eosio.token"===e.contract1.toString()?n.hasOwnProperty(t)||(n[t]=e.reserve1.value/e.reserve0.value*n[s]):"usdtusdtusdt"===e.contract0.toString()?n.hasOwnProperty(a)||(n[a]=e.reserve0.value/e.reserve1.value):"usdtusdtusdt"===e.contract1.toString()?n.hasOwnProperty(t)||(n[t]=e.reserve1.value/e.reserve0.value):c.push({key0:t,key1:a,value0:e.reserve0.value,value1:e.reserve1.value})})),c.forEach((function(e){n.hasOwnProperty(e.key0)&&!n.hasOwnProperty(e.key1)?n[e.key1]=e.value0/e.value1*n[e.key0]:!n.hasOwnProperty(e.key0)&&n.hasOwnProperty(e.key1)?n[e.key0]=e.value1/e.value0*n[e.key1]:n.hasOwnProperty(e.key0)||n.hasOwnProperty(e.key1)||(n[e.key0]=0,n[e.key1]=0)})),e.abrupt("return",n);case 16:case"end":return e.stop()}}),e)}))),[i]),$=(0,j.useCallback)(u()(o()().mark((function t(){var a,s,c,u,i,l,f,p;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=0,s={},c=[],t.next=6,B();case 6:return u=t.sent,t.next=9,z();case 9:i=t.sent,i.filter((function(e){return"transfer"===e.action&&"jiutothemoon"===e.data.to&&"dfsminingout"!==e.data.from&&"swapswapswap"!==e.data.from})).forEach((function(e){var t=e.data.from,r=e.contract,o=e.data.amount,c=e.data.symbol,i=r+"-"+c,l=e.data.quantity.split(" ")[0].split(".")[1].length,d=u[i]*o;s.hasOwnProperty(t)?(s[t].hasOwnProperty(i)?(s[t][i].amount+=o,s[t][i].value+=d):s[t][i]={amount:o,symbol:c,precision:l,value:d},s[t].totalValue+=d,a+=d):(s[t]=n()(n()({},i,{amount:o,symbol:c,precision:l,value:d}),"totalValue",d),a+=d)})),l=o()().mark((function e(t){var r,n;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.hasOwnProperty(t)&&(r=/.+-.+/,n=[],Object.keys(s[t]).forEach((function(e){r.test(e)&&n.push(s[t][e])})),c.push({donation:n,totalValue:s[t].totalValue,account:t,ratio:s[t].totalValue/a}));case 1:case"end":return e.stop()}}),e)})),t.t0=o()().keys(s);case 14:if((t.t1=t.t0()).done){t.next=19;break}return f=t.t1.value,t.delegateYield(l(f),"t2",17);case 17:t.next=14;break;case 19:p=c.sort((function(e,t){return t.totalValue-e.totalValue})),e(d.N.setDonationDataSource(p)),V(p.length),A(a),P(!1),t.next=30;break;case 26:t.prev=26,t.t3=t.catch(0),P(!1),(0,h.Tv)(t.t3,r);case 30:case"end":return t.stop()}}),t,null,[[0,26]])}))),[z,B]);return(0,j.useEffect)((function(){i?(D.length?P(!1):P(!0),$()):P(!0)}),[i,$]),(0,w.jsx)(p._z,{className:"",ghost:!0,children:(0,w.jsx)("div",{className:"flex justify-center",children:(0,w.jsxs)(v.Z,{className:"flex justify-center",title:(0,w.jsx)("div",{className:"text-xl font-semibold",children:T}),headerBordered:!0,headStyle:{justifyContent:"center"},style:{width:"500px"},children:[(0,w.jsxs)("div",{className:"text-base font-semibold",children:[U,"：",E]}),(0,w.jsxs)("div",{className:"text-base font-semibold",children:[_,"：$",(0,h.CE)(Z)]}),(0,w.jsxs)("div",{className:"text-base font-semibold",children:[q,"：",(0,w.jsx)("span",{className:" cursor-pointer",onClick:function(){return c("/query/account?search=jiutothemoon&tab=info")},children:"jiutothemoon"})]}),(0,w.jsx)(k.Z,{dataSource:D,loading:O,renderItem:function(e,t){return(0,w.jsxs)(k.Z.Item,{children:[(0,w.jsx)(k.Z.Item.Meta,{title:"".concat(t+1,". ")+e.account,description:(0,w.jsxs)("div",{children:[(0,w.jsxs)("div",{children:["$",(0,h.CE)(e.totalValue)]}),(0,w.jsx)("div",{children:(100*e.ratio).toFixed(2)+"%"})]})}),(0,w.jsx)("div",{className:"font-semibold",children:e.donation.map((function(e,t){return(0,w.jsx)("div",{style:{textAlign:"right"},children:e.amount.toFixed(e.precision)+" "+e.symbol},t)}))})]})}}),s]})})})}}}]);