"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[418],{70799:function(e,t,a){a.r(t);var n=a(9783),r=a.n(n),s=a(15009),o=a.n(s),i=a(99289),c=a.n(i),u=a(5574),l=a.n(u),d=a(19064),f=a(51869),p=a(39417),h=a(81876),m=a(31120),x=a(64119),v=a(11774),k=a(38345),g=a(59530),b=a(45360),y=a(2487),w=a(9669),j=a.n(w),S=a(55835),N=a(62435),O=a(86074);t.default=function(){var e=(0,g.useDispatch)(),t=b.ZP.useMessage(),a=l()(t,2),n=a[0],s=a[1],i=(0,g.useNavigate)(),u=(0,g.useSelector)((function(e){return e.global.contractKit})),w=(0,N.useState)(!1),P=l()(w,2),D=P[0],C=P[1],V=(0,g.useSelector)((function(e){return e.jiu.donationDataSource})),E=(0,N.useState)(0),M=l()(E,2),I=M[0],U=M[1],Z=(0,N.useState)(0),_=l()(Z,2),L=_[0],T=_[1],z=(0,g.useIntl)(),A=z.formatMessage({id:"jiu.intlMissingData"}),B=z.formatMessage({id:"jiu.intlDonationRank"}),q=z.formatMessage({id:"jiu.intlDonationUsers"}),F=z.formatMessage({id:"jiu.intlDonationValue"}),$=z.formatMessage({id:"jiu.intlDonationAccount"}),K=(0,N.useCallback)(c()(o()().mark((function e(){var t,a,r,s,i,c,u,d,f,p,h,v,k,g,b,y,w,N,O,P,D,C,V,E,M,I,U,Z,_;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="jiutothemoon",a="000d9cae502dd1cc895745e204f83cc892bc4c450f92a03ecd4fe057709853cc",r=(0,S.js)("md5"),s=a+t,r.update(s),i=r.digest("hex").substring(0,8),c={key:i,chainId:a,account:t,skip:0,lastUpdate:"2020-01-01T01:01:01.000Z",error:!1,data:[]},e.next=9,m.db.txList.where({key:i}).toArray();case 9:(u=e.sent).length&&(c=u[0]),d=[],f=500,p=c.lastUpdate,h=c.skip;case 15:return e.next=18,(0,x.zI)(j().get("https://api2.dfsmoon.com/v2/history/get_actions?track=true&sort=asc&simple=true&noBinary=true&account=".concat(t,"&after=").concat(p,"&limit=").concat(f)));case 18:if(v=e.sent,k=l()(v,2),g=k[0],b=k[1],g||200!==b.status){e.next=65;break}if(y=b.data.simple_actions,w=y.length,N=b.data.total.value,O=1,0!==N){e.next=30;break}return m.db.txList.put(c),e.abrupt("return",c.data);case 30:for(P=0;P<y.length;P++)h<=P&&d.push(y[P]);if(d.length){e.next=34;break}return c.error&&n.error(A),e.abrupt("return",c.data);case 34:D=d.length-1;case 35:if(!(D>0)){e.next=44;break}if(d[D].transaction_id!==d[D-1].transaction_id){e.next=40;break}O+=1,e.next=41;break;case 40:return e.abrupt("break",44);case 41:D--,e.next=35;break;case 44:if(h=O,w!==f){e.next=50;break}C=d[d.length-1].timestamp,p=C,e.next=63;break;case 50:return d.forEach((function(e){c.data.push(e)})),V=d[d.length-1].timestamp,c.lastUpdate=V,c.skip=h,e.next=56,(0,x.zI)(j().get("https://api2.dfsmoon.com/v2/history/get_actions?track=true&simple=true&noBinary=true&account=".concat(t,"&skip=0&limit=1")));case 56:return E=e.sent,M=l()(E,2),I=M[0],U=M[1],I||200!==U.status?n.error(I):(Z=U.data.total.value,c.data.length!==Z?(c.error=!0,n.error(A)):c.error=!1),m.db.txList.put(c),e.abrupt("return",c.data);case 63:e.next=69;break;case 65:return d.length&&(d.forEach((function(e){c.data.push(e)})),_=d[d.length-1].timestamp,c.lastUpdate=_,c.skip=h,c.error=!0),m.db.txList.put(c),n.error(g),e.abrupt("return",c.data);case 69:e.next=15;break;case 71:case"end":return e.stop()}}),e)}))),[n]),R=(0,N.useCallback)(c()(o()().mark((function e(){var t,a,n,r,s,i;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.load("swapswapswap");case 2:return t=e.sent,a=t.table("markets"),e.next=6,a.all();case 6:return n=e.sent,"usdtusdtusdt-USDT",s="eosio.token-DFS",i=[],(r={})["usdtusdtusdt-USDT"]=1,r[s]=n[0].reserve0.value/n[0].reserve1.value,n.forEach((function(e){var t=e.contract0.toString()+"-"+e.sym0.toString().split(",")[1],a=e.contract1.toString()+"-"+e.sym1.toString().split(",")[1];"eosio.token"===e.contract0.toString()?r.hasOwnProperty(a)||(r[a]=e.reserve0.value/e.reserve1.value*r[s]):"eosio.token"===e.contract1.toString()?r.hasOwnProperty(t)||(r[t]=e.reserve1.value/e.reserve0.value*r[s]):"usdtusdtusdt"===e.contract0.toString()?r.hasOwnProperty(a)||(r[a]=e.reserve0.value/e.reserve1.value):"usdtusdtusdt"===e.contract1.toString()?r.hasOwnProperty(t)||(r[t]=e.reserve1.value/e.reserve0.value):i.push({key0:t,key1:a,value0:e.reserve0.value,value1:e.reserve1.value})})),i.forEach((function(e){r.hasOwnProperty(e.key0)&&!r.hasOwnProperty(e.key1)?r[e.key1]=e.value0/e.value1*r[e.key0]:!r.hasOwnProperty(e.key0)&&r.hasOwnProperty(e.key1)?r[e.key0]=e.value1/e.value0*r[e.key1]:r.hasOwnProperty(e.key0)||r.hasOwnProperty(e.key1)||(r[e.key0]=0,r[e.key1]=0)})),e.abrupt("return",r);case 16:case"end":return e.stop()}}),e)}))),[u]),Y=(0,N.useCallback)(c()(o()().mark((function t(){var a,s,i,c,u,l,d,f,p,m;return o()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=0,s={},i=[],t.next=6,R();case 6:return c=t.sent,t.next=9,K();case 9:u=t.sent,u.filter((function(e){return"transfer"===e.action&&"jiutothemoon"===e.data.to&&"dfsminingout"!==e.data.from&&"swapswapswap"!==e.data.from})).forEach((function(e){var t=e.data.from,n=e.contract,o=e.data.amount,i=e.data.symbol,u=n+"-"+i,l=e.data.quantity.split(" ")[0].split(".")[1].length,d=c[u]*o;s.hasOwnProperty(t)?(s[t].hasOwnProperty(u)?(s[t][u].amount+=o,s[t][u].value+=d):s[t][u]={amount:o,symbol:i,precision:l,value:d},s[t].totalValue+=d,a+=d):(s[t]=r()(r()({},u,{amount:o,symbol:i,precision:l,value:d}),"totalValue",d),a+=d)})),d=c[l="eosio.token-DFS"],s.wangwang1234[l].amount-=100,s.wangwang1234[l].value-=100*d,s.wangwang1234.totalValue-=100*d,a-=100*d,s.coffeeflykof[l].amount-=10,s.coffeeflykof[l].value-=10*d,s.coffeeflykof.totalValue-=10*d,a-=10*d,s.nanjingliuhe[l].amount-=9,s.nanjingliuhe[l].value-=9*d,s.nanjingliuhe.totalValue-=9*d,a-=9*d,f=o()().mark((function e(t){var n,r;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.hasOwnProperty(t)&&(n=/.+-.+/,r=[],Object.keys(s[t]).forEach((function(e){n.test(e)&&r.push(s[t][e])})),i.push({donation:r,totalValue:s[t].totalValue,account:t,ratio:s[t].totalValue/a}));case 1:case"end":return e.stop()}}),e)})),t.t0=o()().keys(s);case 28:if((t.t1=t.t0()).done){t.next=33;break}return p=t.t1.value,t.delegateYield(f(p),"t2",31);case 31:t.next=28;break;case 33:m=i.sort((function(e,t){return t.totalValue-e.totalValue})),e(h.N.setDonationDataSource(m)),U(m.length),T(a),C(!1),t.next=44;break;case 40:t.prev=40,t.t3=t.catch(0),C(!1),(0,x.Tv)(t.t3,n);case 44:case"end":return t.stop()}}),t,null,[[0,40]])}))),[K,R]),G=(0,N.useCallback)((function(e,t){return 1===e?(0,O.jsxs)("div",{className:"flex items-center ml-[-8px] font-semibold text-lg",children:[(0,O.jsx)("img",{src:d,width:"40px"}),t]}):2===e?(0,O.jsxs)("div",{className:"flex items-center ml-[-8px] font-semibold text-lg",children:[(0,O.jsx)("img",{src:p,width:"40px"}),t]}):3===e?(0,O.jsxs)("div",{className:"flex items-center ml-[-8px] font-semibold text-lg",children:[(0,O.jsx)("img",{src:f,width:"40px"}),t]}):"".concat(e,". ")+t}),[]);return(0,N.useEffect)((function(){u?(V.length?C(!1):C(!0),Y()):C(!0)}),[u,Y]),(0,O.jsx)(v._z,{className:"",ghost:!0,children:(0,O.jsx)("div",{className:"flex justify-center",children:(0,O.jsxs)(k.Z,{className:"flex justify-center",title:(0,O.jsx)("div",{className:"text-xl font-semibold",children:B}),headerBordered:!0,headStyle:{justifyContent:"center"},style:{width:"500px"},children:[(0,O.jsxs)("div",{className:"text-base font-semibold",children:[q,"：",I]}),(0,O.jsxs)("div",{className:"text-base font-semibold",children:[F,"：",(0,x.CE)(L,"$")]}),(0,O.jsxs)("div",{className:"text-base font-semibold",children:[$,"：",(0,O.jsx)("span",{className:" cursor-pointer",onClick:function(){return i("/query/account?search=jiutothemoon&tab=info")},children:"jiutothemoon"})]}),(0,O.jsx)(y.Z,{dataSource:V,loading:D,renderItem:function(e,t){return(0,O.jsxs)(y.Z.Item,{children:[(0,O.jsx)(y.Z.Item.Meta,{title:G(t+1,e.account),description:(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{children:(0,x.CE)(e.totalValue,"$")}),(0,O.jsxs)("div",{children:[(0,x.CE)(100*e.ratio),"%"]})]})}),(0,O.jsx)("div",{className:"font-semibold",children:e.donation.map((function(e,t){return(0,O.jsx)("div",{style:{textAlign:"right"},children:(0,x.CE)(e.amount)+" "+e.symbol},t)}))})]})}}),s]})})})}},19064:function(e,t,a){e.exports=a.p+"static/one.796dbe39.png"},51869:function(e,t,a){e.exports=a.p+"static/three.1c34dbad.png"},39417:function(e,t,a){e.exports=a.p+"static/two.0435ef4a.png"}}]);