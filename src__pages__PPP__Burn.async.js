(self.webpackChunk=self.webpackChunk||[]).push([[8183],{98165:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(87462),a=r(62435),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},o=r(84089),i=function(e,t){return a.createElement(o.Z,(0,n.Z)({},e,{ref:t,icon:s}))};var c=a.forwardRef(i)},63434:function(e,t,r){"use strict";var n=r(1413),a=r(91),s=r(22270),o=r(84567),i=r(62435),c=r(90789),l=r(56499),u=r(86074),d=["options","fieldProps","proFieldProps","valueEnum"],f=i.forwardRef((function(e,t){var r=e.options,o=e.fieldProps,i=e.proFieldProps,c=e.valueEnum,f=(0,a.Z)(e,d);return(0,u.jsx)(l.Z,(0,n.Z)({ref:t,valueType:"checkbox",valueEnum:(0,s.h)(c,void 0),fieldProps:(0,n.Z)({options:r},o),lightProps:(0,n.Z)({labelFormatter:function(){return(0,u.jsx)(l.Z,(0,n.Z)({ref:t,valueType:"checkbox",mode:"read",valueEnum:(0,s.h)(c,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({options:r},o),proFieldProps:i},f))}},f.lightProps),proFieldProps:i},f))})),p=i.forwardRef((function(e,t){var r=e.fieldProps,a=e.children;return(0,u.jsx)(o.Z,(0,n.Z)((0,n.Z)({ref:t},r),{},{children:a}))})),m=(0,c.G)(p,{valuePropName:"checked"});m.Group=f,t.Z=m},64317:function(e,t,r){"use strict";var n=r(1413),a=r(91),s=r(22270),o=r(62435),i=r(66758),c=r(56499),l=r(86074),u=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],d=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],f=function(e,t){var r=e.fieldProps,d=e.children,f=e.params,p=e.proFieldProps,m=e.mode,h=e.valueEnum,v=e.request,x=e.showSearch,g=e.options,b=(0,a.Z)(e,u),j=(0,o.useContext)(i.Z);return(0,l.jsx)(c.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,s.h)(h),request:v,params:f,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({options:g,mode:m,showSearch:x,getPopupContainer:j.getPopupContainer},r),ref:t,proFieldProps:p},b),{},{children:d}))},p=o.forwardRef((function(e,t){var r=e.fieldProps,u=e.children,f=e.params,p=e.proFieldProps,m=e.mode,h=e.valueEnum,v=e.request,x=e.options,g=(0,a.Z)(e,d),b=(0,n.Z)({options:x,mode:m||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},r),j=(0,o.useContext)(i.Z);return(0,l.jsx)(c.Z,(0,n.Z)((0,n.Z)({valueEnum:(0,s.h)(h),request:v,params:f,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,n.Z)({getPopupContainer:j.getPopupContainer},b),ref:t,proFieldProps:p},g),{},{children:u}))})),m=o.forwardRef(f);m.SearchSelect=p,m.displayName="ProFormComponent",t.Z=m},91604:function(e,t,r){"use strict";r.d(t,{Z:function(){return v}});var n=r(1413),a=r(87462),s=r(62435),o={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},i=r(84089),c=function(e,t){return s.createElement(i.Z,(0,a.Z)({},e,{ref:t,icon:o}))};var l=s.forwardRef(c),u=r(28459),d=r(2058),f=r(9105),p=r(90789),m=r(86074),h=s.forwardRef((function(e,t){var r=e.fieldProps,a=e.title,o=void 0===a?"单击或拖动文件到此区域进行上传":a,i=e.icon,c=void 0===i?(0,m.jsx)(l,{}):i,p=e.description,h=void 0===p?"支持单次或批量上传":p,v=e.action,x=e.accept,g=e.onChange,b=e.value,j=e.children,S=e.max,w=e.proFieldProps,y=(0,s.useContext)(u.ZP.ConfigContext),Z=(0,s.useContext)(f.A),C=(null==w?void 0:w.mode)||Z.mode||"edit",k=y.getPrefixCls("upload"),N=(void 0===S||!b||(null==b?void 0:b.length)<S)&&"read"!==C&&!0!==(null==w?void 0:w.readonly);return(0,m.jsxs)(d.Z.Dragger,(0,n.Z)((0,n.Z)({ref:t,name:"files",action:v,accept:x,fileList:b},r),{},{onChange:function(e){null==g||g(e),null!=r&&r.onChange&&(null==r||r.onChange(e))},style:(0,n.Z)((0,n.Z)({},null==r?void 0:r.style),{},{display:N?void 0:"none"}),children:[(0,m.jsx)("p",{className:"".concat(k,"-drag-icon"),children:c}),(0,m.jsx)("p",{className:"".concat(k,"-text"),children:o}),(0,m.jsx)("p",{className:"".concat(k,"-hint"),children:h}),j?(0,m.jsx)("div",{className:"".concat(k,"-extra"),style:{padding:16},children:j}):null]}))})),v=(0,p.G)(h,{getValueFromEvent:function(e){return e.fileList}})},218:function(e,t,r){"use strict";r.d(t,{s:function(){return f}});var n=r(5574),a=r.n(n),s=r(37476),o=r(90672),i=r(59530),c=r(45360),l=r(62435),u=r(86074),d=l.forwardRef((function(e,t){var r=c.ZP.useMessage(),n=a()(r,2),d=n[0],f=n[1],p=(0,l.useRef)(),m=(0,l.useState)(!1),h=a()(m,2),v=h[0],x=h[1],g=(0,l.useState)(""),b=a()(g,2),j=b[0],S=b[1],w=(0,l.useState)(""),y=a()(w,2),Z=y[0],C=y[1],k=(0,i.useIntl)(),N=k.formatMessage({id:"msig.intlPreviewFail"}),_=k.formatMessage({id:"msig.intlClose"}),P=(0,l.useCallback)((function(e){var t=new FileReader;t.readAsText(e.originFileObj),t.onload=function(){try{var r,n=JSON.parse(t.result);if(n)null===(r=p.current)||void 0===r||r.setFieldValue("content",JSON.stringify(n,null,2)),S(JSON.stringify(n,null,2)),C(e.name),x(!0);else d.error("".concat(N))}catch(e){d.error("".concat(N))}}}),[]);return(0,l.useImperativeHandle)(t,(function(){return{handleOpen:P}})),(0,u.jsxs)(s.Y,{formRef:p,title:(0,u.jsx)("div",{className:"mt-3",children:Z}),open:v,onOpenChange:function(e){x(e)},layout:"vertical",width:"700px",modalProps:{style:{top:25}},submitter:{searchConfig:{resetText:_},render:function(e,t){return[t[0]]}},children:[(0,u.jsx)(o.Z,{name:"content",fieldProps:{autoSize:{minRows:5},allowClear:!1,autoFocus:!1,onChange:void 0,value:j,size:"large"}}),f]})})),f=(0,l.memo)(d)},84995:function(e,t,r){"use strict";r.r(t);var n=r(64599),a=r.n(n),s=r(19632),o=r.n(s),i=r(97857),c=r.n(i),l=r(15009),u=r.n(l),d=r(99289),f=r.n(d),p=r(5574),m=r.n(p),h=r(218),v=r(97930),x=r(40956),g=r(64119),b=r(87603),j=r(98165),S=r(25035),w=r(11774),y=r(38345),Z=r(97269),C=r(64317),k=r(63434),N=r(52688),_=r(91604),P=r(31199),F=r(5966),T=r(59530),V=r(80507),E=r(45360),M=r(15867),L=r(7134),O=r(83062),Y=r(66309),R=r(9669),z=r.n(R),H=r(27484),D=r.n(H),q=r(70178),A=r.n(q),I=r(62435),J=r(51409),U=r(86074);D().extend(A());var $=[];t.default=function(){var e=(0,T.useDispatch)(),t=E.ZP.useMessage(),r=m()(t,2),n=r[0],s=r[1],i=(0,T.useSelector)((function(e){return e.global.contractKit})),l=(0,T.useSelector)((function(e){return e.global.account})),d=(0,T.useSelector)((function(e){return e.global.session})),p=(0,T.useSelector)((function(e){return e.global.privateKey})),R=(0,T.useSelector)((function(e){return e.ppp.valueEnum})),H=(0,T.useSelector)((function(e){return e.ppp.projects})),q=(0,T.useSelector)((function(e){return e.ppp.accessAccounts})),A=(0,I.useState)([]),G=m()(A,2),W=G[0],K=G[1],B=(0,I.useState)(0),Q=m()(B,2),X=Q[0],ee=Q[1],te=(0,I.useState)(0),re=m()(te,2),ne=re[0],ae=re[1],se=(0,I.useState)(0),oe=m()(se,2),ie=oe[0],ce=oe[1],le=(0,I.useState)(0),ue=m()(le,2),de=ue[0],fe=ue[1],pe=(0,I.useState)(0),me=m()(pe,2),he=me[0],ve=me[1],xe=(0,I.useState)([]),ge=m()(xe,2),be=ge[0],je=ge[1],Se=(0,I.useState)(0),we=m()(Se,2),ye=we[0],Ze=we[1],Ce=(0,I.useState)(!1),ke=m()(Ce,2),Ne=ke[0],_e=ke[1],Pe=(0,I.useState)({}),Fe=m()(Pe,2),Te=Fe[0],Ve=Fe[1],Ee=(0,I.useState)({}),Me=m()(Ee,2),Le=Me[0],Oe=Me[1],Ye=(0,I.useState)(!1),Re=m()(Ye,2),ze=Re[0],He=Re[1],De=(0,I.useState)(!1),qe=m()(De,2),Ae=qe[0],Ie=qe[1],Je=(0,I.useState)(!1),Ue=m()(Je,2),$e=Ue[0],Ge=Ue[1],We=(0,I.useState)(!1),Ke=m()(We,2),Be=Ke[0],Qe=Ke[1],Xe=(0,I.useState)([]),et=m()(Xe,2),tt=et[0],rt=et[1],nt=(0,T.useIntl)(),at=nt.formatMessage({id:"coffee.inputException"}),st=nt.formatMessage({id:"msig.intlSendTransaction"}),ot=nt.formatMessage({id:"msig.intlSend"}),it=nt.formatMessage({id:"msig.intlUploadFail"}),ct=nt.formatMessage({id:"msig.intlUploadSuccess"}),lt=nt.formatMessage({id:"msig.intlTransactionEmpty"}),ut=nt.formatMessage({id:"common.intlPleaseConnectWallet"}),dt=nt.formatMessage({id:"common.intlPleaseConnectNetwork"}),ft=(0,I.useRef)({}),pt=(0,I.useRef)(),mt=(0,I.useRef)(),ht=(0,I.useRef)(),vt=(0,I.useRef)(!0),xt=(0,I.useCallback)((function(){var e=0,t=0,r=0,n=0;for(var a in ft.current)"success"===ft.current[a].status?t+=1:"error"===ft.current[a].status?r+=1:"processing"===ft.current[a].status?n+=1:"default"===ft.current[a].status&&(e+=1);ee(t),ae(r),ce(n),fe(e)}),[]),gt=(0,I.useCallback)(function(){var e=f()(u()().mark((function e(t){var r,n;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],n=D()().format("YYYY-MM-DDTHH:mm:ss.SSS"),$.push({time:n}),console.log(n),t.forEach((function(e){if("success"!==ft.current[e.cid].status&&"processing"!==ft.current[e.cid].status&&("error"!==ft.current[e.cid].status||!ft.current[e.cid].message.includes("asset not found"))){var t=new Promise((function(t){ft.current[e.cid].status="processing",xt(),d.client.v1.chain.push_transaction(e.signedTransaction).then((function(r){r&&r.processed&&"executed"===r.processed.receipt.status?(ft.current[e.cid].status="success",xt(),t(!0)):("success"!==ft.current[e.cid].status&&(ft.current[e.cid].status="error",$.push({cid:e.cid,error:JSON.stringify(r),pos:"then"}),console.log(r),xt()),t(!1))})).catch((function(r){if("success"!==ft.current[e.cid].status){if(ft.current[e.cid].status="error",xt(),$.push({cid:e.cid,error:JSON.stringify(r),pos:"catch"}),r instanceof Error)if(r.message.includes("eosio_assert_message assertion failure"))r.details[0].message.includes("asset not found")&&(ft.current[e.cid].message="asset not found");console.log(r)}t(!1)}))}));r.push(t)}}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[d,xt]),bt=(0,I.useCallback)(function(){var e=f()(u()().mark((function e(t){var r,a,s,i,f,h,v,x,b,j,S,w,y,Z,C,k,N,_,P,F,T,E,M,L,O,Y,R,z,q,A,I,J,U,$,G,W,K;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,d&&d.broadcast){e.next=6;break}return n.error("".concat(ut)),e.abrupt("return");case 6:if(l){e.next=9;break}return n.error("".concat(dt)),e.abrupt("return");case 9:if("owner"===(r=d.permissionLevel.permission.toString())||"active"===r){e.next=13;break}return n.error("permission权限必须是owner或者active"),e.abrupt("return");case 13:if(Ie(!0),a=t.pidCreate,s=t.burnCreate,i=t.sellCreate,0!==s.length){e.next=18;break}return n.error("请选择图片"),e.abrupt("return");case 18:return f=Number(a.split("-")[1]),h=d.actor.toString(),v=H.filter((function(e){return e.id.toNumber()===f}))[0],x=v.token_per_nft.toString(),b=v.token_per_nft.value,j=v.token_per_nft.symbol.name,S=v.token_per_nft.symbol,w=v.mid.toNumber(),y={account:"dfsfreecpu11",name:"freecpu",authorization:[{actor:"dfs.service",permission:"cpu"},d.permissionLevel],data:g._9.from({user:h})},Z=V.aU.from(y),e.next=30,d.client.v1.chain.get_info();case 30:C=e.sent,k=C.getTransactionHeader(),N=D()(),_=[],P="",F=0,T=u()().mark((function e(t){var r,a,l,f,v,j,S,y,C,T,E,M,L,O,Y,R,z,H;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s[t].split("-"),a=Number(r[0]),l=Number(r[1]),f=tt.filter((function(e){return e.value===s[t]}))[0].time,P=D()(N).add(3600-t,"seconds").utc().format("YYYY-MM-DDTHH:mm:ss"),F+=b,v={account:"dfs3protocol",name:"burn",authorization:[d.permissionLevel],data:g.g_.from({assetid:a})},j=V.aU.from(v),S=x,y="swap:".concat(w,":0"),C={account:"dfsppptokens",name:"transfer",authorization:[d.permissionLevel],data:g.FE.from({from:h,to:"swapswapswap",quantity:S,memo:y})},T=V.aU.from(C),L=[],O=[],O=i?[Z,j,T]:[Z,j],E=V.YW.from(c()(c()({},k),{},{expiration:P,actions:O})),L[0]=p.signDigest(E.signingDigest(d.chain.id.toString())),e.next=19,(0,g.zI)(d.transact({transaction:E},{broadcast:!1,transactPlugins:[]}));case 19:if(Y=e.sent,R=m()(Y,2),z=R[0],H=R[1],!z){e.next=27;break}return n.error(z),Ie(!1),e.abrupt("return",{v:!1});case 27:M=V.uQ.from(c()(c()({},E),{},{signatures:[].concat(L,o()(H.signatures))})),_.push({signedTransaction:M,cid:l,nftid:a,amount:b,from:h,burn_time:f});case 29:case"end":return e.stop()}}),e)})),M=0;case 38:if(!(M<s.length)){e.next=46;break}return e.delegateYield(T(M),"t0",40);case 40:if(!(E=e.t0)){e.next=43;break}return e.abrupt("return",E.v);case 43:++M,e.next=38;break;case 46:return L=D()().format("YYYY-MM-DDTHH:mm:ss"),O=[],Y=[],R=_.length,_.forEach((function(e){O.push(e.cid),Y.push(e.nftid)})),z=v.nft_name,q=v.creator.toString(),A=V.xR.from(F,S).toString(),I=v.project_name,J=D().utc(v.last_round.toString()).local().format("YYYY-MM-DDTHH:mm:ss"),U=v.sec_per_round.toNumber(),$={infos:{type:"burn",pid:f,creator:q,project_name:I,nft_name:z,token_symbol:j,last_round:J,sec_per_round:U,from:h,split:1,disorder:!1,start:_[0].burn_time,end:_[R-1].burn_time,count:R,amount:A,cid_array:O,nftid_array:Y},transactions:_},G=JSON.stringify($,null,2),W="data:,".concat(G),(K=document.createElement("a")).href=W,K.download="".concat(h,"_").concat(f,"_").concat(R,"_").concat(z,"_").concat(q,"_").concat(L,"_burn.json"),K.click(),n.success("创建完成"),Ie(!1),e.abrupt("return",!0);case 69:e.prev=69,e.t1=e.catch(0),Ie(!1),(0,g.Tv)(e.t1,n);case 73:return e.abrupt("return",!0);case 74:case"end":return e.stop()}}),e,null,[[0,69]])})));return function(t){return e.apply(this,arguments)}}(),[i,d,l,H,tt]),jt=(0,I.useCallback)(function(){var e=f()(u()().mark((function e(t){return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==be.length){e.next=3;break}return n.error(lt),e.abrupt("return",!1);case 3:return e.prev=3,gt(be),e.abrupt("return",!0);case 8:e.prev=8,e.t0=e.catch(3),(0,g.Tv)(e.t0,n);case 11:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(t){return e.apply(this,arguments)}}(),[be,gt]),St=(0,I.useCallback)((function(e){var t=D()(e).valueOf();Ze(t)}),[]),wt=(0,I.useCallback)((function(e){var t,r,n=null===(t=mt.current)||void 0===t?void 0:t.getFieldValue("leadTimeSend");n&&e<n&&vt.current&&(vt.current=!1,null===(r=mt.current)||void 0===r||r.submit())}),[]),yt=(0,I.useCallback)((function(){var e;if(null!==(e=mt.current)&&void 0!==e&&e.getFieldValue("auto")){if(0===be.length)return n.error(lt),!1;var t=mt.current.getFieldsValue(),r=t.repeatSend,a=t.intervalSend;try{gt(be);for(var s=1;s<r;s++)(0,J.iK)(gt,a*s,be);return!0}catch(e){(0,g.Tv)(e,n)}}}),[be,gt]),Zt=(0,I.useCallback)(function(){var e=f()(u()().mark((function e(t){var r,s,o,i,c,l,d,f,p,m,h,v,x,b,j,S,w,y,Z,C,k,N,_,P;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=16;break}return ft.current={},Oe({}),ae(0),ee(0),ce(0),fe(0),je([]),Ze(0),Ve({}),ve(0),null===(r=mt.current)||void 0===r||r.setFieldValue("amountSend",""),null===(s=mt.current)||void 0===s||s.setFieldValue("startTime",""),null===(o=mt.current)||void 0===o||o.setFieldValue("endTime",""),vt.current=!0,e.abrupt("return");case 16:e.prev=16,p=[],m=new Set,h=[],v={},x=0,b={infos:{},transactions:[]},j=a()(t),e.prev=24,w=u()().mark((function e(){var t,r;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=S.value,e.next=3,new Promise((function(e){var r=new FileReader;r.readAsText(t.originFileObj),r.onload=function(){return e(r.result)}}));case 3:r=e.sent,(b=JSON.parse(r)).transactions.forEach((function(e){m.has(e.cid)||(h.push(e),m.add(e.cid))}));case 6:case"end":return e.stop()}}),e)})),j.s();case 27:if((S=j.n()).done){e.next=31;break}return e.delegateYield(w(),"t0",29);case 29:e.next=27;break;case 31:e.next=36;break;case 33:e.prev=33,e.t1=e.catch(24),j.e(e.t1);case 36:return e.prev=36,j.f(),e.finish(36);case 39:y=b.infos.start,Z=D()(y).valueOf(),C=b.infos.end,k=D()(C).valueOf(),N=Math.ceil((k-Z)/1e3),St(y),_=b.infos.token_symbol,h.forEach((function(e){var t=V.uQ.from(e.signedTransaction);p.push({cid:e.cid,nftid:e.nftid,amount:e.amount,from:e.from,signedTransaction:t}),v[e.cid]={status:"default",message:""},x+=e.amount})),null===(i=mt.current)||void 0===i||i.setFieldValue("amountSend",x.toFixed(8)+" "+_),null===(c=mt.current)||void 0===c||c.setFieldValue("startTime",y),null===(l=mt.current)||void 0===l||l.setFieldValue("endTime",C),P=N+10+Math.ceil(N/60),null===(d=mt.current)||void 0===d||d.setFieldValue("repeatSend",P),null===(f=mt.current)||void 0===f||f.setFieldValue("intervalSend",1e3),ft.current=v,Oe({}),ae(0),ee(0),ce(0),fe(p.length),je(p),Ve(b.infos),ve(0),vt.current=!0,e.next=68;break;case 65:e.prev=65,e.t2=e.catch(16),(0,g.Tv)(e.t2,n);case 68:case"end":return e.stop()}}),e,null,[[16,65],[24,33,36,39]])})));return function(t){return e.apply(this,arguments)}}(),[St]),Ct=(0,I.useCallback)(function(){var e=f()(u()().mark((function e(t){var r;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("removed"!==t.file.status){e.next=4;break}return K(t.fileList),Zt(t.fileList),e.abrupt("return");case 4:(r=new FileReader).readAsText(t.fileList[t.fileList.length-1].originFileObj),r.onload=function(){try{var e=JSON.parse(r.result);e?e.hasOwnProperty("infos")&&"burn"===e.infos.type?(K(t.fileList),Zt(t.fileList),n.success("".concat(ct))):n.error("文件类型错误"):n.error("".concat(it))}catch(e){(0,g.Tv)(e,n)}};case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[Zt]),kt=(0,I.useCallback)((function(){var e;null===(e=mt.current)||void 0===e||e.resetFields(),K([]),ae(0),ee(0),ce(0),fe(0),je([]),Ze(0),ft.current={},Oe({}),Ve({}),ve(0),xt(),vt.current=!0}),[xt]),Nt=(0,I.useCallback)(function(){var t=f()(u()().mark((function t(r){var a,s,o,i,c,l,d,f,p,m;return u()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.load("dfs3protocol");case 3:return s=t.sent,o=s.table("projects"),i=s.table("stat"),t.next=8,o.all({scope:"dfs3protocol"});case 8:return c=t.sent,t.next=11,i.all({scope:"dfs3protocol"});case 11:return l=t.sent,t.next=14,z().get("https://api.dfs.land/dfschain/pppvolume2");case 14:200!==(d=t.sent).status&&n.error("获取pppvolume2数据失败"),f=d.data,p=[],c.forEach((function(e){f.hasOwnProperty(e.id.toString())&&p.push(e)})),p.sort((function(e,t){var r=e.id.toString(),n=t.id.toString();return f[n].volume_24h-f[r].volume_24h})),m={},p.forEach((function(e){var t=e.nft_img,r=e.id.toString(),n=e.project_name,a=e.creator.toString();m["pid-"+r]="".concat(r,"-").concat(n,"-").concat(a,"-").concat(t)})),null===(a=pt.current)||void 0===a||a.setFieldValue("pidCreate",""),e(x.N.setValueEnum(m)),e(x.N.setProjects(c)),e(x.N.setStats(l)),Qe(!1),t.next=33;break;case 29:t.prev=29,t.t0=t.catch(0),Qe(!1),(0,g.Tv)(t.t0,n);case 33:case"end":return t.stop()}}),t,null,[[0,29]])})));return function(e){return t.apply(this,arguments)}}(),[]),_t=(0,I.useCallback)((function(){return d&&d.broadcast?l?(Qe(!0),void Nt(i)):(n.error("".concat(dt)),!1):(n.error("".concat(ut)),!1)}),[d,l,Nt,i]),Pt=(0,I.useCallback)(f()(u()().mark((function e(){var t,r,a,s,o;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(be.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,He(!0),t={},r=[],a=Te.pid,e.next=9,d.client.v1.chain.get_table_rows({code:"dfs3protocol",table:"registry",scope:"dfs3protocol",key_type:"name",index_position:"tertiary",lower_bound:l.accountName,upper_bound:l.accountName,limit:2e3});case 9:s=e.sent,s.rows.filter((function(e){return e.pid===a})).forEach((function(e){r.push(e.cid)})),o=0,be.forEach((function(e){var n=e.cid;r.includes(n)?t[n]="default":(t[n]="success",o+=1)})),ve(o),Oe(t),He(!1),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(2),He(!1),(0,g.Tv)(e.t0,n);case 23:case"end":return e.stop()}}),e,null,[[2,19]])}))),[i,n,Te,be,d]),Ft=(0,I.useCallback)(function(){var e=f()(u()().mark((function e(t){var r,n,a,s,o,i;return u()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.hasOwnProperty("pidCreate")){e.next=14;break}return Ge(!0),r=Number(t.pidCreate.split("-")[1]),e.next=5,d.client.v1.chain.get_table_rows({code:"dfs3protocol",table:"registry",scope:"dfs3protocol",key_type:"name",index_position:"tertiary",lower_bound:l.accountName,upper_bound:l.accountName,limit:2e3});case 5:n=e.sent,(a=n.rows.filter((function(e){return e.pid===r}))).sort((function(e,t){return e.last_trade.localeCompare(t.last_trade)})),s=H.filter((function(e){return e.id.toNumber()===r}))[0],o=s.sec_to_burn_nft.toNumber(),i=[],a.forEach((function(e){var t=e.id.toString(),r=e.cid.toString(),n=D().utc(e.last_trade).add(o,"seconds").local().format("YYYY-MM-DDTHH:mm:ss");i.push({label:(0,U.jsxs)("div",{className:"flex justify-between w-[300px]",children:[(0,U.jsxs)("div",{children:["#",r]}),(0,U.jsxs)("div",{children:["销毁时间：",n]})]}),value:t+"-"+r,time:n})})),Ge(!1),rt(i);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[l,d,H]),Tt=(0,I.useCallback)((function(){var e,t,r,n=tt.map((function(e){return e.value})),a=null===(e=pt.current)||void 0===e?void 0:e.getFieldValue("burnCreate");n.length===a.length?null===(t=pt.current)||void 0===t||t.setFieldValue("burnCreate",[]):null===(r=pt.current)||void 0===r||r.setFieldValue("burnCreate",n)}),[tt]),Vt=(0,I.useCallback)((function(){if(Ne){if(l){var e=l.accountName.toString();return!!q.includes(e)||(_e(!1),!1)}return!0}if(l){var t=l.accountName.toString();return!!q.includes(t)&&(_e(!0),!0)}return!1}),[l,Ne,q]),Et=(0,I.useCallback)((function(){var e=D()().format("YYYY-MM-DDTHH:mm:ss"),t=JSON.stringify($,null,2),r="data:,".concat(t),n=document.createElement("a");n.href=r,n.download="log_".concat(e,".json"),n.click()}),[]);return(0,I.useEffect)((function(){!i||Object.keys(R).length||Be||(Qe(!0),Nt(i))}),[Nt,R,i,Be]),(0,U.jsx)(w._z,{className:"",ghost:!0,children:Vt()?(0,U.jsxs)("div",{className:"flex flex-wrap justify-center gap-5",children:[(0,U.jsxs)(y.Z,{title:(0,U.jsx)("div",{className:" font-semibold text-lg hardline",children:"使用说明"}),style:{maxWidth:"400px"},children:[(0,U.jsx)("div",{children:"1. 操作步骤如下："}),(0,U.jsxs)("div",{className:"ml-3",children:["连接钱包 ",(0,U.jsx)(b.Z,{})," 创建交易 ",(0,U.jsx)(b.Z,{})," ","发送交易"]}),(0,U.jsxs)("div",{className:"ml-3",children:["创建交易： 选择项目 ",(0,U.jsx)(b.Z,{})," 选择图片"," ",(0,U.jsx)(b.Z,{})," 点击创建按钮 ",(0,U.jsx)(b.Z,{})," ","保存交易文件"]}),(0,U.jsxs)("div",{className:"ml-3",children:["发送交易：上传交易文件 ",(0,U.jsx)(b.Z,{})," 等待倒计时结束"]}),(0,U.jsx)("div",{className:"mt-3",children:"2. 注意事项："}),(0,U.jsx)("div",{className:"ml-3",children:"a）交易文件的有效时间是一个小时，所以要在销毁前一个小时内提前生成；"}),(0,U.jsx)("div",{className:"ml-3",children:"b）交易文件的生成过程中，需要用户重复进行多次签名，虽然繁琐，但很安全，无需用户导入私钥；"}),(0,U.jsx)("div",{className:"mt-3",children:"3. 费用说明："}),(0,U.jsx)("div",{className:"ml-3",children:"免费使用。"})]}),(0,U.jsx)(y.Z,{title:(0,U.jsx)("div",{className:" font-semibold text-lg hardline",children:"创建交易"}),style:{width:"400px"},children:(0,U.jsxs)(Z.A,{formRef:pt,onFinish:bt,onValuesChange:Ft,layout:"vertical",loading:Ae,initialValues:{burnCreate:[],sellCreate:!0},submitter:{searchConfig:{submitText:"创建"},render:function(e,t){return[t[1],(0,U.jsx)(M.ZP,{onClick:Tt,children:"全选"},"all"),t[0]]}},children:[(0,U.jsx)(C.Z,{name:"pidCreate",label:(0,U.jsxs)("div",{children:["项目",(0,U.jsx)(j.Z,{spin:Be,className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"},onClick:_t})]}),valueEnum:R,placeholder:"",rules:[{required:!0,whitespace:!0,message:"".concat(at),pattern:/^.+$/}],fieldProps:{size:"large",autoFocus:!1,showSearch:!0,filterOption:function(e,t){var r=t.label.split("-"),n=m()(r,3),a=n[0],s=n[1],o=n[2];return(a.padStart(3,"0")+s+o).toLowerCase().includes(e.toLowerCase())},optionItemRender:function(e){var t=e.label.split("-"),r=m()(t,4),n=r[0],a=r[1],s=r[2],o=r[3];return(0,U.jsxs)("div",{className:"flex items-center",children:[(0,U.jsx)("div",{className:"mr-2",children:n.padStart(3,"0")}),(0,U.jsx)(L.C,{className:"mr-2",size:"default",src:o}),(0,U.jsxs)("div",{children:[a," @",s]})]})}}}),(0,U.jsx)(k.Z.Group,{name:"burnCreate",label:(0,U.jsxs)("div",{children:[(0,U.jsx)("span",{children:"图片 "}),tt.length?"(".concat(tt.length,")"):"",(0,U.jsx)(j.Z,{spin:$e,className:"ml-[5px]",style:{color:"#1677ff"}})]}),options:tt,rules:[{required:!0,whitespace:!0,message:"".concat(at),pattern:/.*/}]}),(0,U.jsx)(N.Z,{name:"sellCreate",label:(0,U.jsxs)("div",{children:["销毁并卖出",(0,U.jsx)(O.Z,{placement:"topLeft",title:"销毁获得代币后，是否立即卖出",children:(0,U.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(at),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0}}),(0,U.jsx)("div",{className:" text-red-600 text-lg mb-3",children:"注意：交易文件只在一个小时内有效！"})]})}),(0,U.jsx)(y.Z,{title:(0,U.jsx)("div",{className:" font-semibold text-lg hardline",children:st}),style:{width:"400px"},children:(0,U.jsxs)(Z.A,{formRef:mt,onFinish:jt,onReset:kt,submitter:{searchConfig:{submitText:ot},render:function(e,t){return[t[1],(0,U.jsx)(M.ZP,{loading:ze,onClick:Pt,children:"校对"},"check"),(0,U.jsx)(M.ZP,{onClick:Et,children:"日志"},"log"),t[0]]}},initialValues:{disorderSend:!0,auto:!0,repeatSend:10,intervalSend:1e3,leadTimeSend:0},children:[(0,U.jsx)(_.Z,{label:"交易文件",name:"transactionInfo",action:"upload.do",fieldProps:{accept:".json",onChange:Ct,beforeUpload:function(){return!1},listType:"picture",onPreview:function(e){return ht.current.handleOpen(e)},fileList:W,maxCount:1},rules:[{required:!0,whitespace:!0,message:"".concat(at),pattern:/.*/}]}),(0,U.jsx)(P.Z,{label:(0,U.jsxs)("div",{children:["整体重复发送次数",(0,U.jsx)(O.Z,{placement:"topLeft",title:"整体全部发送完成算一次，这里指定重复次数。重复发送失败了，不会影响金额",children:(0,U.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"repeatSend",placeholder:"",min:1,rules:[{required:!0,message:"".concat(at),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:10}}),(0,U.jsx)(P.Z,{label:(0,U.jsxs)("div",{children:["整体重复发送间隔(ms)",(0,U.jsx)(O.Z,{placement:"topLeft",title:"整体全部发送完成算一次，这里指定重复的间隔时间",children:(0,U.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"intervalSend",placeholder:"",min:300,rules:[{required:!0,message:"".concat(at),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:1e3}}),(0,U.jsx)(P.Z,{label:(0,U.jsxs)("div",{children:["提前发送时间(ms)",(0,U.jsx)(O.Z,{placement:"topLeft",title:"在下一轮开始前多少毫秒发送交易",children:(0,U.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),name:"leadTimeSend",placeholder:"",max:2e3,min:0,rules:[{required:!0,message:"".concat(at),whitespace:!0,pattern:/^\d+$/}],fieldProps:{autoFocus:!1,size:"large",defaultValue:0}}),(0,U.jsx)(N.Z,{name:"auto",label:(0,U.jsxs)("div",{children:["是否自动发送",(0,U.jsx)(O.Z,{placement:"topLeft",title:"倒计时结束后，是否自动发送交易。开启与否，不影响手动操作来发",children:(0,U.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),rules:[{required:!0,message:"".concat(at),whitespace:!0,pattern:/^true|false$/}],fieldProps:{autoFocus:!1,defaultValue:!0}}),(0,U.jsx)(F.Z,{name:"startTime",label:(0,U.jsxs)("div",{children:["开始时间",(0,U.jsx)(O.Z,{placement:"topLeft",title:"销毁程序开始时间",children:(0,U.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0}}),(0,U.jsx)(F.Z,{name:"endTime",label:(0,U.jsxs)("div",{children:["结束时间",(0,U.jsx)(O.Z,{placement:"topLeft",title:"销毁程序结束时间",children:(0,U.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]}),placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0}}),(0,U.jsx)(F.Z,{name:"amountSend",label:(0,U.jsx)("div",{children:"销毁所得代币总量"}),placeholder:"自动生成，无需输入",fieldProps:{size:"large",autoFocus:!1,defaultValue:"",readOnly:!0}}),(0,U.jsx)(Z.A.Item,{label:(0,U.jsxs)("div",{className:" font-semibold text-lg ",children:[(0,U.jsx)("span",{className:"hardline",children:"倒计时 "}),Te.pid?"(".concat(Te.pid,"-").concat(Te.project_name," @").concat(Te.creator,")"):""]}),children:(0,U.jsx)("div",{className:"flex items-center gap-x-5",children:(0,U.jsx)(v.Wo,{className:"text-2xl",value:ye,onFinish:yt,onChange:wt})})}),(0,U.jsxs)(Z.A.Item,{label:(0,U.jsxs)("div",{className:" font-semibold text-lg hardline",children:[(0,U.jsx)("span",{children:"结果 "}),be.length?"(".concat(be.length,")"):""]}),children:[(0,U.jsx)("div",{children:"成功：".concat(X,"，失败：").concat(ne,"，处理中：").concat(ie,"，待处理：").concat(de)}),!!be.length&&(0,U.jsx)("div",{className:"flex flex-wrap gap-5 mt-3",children:Object.keys(ft.current).map((function(e,t){return(0,U.jsx)(Y.Z,{color:ft.current[e].status,children:"#".concat(e)},t)}))})]}),(0,U.jsxs)(Z.A.Item,{label:(0,U.jsx)("div",{className:" font-semibold text-lg hardline",children:(0,U.jsxs)("div",{children:[(0,U.jsx)("span",{children:"校对 "}),be.length?"(".concat(be.length,")"):"",(0,U.jsx)(O.Z,{placement:"topLeft",title:"交易结束后，可点击校对按钮，判断交易结果是否跟链上数据匹配",children:(0,U.jsx)(S.Z,{className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"}})})]})}),children:[(0,U.jsx)("div",{children:"拥有：".concat(he)}),!!be.length&&(0,U.jsx)("div",{className:"flex flex-wrap gap-5 mt-3",children:Object.keys(Le).map((function(e,t){return(0,U.jsx)(Y.Z,{color:Le[e],children:"#".concat(e)},t)}))})]})]})}),s,(0,U.jsx)(h.s,{ref:ht})]}):(0,U.jsx)("div",{children:"此工具为收费功能，有需要请联系开发者。"})})}},64599:function(e,t,r){var n=r(96263);e.exports=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0,s=function(){};return{s:s,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}},e.exports.__esModule=!0,e.exports.default=e.exports}}]);