"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9430],{6466:function(t,e,n){n.d(e,{Z:function(){return g}});var r=n(4942),c=n(1413),o=n(91),s=n(28459),a=n(93967),i=n.n(a),l=n(62435),u=n(63330),d=n(44962),p=n(98082),f=function(t){return(0,r.Z)({},t.componentCls,{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBlock:t.marginLG,marginInline:0,color:t.colorText,fontWeight:"500",fontSize:"20px",lineHeight:"38px"})};var m=n(86074),x=function(t){var e=t.className,n=t.style,r=void 0===n?{}:n,o=t.children,a=(0,(0,l.useContext)(s.ZP.ConfigContext).getPrefixCls)("pro-card-operation"),u=function(t){return(0,p.Xj)("ProCardOperation",(function(e){var n=(0,c.Z)((0,c.Z)({},e),{},{componentCls:".".concat(t)});return[f(n)]}))}(a),d=u.wrapSSR,x=u.hashId,h=i()(a,e,x);return d((0,m.jsx)("div",{className:h,style:r,children:o}))},h=n(10357),j=function(t){return(0,r.Z)({},t.componentCls,{"&-chart":{display:"flex",flexDirection:"column",marginBlockStart:8,marginBlockEnd:8,"&-left":{marginBlockStart:0,marginInlineEnd:"16px"},"&-right":{marginBlockStart:0,marginInlineStart:"16px"}},"&-content":{display:"flex",flexDirection:"column","&-horizontal":(0,r.Z)({flexDirection:"row"},"".concat(t.componentCls,"-chart"),{alignItems:"center",alignSelf:"flex-start"})},"&-footer":{marginBlockStart:8,paddingBlockStart:"16px",borderBlockStart:"rgba(0, 0, 0, 0.08) solid ".concat(t.colorBorder)}})};var v=["children","statistic","className","chart","chartPlacement","footer"],N=function(t){var e,n=t.children,a=t.statistic,d=t.className,f=t.chart,x=t.chartPlacement,N=t.footer,g=(0,o.Z)(t,v),S=(0,(0,l.useContext)(s.ZP.ConfigContext).getPrefixCls)("pro-statistic-card"),b=function(t){return(0,p.Xj)("StatisticCard",(function(e){var n=(0,c.Z)((0,c.Z)({},e),{},{componentCls:".".concat(t)});return[j(n)]}))}(S),Z=b.wrapSSR,C=b.hashId,y=i()(S,d,C),_=a&&(0,m.jsx)(h.Z,(0,c.Z)({layout:"vertical"},a)),P=i()("".concat(S,"-chart"),C,(e={},(0,r.Z)(e,"".concat(S,"-chart-left"),"left"===x&&f&&a),(0,r.Z)(e,"".concat(S,"-chart-right"),"right"===x&&f&&a),e)),k=f&&(0,m.jsx)("div",{className:P,children:f}),w=i()("".concat(S,"-content "),C,(0,r.Z)({},"".concat(S,"-content-horizontal"),"left"===x||"right"===x)),R=(k||_)&&("left"===x?(0,m.jsxs)("div",{className:w,children:[k,_]}):(0,m.jsxs)("div",{className:w,children:[_,k]})),B=N&&(0,m.jsx)("div",{className:"".concat(S,"-footer ").concat(C).trim(),children:N});return Z((0,m.jsxs)(u.Z,(0,c.Z)((0,c.Z)({className:y},g),{},{children:[R,n,B]})))};N.Statistic=h.Z,N.Divider=d.Z,N.Operation=x,N.isProCard=!0,N.Group=function(t){return(0,m.jsx)(N,(0,c.Z)({bodyStyle:{padding:0}},t))};var g=N},10357:function(t,e,n){n.d(e,{Z:function(){return v}});var r=n(1413),c=n(4942),o=n(91),s=n(25035),a=n(28459),i=n(83062),l=n(40411),u=n(55054),d=n(93967),p=n.n(d),f=n(62435),m=n(98082),x=function(t){var e,n,r;return(0,c.Z)({},t.componentCls,(r={display:"flex",fontSize:t.fontSize,"& + &":{marginBlockStart:4},"&-tip":{marginInlineStart:4},"&-wrapper":(0,c.Z)({display:"flex",width:"100%"},"".concat(t.componentCls,"-status"),{width:"14px"}),"&-icon":{marginInlineEnd:16},"&-trend-icon":{width:0,height:0,borderInlineEnd:"3.5px solid transparent",borderBlockEnd:"9px solid #000",borderInlineStart:"3.5px solid transparent","&-up":{transform:"rotate(0deg)"},"&-down":{transform:"rotate(180deg)"}},"&-content":(0,c.Z)({width:"100%"},"".concat(t.antCls,"-statistic-content"),{"&-value-int":{fontSize:t.fontSizeHeading3}}),"&-description":{width:"100%"}},(0,c.Z)(r,"".concat(t.antCls,"-statistic-title"),{color:t.colorText}),(0,c.Z)(r,"&-trend-up",(0,c.Z)({},"".concat(t.antCls,"-statistic-content"),(0,c.Z)({color:"#f5222d"},"".concat(t.componentCls,"-trend-icon"),{borderBlockEndColor:"#f5222d"}))),(0,c.Z)(r,"&-trend-down",(0,c.Z)({},"".concat(t.antCls,"-statistic-content"),(0,c.Z)({color:"#389e0d"},"".concat(t.componentCls,"-trend-icon"),{borderBlockEndColor:"#52c41a"}))),(0,c.Z)(r,"& &-layout-horizontal",(e={display:"flex",justifyContent:"space-between"},(0,c.Z)(e,"".concat(t.antCls,"-statistic-title"),{marginBlockEnd:0}),(0,c.Z)(e,"".concat(t.antCls,"-statistic-content-value"),{fontWeight:500}),(0,c.Z)(e,"".concat(t.antCls,"-statistic-title,").concat(t.antCls,"-statistic-content,").concat(t.antCls,"-statistic-content-suffix,").concat(t.antCls,"-statistic-content-prefix,").concat(t.antCls,"-statistic-content-value-decimal"),{fontSize:t.fontSize}),e)),(0,c.Z)(r,"& &-layout-inline",(n={display:"inline-flex",color:t.colorTextSecondary},(0,c.Z)(n,"".concat(t.antCls,"-statistic-title"),{marginInlineEnd:"6px",marginBlockEnd:0}),(0,c.Z)(n,"".concat(t.antCls,"-statistic-content"),{color:t.colorTextSecondary}),(0,c.Z)(n,"".concat(t.antCls,"-statistic-title,").concat(t.antCls,"-statistic-content,").concat(t.antCls,"-statistic-content-suffix,").concat(t.antCls,"-statistic-content-prefix,").concat(t.antCls,"-statistic-content-value-decimal"),{fontSize:t.fontSizeSM}),n)),r))};var h=n(86074),j=["className","layout","style","description","children","title","tip","status","trend","prefix","icon"],v=function(t){var e,n=t.className,d=t.layout,v=void 0===d?"inline":d,N=t.style,g=t.description,S=(t.children,t.title),b=t.tip,Z=t.status,C=t.trend,y=t.prefix,_=t.icon,P=(0,o.Z)(t,j),k=(0,(0,f.useContext)(a.ZP.ConfigContext).getPrefixCls)("pro-card-statistic"),w=function(t){return(0,m.Xj)("Statistic",(function(e){var n=(0,r.Z)((0,r.Z)({},e),{},{componentCls:".".concat(t)});return[x(n)]}))}(k),R=w.wrapSSR,B=w.hashId,z=p()(k,n,B),I=p()("".concat(k,"-status"),B),T=p()("".concat(k,"-icon"),B),E=p()("".concat(k,"-wrapper"),B),Y=p()("".concat(k,"-content"),B),D=p()(B,(e={},(0,c.Z)(e,"".concat(k,"-layout-").concat(v),v),(0,c.Z)(e,"".concat(k,"-trend-").concat(C),C),e)),O=b&&(0,h.jsx)(i.Z,{title:b,children:(0,h.jsx)(s.Z,{className:"".concat(k,"-tip ").concat(B).trim()})}),M=p()("".concat(k,"-trend-icon"),B,(0,c.Z)({},"".concat(k,"-trend-icon-").concat(C),C)),H=C&&(0,h.jsx)("div",{className:M}),F=Z&&(0,h.jsx)("div",{className:I,children:(0,h.jsx)(l.Z,{status:Z,text:null})}),L=_&&(0,h.jsx)("div",{className:T,children:_});return R((0,h.jsxs)("div",{className:z,style:N,children:[L,(0,h.jsxs)("div",{className:E,children:[F,(0,h.jsxs)("div",{className:Y,children:[(0,h.jsx)(u.Z,(0,r.Z)({title:(S||O)&&(0,h.jsxs)(h.Fragment,{children:[S,O]}),prefix:(H||y)&&(0,h.jsxs)(h.Fragment,{children:[H,y]}),className:D},P)),g&&(0,h.jsx)("div",{className:"".concat(k,"-description ").concat(B).trim(),children:g})]})]})]}))}},89933:function(t,e,n){n.r(e),n.d(e,{default:function(){return E}});var r=n(15009),c=n.n(r),o=n(99289),s=n.n(o),a=n(5574),i=n.n(a),l=n(64119),u=n(40956),d=n(11774),p=n(38345),f=n(6466),m=n(59530),x=n(80507),h=n(45360),j=n(7134),v=n(34041),N=n(57953),g=n(38703),S=n(71230),b=n(15746),Z=n(27484),C=n.n(Z),y=n(70178),_=n.n(y),P=n(62435),k=n(9669),w=n.n(k),R=n(88007),B=n(92340),z=(n(20073),n(86074));C().extend(_());var I=(0,P.forwardRef)((function(t,e){var n=(0,m.useSelector)((function(t){return t.ppp.projectNftGrow})),r=(0,m.useSelector)((function(t){return t.ppp.projectSecPerRound})),c=(0,m.useSelector)((function(t){return t.ppp.projectNftLoading})),o=(0,P.useMemo)((function(){return[{title:"#",dataIndex:"key",key:"key",render:function(t,e,n){return(0,z.jsx)("span",{children:n+1})}},{title:"轮次时间(".concat(r/3600,"小时)"),dataIndex:"time",key:"time",render:function(t,e){return(0,z.jsx)("div",{children:e.time})}},{title:"NFT数量",dataIndex:"count",key:"count",render:function(t,e){return(0,z.jsx)("div",{children:e.count})}},{title:"锁定资产",dataIndex:"asset",key:"asset",render:function(t,e){return(0,z.jsx)("div",{children:e.asset})}}]}),[r]);return(0,z.jsx)("div",{className:"ppp-tab-grow",children:(0,z.jsx)(B.Z,{loading:{spinning:c,size:"large"},scroll:{x:!0},size:"small",columns:o,dataSource:n,defaultData:[],options:!1,search:!1,tableAlertRender:!1,tableAlertOptionRender:!1,pagination:!1})})})),T=(0,P.memo)(I);C().extend(_());var E=function(){var t=(0,m.useDispatch)(),e=h.ZP.useMessage(),n=i()(e,2),r=n[0],o=(n[1],(0,m.useSelector)((function(t){return t.global.contractKit}))),a=(0,m.useSelector)((function(t){return t.global.session})),Z=(0,m.useSelector)((function(t){return t.ppp.projectOptions})),y=(0,m.useSelector)((function(t){return t.ppp.projectId})),_=(0,m.useSelector)((function(t){return t.ppp.projectTotalNumber})),k=(0,m.useSelector)((function(t){return t.ppp.projectBuyNumber})),B=(0,m.useSelector)((function(t){return t.ppp.projectSellNumber})),I=(0,m.useSelector)((function(t){return t.ppp.projectBurnNumber})),E=(0,m.useSelector)((function(t){return t.ppp.projectSplitNumber})),Y=(0,m.useSelector)((function(t){return t.ppp.projectSecPerRound})),D=(0,m.useSelector)((function(t){return t.ppp.projectNextRound})),O=(0,m.useSelector)((function(t){return t.ppp.projectNftLoading})),M=(0,m.useSelector)((function(t){return t.ppp.projectNftGrowCount})),H=(0,P.useState)(!1),F=i()(H,2),L=F[0],G=F[1],A=(0,P.useRef)(0),X=(0,P.useCallback)(function(){var e=s()(c()().mark((function e(n){var o,s,a,i,d,p,f,m,x;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.load("dfs3protocol");case 3:return o=e.sent,s=o.table("projects"),a=o.table("stat"),e.next=8,s.all({scope:"dfs3protocol"});case 8:return i=e.sent,e.next=11,a.all({scope:"dfs3protocol"});case 11:return d=e.sent,e.next=14,w().get("https://api.dfs.land/dfschain/pppvolume2");case 14:200!==(p=e.sent).status&&r.error("获取pppvolume2数据失败"),f=p.data,m=[],i.forEach((function(t){f.hasOwnProperty(t.id.toString())&&m.push(t)})),m.sort((function(t,e){var n=t.id.toString(),r=e.id.toString();return f[r].volume_24h-f[n].volume_24h})),x=[],m.forEach((function(t){var e=t.nft_img,n=t.id.toString(),r=t.project_name,c=t.creator.toString();x.push({value:n,label:(0,z.jsxs)("div",{className:"flex items-center",children:[(0,z.jsx)("div",{className:"mr-2",children:n.padStart(3,"0")}),(0,z.jsx)(j.C,{className:"mr-2",size:"default",src:e}),(0,z.jsxs)("div",{children:[r," @",c]})]}),desc:"".concat(n,"-").concat(r,"-").concat(c,"-").concat(e)})})),t(u.N.setProjectOptions(x)),t(u.N.setStats(d)),t(u.N.setProjects(i)),G(!1),e.next=32;break;case 28:e.prev=28,e.t0=e.catch(0),G(!1),(0,l.Tv)(e.t0,r);case 32:case"end":return e.stop()}}),e,null,[[0,28]])})));return function(t){return e.apply(this,arguments)}}(),[]),W=(0,P.useCallback)((function(t){if(t<0)A.current=100;else{var e=1e3*Y,n=(e-t)/e*100;A.current=n}}),[Y]),K=(0,P.useCallback)((function(e,n){var r=[],c=n.init_nft_price.symbol,o=0,s=0,a=0,i=0;Object.keys(e).forEach((function(t,n){var l=e[t].number,u=e[t].invest,d=e[t].profit;o+=l,s+=u,a+=d,i+=1,r.push({key:n,owner:t,number:l,percent:0,invest:u,profit:d,investAsset:x.xR.from(u,c).toString(),profitAsset:x.xR.from(d,c).toString()})})),r.forEach((function(t){t.percent=t.number/o*100})),r.sort((function(t,e){return e.number-t.number})),t(u.N.setProjectNftRank(r)),t(u.N.setProjectNftRankReset(r)),t(u.N.setProjectTotalHolder(i)),t(u.N.setProjectTotalInvest(s)),t(u.N.setProjectTotalProfit(a))}),[]),V=(0,P.useCallback)((function(e,n){var r=n.sec_per_round.toNumber(),c=C().utc(n.last_round.toString()),o=n.init_nft_price.value,s=2*o,a=n.init_nft_price.symbol,i=n.increase_per_round.toNumber()/100,l=o*i,d=[],p=[],f=0;e.forEach((function(t){var e=Number(t.current_price.split(" ")[0]);e>=s?(p.push(l),p.push(l),f+=2*l):(p.push(e),f+=e)})),d.push({key:0,time:c.local().format("YYYY-MM-DDTHH:mm:ss"),count:p.length,asset:f.toFixed(0)+" "+a.name});for(var m=1;m<=M;++m){for(var x=0,h=p.length,j=0;j<h;++j){var v=p[j]*i;v>=s?(p.push(l),p[j]=l,x+=2*l):(p[j]=v,x+=v)}var N=c.add(r*m,"seconds").local().format("YYYY-MM-DDTHH:mm:ss");d.push({key:m,time:N,count:p.length,asset:x.toFixed(0)+" "+a.name})}t(u.N.setProjectNftGrow(d))}),[M]),q=(0,P.useCallback)(function(){var e=s()(c()().mark((function e(n){var s,i,d,p,f,m,h,j,v,N,g,S,b,Z,y,_,P,k,w,R,B,z,I,T,E,Y,D,O,M,H,F;return c()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(u.N.setProjectNftLoading(!0)),e.next=4,a.client.v1.chain.get_table_rows({code:"dfs3protocol",table:"registry",scope:"dfs3protocol",key_type:"i64",index_position:"secondary",lower_bound:x.zM.from(n),upper_bound:x.zM.from(n),limit:5e3});case 4:return s=e.sent,e.next=7,o.load("dfs3protocol");case 7:return i=e.sent,d=i.table("projects"),p=i.table("stat"),e.next=12,d.all({scope:"dfs3protocol",from:n,to:n});case 12:return f=e.sent,e.next=15,p.all({scope:"dfs3protocol",from:n,to:n});case 15:for(m=e.sent,h=f[0],j=h.sec_per_round.toNumber(),v=h.sec_to_burn_nft.toNumber(),N=C().utc(h.last_round.toString()).valueOf(),g=C().utc(h.last_round.toString()).add(j,"seconds").local(),S=g.valueOf(),b=g.format("YYYY-MM-DDTHH:mm:ss"),Z=h.init_nft_price.value,y=h.init_nft_price.symbol,_=h.init_nft_price.symbol.precision,P=h.increase_per_round.toNumber()/100,k=h.trade_fee_ratio.toNumber()/1e4,w=100*(P-1-P*(k+.005)),R=0,B=0,z=0,I=0,T=[],E=[],Y=[],D={},O=Number((Z*P).toFixed(_)),M=Z,H=2*Z;M*P<H;)M*=P;F={creator:h.creator.toString(),totalNft:s.rows.length,initNftPrice:Z,splitPrice:H,secPerRound:j,increasePerRound:P,tradeFeeRatio:k,secToBurnNft:v,tokenPerNft:h.token_per_nft.toString(),create_time:C().utc(h.create_time.toString()).local().format("YYYY-MM-DDTHH:mm:ss"),profitRate:w},s.rows.forEach((function(t,e){var n=C()().valueOf(),r=C().utc(t.last_trade).valueOf(),c=1e3*v,o=1e3*j,s=Number(t.current_price.split(" ")[0]),a=t.current_round,i="";s>=H?(I+=1,i="可拆分"):(n-r>c&&(R+=1,i="可销毁"),N>r||n-N>o?(B+=1,i=i?"可买/"+i:"可买"):(z+=1,i="已售"));var l=0,u=0;s>=H?(u=M,l=2*O-M-2*O*(k+.005)):s===O&&a>1?(u=M/2,l=O-M/2-O*(k+.005)):(u=s/P,l=s*(1-1/P-k-.005)),D.hasOwnProperty(t.owner)||(D[t.owner]={number:0,invest:0,profit:0}),D[t.owner].profit+=l,D[t.owner].number+=1,D[t.owner].invest+=u,E.includes(t.owner)||E.push(t.owner),T.push({key:e,id:t.id,cid:t.cid,pid:t.pid,owner:t.owner,current_round:t.current_round,current_price:t.current_price,last_trade:t.last_trade,create_time:t.create_time,profit:x.xR.from(l,y).toString(),invest:x.xR.from(u,y).toString(),status:i})})),K(D,h),V(T,h),E.sort(),E.forEach((function(t){Y.push({text:t,value:t})})),T.sort((function(t,e){return C()(t.last_trade).valueOf()-C()(e.last_trade).valueOf()})),t(u.N.setProjectSecToBurnNft(v)),t(u.N.setProjectTotalNumber(m[0].supply.toNumber())),t(u.N.setProjectBurnNumber(R)),t(u.N.setProjectBuyNumber(B)),t(u.N.setProjectSellNumber(z)),t(u.N.setProjectSplitNumber(I)),t(u.N.setProjectNft(T)),t(u.N.setProjectNftReset(T)),t(u.N.setProjectId(n)),t(u.N.setProjectNextRound({value:S,text:b})),t(u.N.setProjectSecPerRound(j)),t(u.N.setProjectAccountFilter(Y)),t(u.N.setProjectNftLoading(!1)),t(u.N.setProjectProfitRate(w)),t(u.N.setProject(F)),e.next=69;break;case 65:e.prev=65,e.t0=e.catch(0),t(u.N.setProjectNftLoading(!1)),(0,l.Tv)(e.t0,r);case 69:case"end":return e.stop()}}),e,null,[[0,65]])})));return function(t){return e.apply(this,arguments)}}(),[a,o,K,V]);return(0,P.useEffect)((function(){!o||Z.length||L||(G(!0),X(o))}),[X,Z,o,L]),(0,z.jsxs)(d._z,{className:"projects",ghost:!0,children:[(0,z.jsx)(v.default,{loading:L,size:"large",style:{width:"100%"},className:"mb-3",defaultValue:y?y.toString():void 0,onChange:function(t){q(Number(t))},placeholder:"请选择项目",showSearch:!0,filterOption:function(t,e){var n=e.desc.split("-"),r=i()(n,3),c=r[0],o=r[1],s=r[2];return(c.padStart(3,"0")+o+s).toLowerCase().includes(t.toLowerCase())},options:Z,optionRender:function(t){var e=t.data.desc.split("-"),n=i()(e,4),r=n[0],c=n[1],o=n[2],s=n[3];return(0,z.jsxs)("div",{className:"flex items-center",children:[(0,z.jsx)("div",{className:"mr-2",children:r.padStart(3,"0")}),(0,z.jsx)(j.C,{className:"mr-2",size:"default",src:s}),(0,z.jsxs)("div",{children:[c," @",o]})]})}}),(0,z.jsxs)(N.Z,{size:"large",spinning:O,children:[(0,z.jsxs)("div",{className:"flex items-center",children:[(0,z.jsx)("div",{children:"下一轮倒计时："}),(0,z.jsx)(R.Wo,{className:"mr-2 font-medium text-base",value:D.value,onChange:W}),(0,z.jsx)("div",{className:" text-base",children:D.text})]}),(0,z.jsx)(g.Z,{percent:A.current,showInfo:!1}),(0,z.jsx)(p.Z,{headerBordered:!0,headStyle:{justifyContent:"center"},className:"mb-3",children:(0,z.jsxs)(S.Z,{gutter:10,children:[(0,z.jsx)(b.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,z.jsx)(f.Z,{layout:"center",statistic:{title:(0,z.jsx)("div",{className:"text-center",children:"总量"}),value:_}})}),(0,z.jsx)(b.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,z.jsx)(f.Z,{layout:"center",statistic:{title:(0,z.jsx)("div",{className:"text-center",children:"可买 / 已售"}),value:"".concat(k," / ").concat(B)}})}),(0,z.jsx)(b.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,z.jsx)(f.Z,{layout:"center",statistic:{title:(0,z.jsx)("div",{className:"text-center",children:"可拆分"}),value:E}})}),(0,z.jsx)(b.Z,{lg:{span:"6"},md:{span:"12"},sm:{span:"12"},xs:{span:"12"},children:(0,z.jsx)(f.Z,{layout:"center",statistic:{title:(0,z.jsx)("div",{className:"text-center",children:"可销毁"}),value:I}})})]})})]}),(0,z.jsx)(p.Z,{tabs:{items:[{key:"nft",label:(0,z.jsx)("span",{className:"",children:"NFT"}),children:(0,z.jsx)(R.tw,{handleGetProjectNft:q})},{key:"rank",label:(0,z.jsx)("span",{className:"",children:"排名"}),children:(0,z.jsx)(R.SX,{handleGetProjectNft:q})},{key:"grow",label:(0,z.jsx)("span",{className:"",children:"增长趋势"}),children:(0,z.jsx)(T,{})},{key:"about",label:(0,z.jsx)("span",{className:"",children:"关于"}),children:(0,z.jsx)(R.kh,{})}]}})]})}}}]);