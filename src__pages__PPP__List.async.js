"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6119],{98165:function(e,t,r){r.d(t,{Z:function(){return u}});var n=r(87462),a=r(62435),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},s=r(84089),i=function(e,t){return a.createElement(s.Z,(0,n.Z)({},e,{ref:t,icon:o}))};var u=a.forwardRef(i)},76255:function(e,t,r){r.r(t);var n=r(15009),a=r.n(n),o=r(99289),s=r.n(o),i=r(5574),u=r.n(i),c=r(355),d=r(17346),l=r(64119),p=r(98165),f=r(11774),m=r(92340),x=r(59530),y=r(45360),h=r(7134),v=r(9669),k=r.n(v),b=r(27484),N=r.n(b),w=r(62435),R=(r(8849),r(80507)),P=r(86074);t.default=function(){var e=(0,x.useDispatch)(),t=(0,x.useSelector)((function(e){return e.global.contractKit})),r=(0,x.useSelector)((function(e){return e.global.host})),n=(0,x.useSelector)((function(e){return e.ecosystem.pppDataSource})),o=(0,w.useState)(!0),i=u()(o,2),v=i[0],b=i[1],S=y.ZP.useMessage(),_=u()(S,2),g=_[0],j=_[1],I=(0,x.useIntl)().formatMessage({id:"ecosystem.update"}),T=(0,w.useCallback)(function(){var e=s()(a()().mark((function e(t){var r,n,o,s,i,u,c;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.load("swapswapswap");case 3:return r=e.sent,n=r.table("markets"),e.next=7,n.all();case 7:return o=e.sent,s=[],"usdtusdtusdt-USDT-8",u="eosio.token-DFS-8",c=[],(i={})["usdtusdtusdt-USDT-8"]=1,i[u]=(0,l.ri)(o[0].reserve0)/(0,l.ri)(o[0].reserve1),o.forEach((function(e){var t=e.contract0.toString()+"-"+e.sym0.toString().split(",")[1]+"-"+e.sym0.toString().split(",")[0],r=e.contract1.toString()+"-"+e.sym1.toString().split(",")[1]+"-"+e.sym1.toString().split(",")[0];s.includes(t)||s.push(t),s.includes(r)||s.push(r);var n=(0,l.ri)(e.reserve0),a=(0,l.ri)(e.reserve1);"eosio.token"===e.contract0.toString()?i.hasOwnProperty(r)||(i[r]=n/a*i[u]):"eosio.token"===e.contract1.toString()?i.hasOwnProperty(t)||(i[t]=a/n*i[u]):"usdtusdtusdt"===e.contract0.toString()?i.hasOwnProperty(r)||(i[r]=n/a):"usdtusdtusdt"===e.contract1.toString()?i.hasOwnProperty(t)||(i[t]=a/n):c.push({key0:t,key1:r,value0:n,value1:a})})),c.forEach((function(e){i.hasOwnProperty(e.key0)&&!i.hasOwnProperty(e.key1)?i[e.key1]=e.value0/e.value1*i[e.key0]:!i.hasOwnProperty(e.key0)&&i.hasOwnProperty(e.key1)?i[e.key0]=e.value1/e.value0*i[e.key1]:i.hasOwnProperty(e.key0)||i.hasOwnProperty(e.key1)||(i[e.key0]=0,i[e.key1]=0)})),Object.keys(i).forEach((function(e){Number.isNaN(i[e])&&(i[e]=0)})),e.abrupt("return",i);case 21:return e.prev=21,e.t0=e.catch(0),(0,l.Tv)(e.t0,g),e.abrupt("return",{});case 25:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(t){return e.apply(this,arguments)}}(),[l.Tv]),D=(0,w.useCallback)(s()(a()().mark((function e(){var t,n,o,s,i,c,d,p,f,m,x,y,h,v;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={},n=1e3,o="1",s="";case 4:return e.next=7,(0,l.zI)(k().post("".concat(r,"/v2/chain/get_scope_rows"),{code:"dfspppreward",table:"rewardpools",lower_bound:o,primary_lower_bound:s,limit:n,index_position:"primary",key_type:"i64"}));case 7:if(i=e.sent,c=u()(i,2),d=c[0],p=c[1],d||200!==p.status){e.next=22;break}for(f=p.data.rows,m=0;m<f.length;++m)x=f[m].scope,y=R.VG.from(x),h=y.value.toNumber(),v=f[m].data,t.hasOwnProperty(h)||(t[h]=[]),t[h].push(v);if(!p.data.more){e.next=19;break}o=p.data.next_key,s=p.data.next_primary_key,e.next=20;break;case 19:return e.abrupt("break",26);case 20:e.next=24;break;case 22:return g.error(d),e.abrupt("break",26);case 24:e.next=4;break;case 26:return e.abrupt("return",t);case 27:case"end":return e.stop()}}),e)}))),[]),O=(0,w.useCallback)(function(){var t=s()(a()().mark((function t(r){var n,o,s,i,u,c,l,p,f,m,x,y;return a()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.load("dfs3protocol");case 2:return n=t.sent,o=n.table("projects"),s=n.table("stat"),t.next=7,o.all({scope:"dfs3protocol"});case 7:return i=t.sent,t.next=10,s.all({scope:"dfs3protocol"});case 10:return u=t.sent,t.next=13,T(r);case 13:return c=t.sent,t.next=16,D();case 16:return l=t.sent,p={},Object.keys(l).forEach((function(e){var t,r=0;l[e].forEach((function(e){var t=e.cnt,n=R.xR.from(e.balance),a=t+"-"+n.symbol.name+"-"+n.symbol.precision;c.hasOwnProperty(a)&&(r+=c[a]*n.value)})),t=r/c["eosio.token-DFS-8"],p[e]={totalRewordValueUsdt:r,totalRewordValueDfs:t}})),t.next=21,k().get("https://api.dfs.land/dfschain/pppvolume2");case 21:200!==(f=t.sent).status&&g.error("获取pppvolume2数据失败"),m=f.data,x=[],i.forEach((function(e){m.hasOwnProperty(e.id.toString())&&x.push(e)})),x.sort((function(e,t){var r=e.id.toString(),n=t.id.toString();return m[n].volume_24h-m[r].volume_24h})),y=[],x.forEach((function(e,t){for(var r=e.id.toNumber(),n=e.creator.toString(),a=e.project_name,o=e.nft_name,s=e.nft_img,i=e.nft_bgm,c=e.desc,d=e.twitter,l=e.telegram,f=e.website,m=e.token_url,x=e.init_nft_number.toNumber(),h=e.init_nft_price.toString(),v=e.init_nft_price.value,k=e.init_nft_price.symbol,b=e.init_nft_price.symbol.precision,w=2*v,R=w+" "+k.name,P=e.token_per_nft.toString(),S=e.max_token_supply.toString(),_=e.round.toNumber(),g=e.mid.toNumber(),j=e.sec_to_burn_nft.toNumber(),I=e.sec_per_round.toNumber(),T=e.increase_per_round.toNumber(),D=T/100,O=e.trade_fee_ratio.toNumber(),M=N().utc(e.last_round.toString()).local().format("YYYY-MM-DDTHH:mm:ss"),C=N().utc(e.create_time.toString()).local().format("YYYY-MM-DDTHH:mm:ss"),E=u.filter((function(e){return e.cid.toNumber()===r}))[0],F=E.supply.toNumber(),Y=E.max_supply.toNumber(),U=100*(D-1-D*(O/1e4+.005)),V=Number((v*D).toFixed(b)),H=v;H*D<w;)H*=D;var A=(2*V*(1-O/1e4-.005)-H)/H*100,B=31536e3/I*U,z=N().utc(e.last_round.toString()).add(I,"seconds").local(),Z=z.valueOf(),q=z.format("YYYY-MM-DDTHH:mm:ss"),G=p[r]?p[r].totalRewordValueUsdt:0,K=p[r]?p[r].totalRewordValueDfs:0;y.push({key:t,id:r,creator:n,projectName:a,nftName:o,nftImg:s,nftBgm:i,desc:c,twitter:d,telegram:l,website:f,tokenUrl:m,initNftNumber:x,initNftPrice:h,splitNftPrice:R,tokenPerNft:P,maxTokenSupply:S,round:_,mid:g,secToBurnNft:j,secPerRound:I,increasePerRound:T,tradeFeeRatio:O,lastRound:M,createTime:C,nftSupply:F,nftMaxSupply:Y,profitRate:U,profitRateSplit:A,profitRateApr:B,nextRoundValue:Z,nextRoundText:q,rewordPoolUsdt:G,rewordPoolDfs:K})})),e(d.N.setPPPDataSource(y)),b(!1);case 31:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[t,T,D]),M=(0,w.useMemo)((function(){return[{title:"ID",dataIndex:"id",key:"id",sorter:function(e,t){return e.id-t.id},render:function(e,t){return(0,P.jsxs)("span",{children:["#",t.id]})}},{title:"项目",dataIndex:"id",key:"id",render:function(e,t){var r=t.nftImg;return(0,P.jsxs)("div",{children:[(0,P.jsx)(h.C,{className:"mr-2",size:"large",shape:"square",src:r,alt:"abc"}),(0,P.jsx)("span",{children:t.nftName}),(0,P.jsx)("div",{children:t.projectName}),(0,P.jsxs)("div",{children:["@",t.creator]})]})}},{title:"下一轮倒计时",dataIndex:"nextRoundValue",key:"nextRoundValue",sorter:function(e,t){return e.nextRoundValue-t.nextRoundValue},render:function(e,t){var r=t.secPerRound/3600+" Hours";return(0,P.jsxs)("div",{children:[(0,P.jsx)(c.Wo,{className:"font-medium text-base",value:t.nextRoundValue}),(0,P.jsx)("div",{children:t.nextRoundText}),(0,P.jsx)("div",{children:r})]})}},{title:"流通量",dataIndex:"nftSupply",key:"nftSupply",sorter:function(e,t){return t.nftSupply-e.nftSupply},render:function(e,t){return(0,P.jsx)("div",{children:t.nftSupply})}},{title:"每轮涨幅",dataIndex:"increasePerRound",key:"increasePerRound",sorter:function(e,t){return e.increasePerRound-t.increasePerRound},render:function(e,t){var r=(t.increasePerRound-100).toFixed(2)+" %";return(0,P.jsx)("span",{children:r})}},{title:"手续费",dataIndex:"tradeFeeRatio",key:"tradeFeeRatio",sorter:function(e,t){return e.tradeFeeRatio-t.tradeFeeRatio},render:function(e,t){var r=t.tradeFeeRatio/100+" %";return(0,P.jsx)("span",{children:r})}},{title:"利润率",dataIndex:"profitRate",key:"profitRate",sorter:function(e,t){return t.profitRate-e.profitRate},render:function(e,t){var r=t.profitRate.toFixed(2)+" %",n=t.profitRateSplit.toFixed(2)+" %";return(0,P.jsxs)("div",{children:[(0,P.jsx)("div",{children:r}),(0,P.jsx)("div",{children:n})]})}},{title:"年化率",dataIndex:"profitRateApr",key:"profitRateApr",sorter:function(e,t){return t.profitRateApr-e.profitRateApr},render:function(e,t){var r=t.profitRateApr.toFixed(0)+" %";return(0,P.jsx)("div",{children:(0,P.jsx)("div",{children:r})})}},{title:"奖励池",dataIndex:"rewordPoolUsdt",key:"rewordPoolUsdt",sorter:function(e,t){return t.rewordPoolUsdt-e.rewordPoolUsdt},render:function(e,t){return(0,P.jsx)("span",{children:(0,l.CE)(t.rewordPoolUsdt,"$")})}},{title:"每轮时间",dataIndex:"secPerRound",key:"secPerRound",sorter:function(e,t){return e.secPerRound-t.secPerRound},render:function(e,t){var r=t.secPerRound/3600+" Hours";return(0,P.jsx)("span",{children:r})}},{title:"初始发行量",dataIndex:"initNftNumber",key:"initNftNumber",render:function(e,t){return(0,P.jsx)("span",{children:t.initNftNumber})}},{title:"最大发行量",dataIndex:"nftMaxSupply",key:"nftMaxSupply",render:function(e,t){return(0,P.jsx)("span",{children:t.nftMaxSupply})}},{title:"初始价格",dataIndex:"initNftPrice",key:"initNftPrice",render:function(e,t){var r=t.initNftPrice.split(" "),n=u()(r,2),a=n[0],o=n[1],s=(0,l.CE)(a)+" "+o;return(0,P.jsx)("span",{children:s})}},{title:"销毁时间",dataIndex:"secToBurnNft",key:"secToBurnNft",sorter:function(e,t){return e.secToBurnNft-t.secToBurnNft},render:function(e,t){var r=t.secToBurnNft/3600+" Hours";return(0,P.jsx)("span",{children:r})}},{title:"销毁兑换",dataIndex:"tokenPerNft",key:"tokenPerNft",render:function(e,t){var r=t.tokenPerNft.split(" "),n=u()(r,2),a=n[0],o=n[1],s=(0,l.CE)(a)+" "+o;return(0,P.jsx)("span",{children:s})}},{title:"创建时间",dataIndex:"createTime",key:"createTime",render:function(e,t){return(0,P.jsx)("span",{children:t.createTime})}}]}),[l.CE]);return(0,w.useEffect)((function(){t?(n.length?b(!1):b(!0),O(t)):b(!0)}),[t,O]),(0,P.jsxs)(f._z,{className:"ppp-list",ghost:!0,children:[(0,P.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,P.jsxs)("div",{children:[(0,P.jsx)(p.Z,{spin:v,className:"ml-[8px] hover:cursor-pointer",style:{color:"#1677ff"},onClick:function(){b(!0),O(t)}}),(0,P.jsxs)("span",{className:"ml-[8px]",children:[I,": ",N()().format().substring(0,19)]})]})}),(0,P.jsx)(m.Z,{className:"",scroll:{x:!0},size:"small",columns:M,dataSource:n,defaultData:[],search:!1,options:!1,pagination:!1}),j]})}},8849:function(){}}]);