"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[932],{98747:function(e,n,t){t.d(n,{gb:function(){return w},ot:function(){return _.Z},_h:function(){return y.Z}});var r=t(15009),a=t.n(r),s=t(99289),c=t.n(s),o=t(5574),u=t.n(o),l=t(64119),i=t(37476),d=t(98097),p=t(59530),f=t(45360),h=t(27484),v=t.n(h),x=t(38823),k=t.n(x),g=t(70178),m=t.n(g),b=t(62435),j=t(86074);v().extend(m()),v().extend(k());var S=b.forwardRef((function(e,n){var t=f.ZP.useMessage(),r=u()(t,2),s=r[0],o=r[1],h=(0,p.useSelector)((function(e){return e.global.contractKit})),x=(0,b.useState)(),k=u()(x,2),g=k[0],m=k[1],S=(0,b.useState)(),w=u()(S,2),_=w[0],y=w[1],D=(0,b.useRef)(),N=(0,b.useState)(!1),O=u()(N,2),F=O[0],I=O[1],C=(0,b.useState)(!0),R=u()(C,2),Z=R[0],P=R[1],z=(0,b.useCallback)(function(){var e=c()(a()().mark((function e(n,t){var r,c,o;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.load("dfsweb3desoc");case 3:return r=e.sent,c=r.table("profiles"),e.next=7,c.all({scope:"dfsweb3desoc",from:t.voter.toString(),to:t.voter.toString()});case 7:o=e.sent,m(o[0]),P(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),(0,l.Tv)(e.t0,s);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(n,t){return e.apply(this,arguments)}}(),[s]),M=(0,b.useCallback)((function(e){z(h,e),y(e),I(!0)}),[h]);(0,b.useImperativeHandle)(n,(function(){return{handleOpen:M}}));var A=(0,b.useCallback)(c()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)}))),[]),E=(0,b.useCallback)((function(e){return e?"DFSNode.Online - 广州"===e?"DFSOnline-广州@":"DFSNode.Online - 杭州"===e?"DFSOnline-杭州@":"DFSNode.Online - 香港"===e?"DFSOnline-香港@":"DFSNode.Online - 张家口"===e?"DFSOnline-张家口@":"DFSNode.Online - 呼和浩特"===e?"DFSOnline-呼和浩特@":"DFS-美国弗吉尼亚-Node"===e?"DFS-美国弗吉尼亚@":"DFS-北京节点（持续在线）"===e?"DFS-北京节点@":"DFS-广州（持续在线）"===e?"DFS-广州@":e+"@":""}),[]),V=(0,b.useMemo)((function(){return[{title:"sex",dataIndex:"sex",key:"sex",render:function(e,n){return Object.keys(n).length?(0,j.jsx)("span",{children:n.sex.toNumber()}):(0,j.jsx)("span",{children:"null"})}},{title:"cover",dataIndex:"cover",key:"cover",render:function(e,n){return Object.keys(n).length?(0,j.jsx)("span",{children:n.cover}):(0,j.jsx)("span",{children:"null"})}},{title:"desc",dataIndex:"desc",key:"desc",render:function(e,n){return Object.keys(n).length?(0,j.jsx)("span",{children:n.desc}):(0,j.jsx)("span",{children:"null"})}},{title:"avatar",dataIndex:"avatar",key:"avatar",render:function(e,n){return Object.keys(n).length?(0,j.jsx)("span",{children:n.avatar}):(0,j.jsx)("span",{children:"null"})}},{title:"join",dataIndex:"join",key:"join",render:function(e,n){return Object.keys(n).length?(0,j.jsx)("span",{children:v().utc(n.join.toString()).local().format()}):(0,j.jsx)("span",{children:"null"})}},{title:"update",dataIndex:"update",key:"update",render:function(e,n){return Object.keys(n).length?(0,j.jsx)("span",{children:v().utc(n.update.toString()).local().format()}):(0,j.jsx)("span",{children:"null"})}}]}),[]);return(0,j.jsxs)(i.Y,{formRef:D,title:"",open:F,onFinish:A,onOpenChange:function(e){I(e)},layout:"horizontal",width:"350px",submitter:!1,children:[(0,j.jsx)(d.vY,{title:(0,j.jsx)("div",{className:"flex items-center",children:(0,j.jsx)("div",{className:"",children:E(null==g?void 0:g.nick)+(null==_?void 0:_.voter.toString())})}),loading:Z,column:1,dataSource:g,columns:V}),o]})})),w=(0,b.memo)(S),_=t(95260),y=t(98531)},42932:function(e,n,t){t.r(n),t.d(n,{default:function(){return y}});var r=t(15009),a=t.n(r),s=t(99289),c=t.n(s),o=t(5574),u=t.n(o),l=t(98747),i=t(9004),d=t(19601),p=t(64119),f=t(11774),h=t(92340),v=t(59530),x=t(45360),k=t(71230),g=t(15746),m=t(9669),b=t.n(m),j=t(62435),S=t(86074),w=0,_=0,y=function(){var e=x.ZP.useMessage(),n=u()(e,2),t=n[0],r=n[1],s=(0,j.useState)(!1),o=u()(s,2),m=o[0],y=o[1],D=(0,v.useDispatch)(),N=(0,v.useSelector)((function(e){return e.global.session})),O=(0,v.useSelector)((function(e){return e.vote.producerDataSource1})),F=(0,v.useSelector)((function(e){return e.vote.producerDataSource2})),I=(0,j.useState)(""),C=u()(I,2),R=C[0],Z=C[1],P=(0,j.useRef)(),z=(0,j.useCallback)(function(){var e=c()(a()().mark((function e(n){var r,s,c,o,u,l,f,h,v;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b().get("https://api.dfs.land/dfschain/producers");case 3:return r=e.sent.data,e.next=6,n.client.v1.chain.get_currency_stats("eosio.token","DFS");case 6:return s=e.sent,e.next=9,n.client.v1.chain.get_currency_balance("eosio.token","dfsbpsvoters","DFS");case 9:return c=e.sent,e.next=12,n.client.v1.chain.get_producer_schedule();case 12:o=e.sent,u=o.active.producers,l=r.reduce((function(e,n){var t=0;return n.current_status&&(t=n.current_status),e+t}),0),f={totalNodes:r.length,totalProducers:u.length,totalNodesOnline:l,rewardMinVotes:s.DFS.supply.value/1e4,bpRewardPoolBal:c[0].value},D(i.N.setNodeInfo(f)),r.forEach((function(e,n){r[n].last_check||(r[n].current_status=0,r[n].p2pstatus="offline",r[n].rpcstatus="offline",r[n].total_reward="0.00000000 DFS");var t=r[n].logo;t&&!t.startsWith("http")&&t.startsWith("Qm")?r[n].logo="https://imagedelivery.net/hc5yVyoIvwlbf8YqJjqHMw/".concat(t,"/public"):void 0!==t&&/^(https|http|ftp):\/\/[a-zA-Z0-9\-.]+\.[a-zA-Z]{2,}(:[0-9]{1,5})?(\/[\S]*)?$/.test(t)||(r[n].logo="https://dfs.land/assets/icons/48x48.png"),r[n].key=n,r[n].rank=n+1,1===r[n].current_status&&Number(e.total_votes)/1e8>=f.rewardMinVotes?r[n].is_reward=1:r[n].is_reward=0})),u.forEach((function(e,n){var t=r.find((function(n){return n.owner===e.producer_name.toString()}));u[n].is_active=t.is_active,u[n].last_claim=t.last_claim,u[n].total_votes=t.total_votes,u[n].url=t.url,u[n].rank=t.rank,u[n].intro=t.intro,u[n].location=t.location,u[n].logo=t.logo,u[n].nick=t.nick,u[n].p2purl=t.p2purl,u[n].rpcurl=t.rpcurl,u[n].owner=t.owner,u[n].current_status=t.current_status,u[n].p2pstatus=t.p2pstatus,u[n].rpcstatus=t.rpcstatus,u[n].total_reward=t.total_reward,u[n].key=n,u[n].rank=t.rank,u[n].is_reward=t.is_reward})),h=[],v=[],u.forEach((function(e,n){n<15?h.push(e):v.push(e)})),D(d.N.setProducerDataSource1(h)),D(d.N.setProducerDataSource2(v)),y(!1),e.next=31;break;case 27:e.prev=27,e.t0=e.catch(0),y(!1),(0,p.Tv)(e.t0,t);case 31:case"end":return e.stop()}}),e,null,[[0,27]])})));return function(n){return e.apply(this,arguments)}}(),[t]),M=(0,j.useCallback)(function(){var e=c()(a()().mark((function e(n){var t,r,s,c;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=8;break}return e.next=3,(0,p.zI)(n.client.v1.chain.get_info());case 3:t=e.sent,r=u()(t,2),s=r[0],(c=r[1])?Z(c.head_block_producer.toString()):(Z(""),console.log(s));case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[]);(0,j.useEffect)((function(){N?(O.length&&F.length?y(!1):y(!0),z(N),M(N)):y(!0)}),[N,z,M]),(0,j.useEffect)((function(){return N&&(w=setInterval((function(){M(N)}),6e3)),function(){clearInterval(w)}}),[N,M]),(0,j.useEffect)((function(){return N&&(_=setInterval((function(){z(N)}),12e4)),function(){clearInterval(_)}}),[N,z]);var A=(0,j.useMemo)((function(){return[{title:"Pruducer",dataIndex:"owner",key:"owner",fixed:!0,render:function(e,n){return R===n.owner?(0,S.jsx)("span",{className:"text-blue-500 hover:cursor-pointer",children:n.key+1+". "+n.owner}):(0,S.jsx)("span",{className:"hover:cursor-pointer",children:n.key+1+". "+n.owner})}},{title:"RPC",dataIndex:"rpcstatus",key:"rpcstatus",align:"center",render:function(e,n){return(0,S.jsx)("div",{children:"online"===n.rpcstatus?(0,S.jsx)("div",{children:1}):(0,S.jsx)("div",{className:"text-red-600 font-semibold",children:0})})}},{title:"P2P",dataIndex:"rpcstatus",key:"rpcstatus",align:"center",render:function(e,n){return(0,S.jsx)("div",{children:"online"===n.p2pstatus?(0,S.jsx)("div",{children:1}):(0,S.jsx)("div",{className:"text-red-600 font-semibold",children:0})})}},{title:"Reward",dataIndex:"current_status",key:"current_status",align:"center",render:function(e,n){return(0,S.jsx)("div",{children:1===n.current_status?(0,S.jsx)("div",{children:1}):(0,S.jsx)("div",{className:"text-red-600 font-semibold",children:0})})}}]}),[R]);return(0,S.jsxs)(f._z,{className:"producer",ghost:!0,children:[(0,S.jsxs)(k.Z,{gutter:10,className:"w-full",children:[(0,S.jsx)(g.Z,{lg:{span:"12"},md:{span:"12"},sm:{span:"24"},xs:{span:"24"},children:(0,S.jsx)(h.Z,{className:"mb-3",scroll:{x:!0},size:"small",columns:A,dataSource:O,defaultData:[],search:!1,options:!1,pagination:!1,tableAlertRender:!1,tableAlertOptionRender:!1,loading:m,rowClassName:function(e){return e.owner===R?"bg-blue-200":""},onRow:function(e){return{onClick:function(){P.current.handleOpen(e)}}}})}),(0,S.jsx)(g.Z,{lg:{span:"12"},md:{span:"12"},sm:{span:"24"},xs:{span:"24"},children:(0,S.jsx)(h.Z,{className:"mb-3",scroll:{x:!0},size:"small",columns:A,dataSource:F,defaultData:[],search:!1,options:!1,pagination:!1,tableAlertRender:!1,tableAlertOptionRender:!1,loading:m,rowClassName:function(e){return e.owner===R?"bg-blue-200":""},onRow:function(e){return{onClick:function(){P.current.handleOpen(e)}}}})})]}),(0,S.jsx)(l.ot,{ref:P}),r]})}}}]);