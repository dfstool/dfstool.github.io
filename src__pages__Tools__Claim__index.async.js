"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[896],{73316:function(e,t,n){n.r(t);var r=n(15009),a=n.n(r),s=n(99289),c=n.n(s),o=n(5574),i=n.n(o),u=n(64119),l=n(11774),f=n(59530),d=n(45360),p=n(4393),m=n(57953),x=n(27484),b=n.n(x),v=n(62435),h=n(86074);t.default=function(){var e=d.ZP.useMessage(),t=i()(e,2),n=t[0],r=t[1],s=(0,f.useSelector)((function(e){return e.global.session})),o=(0,f.useSelector)((function(e){return e.global.account})),x=(0,f.useSelector)((function(e){return e.global.contractKit})),g=(0,v.useState)("0.00000000 DFS"),k=i()(g,2),S=k[0],N=k[1],w=(0,v.useState)("0.00000000 DFS"),j=i()(w,2),y=j[0],F=j[1],C=(0,v.useState)("0.00000000 DFS"),D=i()(C,2),_=D[0],M=D[1],Z=(0,v.useState)(!1),T=i()(Z,2),z=T[0],E=T[1],P=(0,v.useState)(!1),q=i()(P,2),I=q[0],L=q[1],A=(0,v.useState)(!1),K=i()(A,2),R=K[0],W=K[1],Y=(0,v.useState)("0%"),B=i()(Y,2),G=B[0],H=B[1],J=(0,v.useState)("0.00000000 DFS"),O=i()(J,2),Q=O[0],U=O[1],V=(0,v.useState)([]),X=i()(V,2),$=X[0],ee=X[1],te=(0,v.useState)(0),ne=i()(te,2),re=ne[0],ae=ne[1],se=(0,f.useIntl)(),ce=se.formatMessage({id:"account.intlLiq"}),oe=se.formatMessage({id:"node.intlNode"}),ie=se.formatMessage({id:"account.intlInvite"}),ue=se.formatMessage({id:"account.intlClaim"}),le=se.formatMessage({id:"ecosystem.update"}),fe=se.formatMessage({id:"common.intlPleaseConnectWallet"}),de=se.formatMessage({id:"common.intlPleaseConnectNetwork"}),pe=se.formatMessage({id:"tools.claim.intlNoLiqPool"}),me=se.formatMessage({id:"common.intlTxSuccess"}),xe=se.formatMessage({id:"common.intlTxFail"}),be=se.formatMessage({id:"tools.claim.intlNonNode"}),ve=se.formatMessage({id:"tools.claim.intlNonPromoters"}),he=se.formatMessage({id:"node.intlNodeReward"}),ge=(0,v.useCallback)(function(){var e=c()(a()().mark((function e(t){var r,s,c,o,i;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,E(!0),e.next=4,t.client.v1.chain.get_currency_balance("eosio.token","dfsminingout","DFS");case 4:return r=e.sent,e.next=7,t.client.v1.chain.get_currency_balance("eosio.token","swapswapswap","DFS");case 7:s=e.sent,c=s[0].value,o=r[0].value,i=100*(o-o*Math.pow(.9999,31536e3/c)),E(!1),N(r[0].toString()),H(i.toFixed(2)+"%"),U(s[0].toString()),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),E(!1),(0,u.Tv)(e.t0,n);case 21:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}(),[n]),ke=(0,v.useCallback)(function(){var e=c()(a()().mark((function e(t){var n,r,s,c,i,l,f,d,p,m,x,v,h,g,k,N,w,j,y,F,C,D,_,M,Z,T,z;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Number(S.split(" ")[0]),r=Number(Q.split(" ")[0]),s=[],!(o&&n&&r)){e.next=47;break}return e.next=6,t.load("loglogloglog");case 6:return c=e.sent,i=c.table("liqs"),e.next=10,i.all({scope:(0,u.fD)(o.accountName.toString())});case 10:l=e.sent,f=[],l.forEach((function(e){"DFS"!==e.bal0.symbol.name&&"DFS"!==e.bal1.symbol.name||f.push(e.mid.toNumber())})),d=0;case 14:if(!(d<f.length)){e.next=47;break}return e.next=17,t.load("dfsfairfarms");case 17:return p=e.sent,m=p.table("miners"),e.next=21,m.all({scope:f[d],from:o.accountName.toString(),to:o.accountName.toString()});case 21:return x=e.sent,e.next=24,t.load("swapswapswap");case 24:return v=e.sent,h=v.table("markets"),e.next=28,h.all({from:f[d],to:f[d]});case 28:g=e.sent,k=parseFloat(x[0].token.toString()),N=parseFloat(g[0].liquidity_token.toString()),w=k/N,j=g[0].reserve0.value*w,y=g[0].reserve0.symbol.code.toString(),F=g[0].reserve0.symbol.precision,C=g[0].reserve1.value*w,D=g[0].reserve1.symbol.code.toString(),_=g[0].reserve1.symbol.precision,M=null,M="eosio.token"===g[0].contract0.toString()?j:C,Z=M/r,T=b()().unix()-x[0].last_drip.value.toNumber(),z=n*(1-Math.pow(.9999,Z*T)),s.push({mid:f[d],bal0:j.toFixed(F)+" "+y,bal1:C.toFixed(_)+" "+D,reward:z.toFixed(8)+" DFS"});case 44:d++,e.next=14;break;case 47:ee(s);case 48:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,S,Q]),Se=(0,v.useCallback)(function(){var e=c()(a()().mark((function e(t){var r,s,c,l,f,d,p,m,b,v;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.broadcast){e.next=5;break}return n.error("".concat(fe)),e.abrupt("return");case 5:if(o){e.next=8;break}return n.error("".concat(de)),e.abrupt("return");case 8:return e.prev=8,E(!0),e.next=12,x.load("loglogloglog");case 12:return r=e.sent,s=r.table("liqs"),e.next=16,s.all({scope:(0,u.fD)(o.accountName.toString())});case 16:if(c=e.sent,l=[],c.forEach((function(e){console.log(e.bal0.symbol.toString()),"DFS"!==e.bal0.symbol.name&&"DFS"!==e.bal1.symbol.name||l.push(e.mid.toNumber())})),l.length){e.next=23;break}n.error(pe),e.next=34;break;case 23:return f=[],l.forEach((function(e){f.push({account:"dfsfairfarms",name:"claim",authorization:[t.permissionLevel],data:{mid:e,user:o.accountName.toString()}})})),d={actions:f},e.next=28,(0,u.zI)(t.transact(d));case 28:p=e.sent,m=i()(p,2),b=m[0],v=m[1],b?n.error(b):v&&v.response?n.success("".concat(me)):n.error("".concat(xe)),setTimeout((function(){ge(t)}),500);case 34:E(!1),e.next=41;break;case 37:e.prev=37,e.t0=e.catch(8),E(!1),(0,u.Tv)(e.t0,n);case 41:case"end":return e.stop()}}),e,null,[[8,37]])})));return function(t){return e.apply(this,arguments)}}(),[o,x,ge]),Ne=(0,v.useCallback)(function(){var e=c()(a()().mark((function e(t){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,L(!0),e.next=4,t.client.v1.chain.get_currency_balance("eosio.token","dfsbpsvoters","DFS");case 4:r=e.sent,L(!1),F(r[0].toString()),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),L(!1),(0,u.Tv)(e.t0,n);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),[n]),we=(0,v.useCallback)(function(){var e=c()(a()().mark((function e(t){var n,r,c,i,u,l,f,d,p,m,x,v,h,g,k;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Number(y.split(" ")[0]),r=0,!o||!n){e.next=30;break}return e.next=5,t.load("dfsbpsvoters");case 5:return c=e.sent,i=c.table("bpstatus"),e.next=9,i.all({scope:"dfsbpsvoters",from:o.accountName.toString(),to:o.accountName.toString()});case 9:if(!(u=e.sent).length){e.next=30;break}return l=u[0].last_claim.value.toNumber(),f=(f=b()().unix()-l)>86400?86400:f,d=u[0].current_status.toNumber(),e.next=17,s.client.v1.chain.get_currency_stats("eosio.token","DFS");case 17:return p=e.sent,m=p.DFS.supply.value,x=c.table("producers"),e.next=22,x.all();case 22:(v=e.sent).sort((function(e,t){return t.total_votes-e.total_votes})),h=0,0,g=0,k=1,v.forEach((function(e,t){e.bp.toString()===o.accountName.toString()&&(h=e.total_votes.value/1e8,t+1<=30&&(k=1.3)),e.total_votes.value/1e8>m/1e4&&(g+=1)})),d&&l&&h>m/1e4&&(r=n*(1-Math.pow(.9999,f*k/g)));case 30:ae(r);case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,s,y]),je=(0,v.useCallback)(function(){var e=c()(a()().mark((function e(t){var r,s,c,l,f,d,p;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.broadcast){e.next=5;break}return n.error("".concat(fe)),e.abrupt("return");case 5:if(o){e.next=8;break}return n.error("".concat(de)),e.abrupt("return");case 8:return e.prev=8,L(!0),e.next=12,x.load("dfsbpsvoters");case 12:return r=e.sent,s=r.table("bpinfos"),e.next=16,s.all({scope:"dfsbpsvoters",from:o.accountName.toString(),to:o.accountName.toString()});case 16:if(e.sent.length){e.next=21;break}n.error(be),e.next=30;break;case 21:return c={action:{account:"dfsbpsvoters",name:"claim",authorization:[t.permissionLevel],data:{producer:o.accountName.toString()}}},e.next=24,(0,u.zI)(t.transact(c));case 24:l=e.sent,f=i()(l,2),d=f[0],p=f[1],d?n.error(d):p&&p.response?n.success("".concat(me)):n.error("".concat(xe)),setTimeout((function(){Ne(t)}),500);case 30:L(!1),e.next=37;break;case 33:e.prev=33,e.t0=e.catch(8),L(!1),(0,u.Tv)(e.t0,n);case 37:case"end":return e.stop()}}),e,null,[[8,33]])})));return function(t){return e.apply(this,arguments)}}(),[o,x,Ne]),ye=(0,v.useCallback)(function(){var e=c()(a()().mark((function e(t){var r,s,c,i;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=3;break}return M(de),e.abrupt("return");case 3:return e.prev=3,W(!0),e.next=7,t.load("dfsrefdfsref");case 7:return r=e.sent,s=r.table("referrers"),e.next=11,s.all({scope:"dfsrefdfsref",from:o.accountName.toString(),to:o.accountName.toString()});case 11:(c=e.sent).length?(i=c[0].unclaimed_reward.toString(),M(i)):M("0.00000000 DFS"),W(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),W(!1),(0,u.Tv)(e.t0,n);case 20:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}(),[o]),Fe=(0,v.useCallback)(function(){var e=c()(a()().mark((function e(t){var r,s,c,l,f,d,p;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.broadcast){e.next=5;break}return n.error("".concat(fe)),e.abrupt("return");case 5:if(o){e.next=8;break}return n.error("".concat(de)),e.abrupt("return");case 8:return e.prev=8,W(!0),e.next=12,x.load("dfsrefdfsref");case 12:return r=e.sent,s=r.table("referrers"),e.next=16,s.all({scope:"dfsrefdfsref",from:o.accountName.toString(),to:o.accountName.toString()});case 16:if(e.sent.length){e.next=21;break}n.error(ve),e.next=30;break;case 21:return c={action:{account:"dfsrefdfsref",name:"claim",authorization:[t.permissionLevel],data:{user:o.accountName.toString()}}},e.next=24,(0,u.zI)(t.transact(c));case 24:l=e.sent,f=i()(l,2),d=f[0],p=f[1],d?n.error(d):p&&p.response?n.success("".concat(me)):n.error("".concat(xe)),setTimeout((function(){ye(x)}),500);case 30:W(!1),e.next=37;break;case 33:e.prev=33,e.t0=e.catch(8),W(!1),(0,u.Tv)(e.t0,n);case 37:case"end":return e.stop()}}),e,null,[[8,33]])})));return function(t){return e.apply(this,arguments)}}(),[o,x,ye]);return(0,v.useEffect)((function(){s&&x&&(ge(s),Ne(s))}),[s,x,ge,Ne]),(0,v.useEffect)((function(){s&&x&&(ye(x),ke(x),we(x))}),[s,x,ye,ke,we]),(0,h.jsx)(l._z,{className:"claim",ghost:!0,children:(0,h.jsxs)("div",{className:"flex flex-wrap justify-around",children:[(0,h.jsxs)(p.Z,{className:" w-[400px] mb-3 text-center",title:(0,h.jsx)("div",{className:"text-center",children:ce}),actions:[(0,h.jsx)("div",{onClick:function(){return ge(s)},children:(0,h.jsx)(m.Z,{spinning:z,children:le})},"1"),(0,h.jsx)("div",{onClick:function(){return Se(s)},children:(0,h.jsx)(m.Z,{spinning:z,children:ue})},"2")],children:[S," ",G," APY"]}),(0,h.jsx)(p.Z,{className:" w-[400px] mb-3 text-center",title:(0,h.jsx)("div",{className:"text-center",children:oe}),actions:[(0,h.jsx)("div",{onClick:function(){return Ne(s)},children:(0,h.jsx)(m.Z,{spinning:I,children:le})},"1"),(0,h.jsx)("div",{onClick:function(){return je(s)},children:(0,h.jsx)(m.Z,{spinning:I,children:ue})},"2")],children:y}),(0,h.jsx)(p.Z,{className:" w-[400px] mb-3 text-center",title:(0,h.jsx)("div",{className:"text-center",children:ie}),actions:[(0,h.jsx)("div",{onClick:function(){return ye(x)},children:(0,h.jsx)(m.Z,{spinning:R,children:le})},"1"),(0,h.jsx)("div",{onClick:function(){return Fe(s)},children:(0,h.jsx)(m.Z,{spinning:R,children:ue})},"2")],children:_}),!!re&&(0,h.jsx)(p.Z,{className:" w-[400px] mb-3 text-center",title:(0,h.jsx)("div",{className:"text-center",children:he}),children:(0,h.jsx)("div",{children:re.toFixed(8)+" DFS"})}),$.map((function(e,t){return(0,h.jsxs)(p.Z,{className:" w-[400px] mb-3 text-center",title:(0,h.jsx)("div",{className:"text-center",children:e.bal0+" / "+e.bal1}),children:[(0,h.jsx)("div",{children:e.reward}),(0,h.jsx)("div",{children:"mid: "+e.mid})]},t)})),r]})})}}}]);